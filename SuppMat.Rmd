---
title: Supplementary Materials for "Synchrony Causes Major Cycles in Deer Populations
  and Deer-Vehicle Collisions Across Wisconsin"
author: Thomas L. Anderson, Lawrence W. Sheppard, Jonathan A. Walter, Robert E. Rolley,
  Daniel C. Reuman
date: 'correspondence to: anderstl@gmail.com, reuman@ku.edu'
output:
  pdf_document:
    fig_caption: yes
    keep_tex: yes
    includes:
      in_header: head_supp.sty
  html_document:
    df_print: paged
  word_document: default
geometry: left=1cm,right=1cm,top=2.5cm,bottom=2.8cm
link-citations: yes
csl: science.csl
tables: yes
bibliography: AndersDeerShortRefs.bib
urlcolor: blue
---

\textbf{This PDF file includes:}
> Materials and Methods  
> Supplementary Text  
> Figs S1 to S8  
> Table S1 to S5  
> Full Reference list[@Leibhold2004_sync; @Allstad2015_gypsysync; @Moran1953; @Ranta1997_moran; @Kendall2000_moran; @Abbott2007_moran;@Defriez2016_plankton;@Sheppard2016_aphids;@Defriez2017_terrestrial; @Defriez2017_marine; @Sheppard2017_surrogates; @Walter2017_geogsync; @Cote2004_deerimpacts; @Conover1997_dvc; @Winkler2013_hunters; @usfws2011_survey; @Conover2011_bookchp; @Sheppard_wavmodel; @Delguidice2008_deersurvival; @Mysterud2008_deerclimate; @Hegel2012_caribou; @Anderson1996_elnino; @Rodionov2003_elnino; @Post1998_popgrowth; @Post2004_greenland; @Grotan2005_roedeer; @Huijser2008_dvc; @Marcoux2010_dvc; @Koenig2016_birdsync; @Shestakova2016_forestsync; @Cai2014_elnino;@widnr2001; @Ciuti2015; @Millspaugh2009; @Buonaccorsi2001; @Sheppard2013; @Theiler1992; @Schreiber2000]  

<!--Libraries-->
```{r libraries, echo=F, message=FALSE}
library(plyr)
library(tidyr)
library(reshape2,quietly=T)
library(tools,quietly=T)
library(fields,quietly=T)
library(shape,quietly=T)
library(rmarkdown)
library(tinytex)
library(devtools,quietly=T)
library(withr,quietly=T)
```

<!--Flags controlling the run and other setup-->
```{r setup, echo=F}
#which density to use ("dnr" for original estimates, "tom" for your own calculations)
dens.flag<-"dnr"

#what is the earliest year you want? (hunting only: 1960; abundance: 1981; DVC: 1987; Traffic: 1988, Hunters: 1992)
minyear<-1981

#what is the last year you want? (max is 2016)
maxyear<-2016

#set number of surrogates to use for spatial coherence
nsurrogs<-100

#a function needed for caching
source("Code/mtime.R") 
```

<!--Generate the data-->
```{r data_generation, echo=F, cache=TRUE, results="hide", fig.show="hide", cache.extra=list(dens.flag,minyear,maxyear,mtime("Code/Deer_DataGeneration.R"),mtime("Data/WI_Cty_CentroidDD.csv"),mtime("Data/DOT_Accidents1987_2016.csv"),mtime("Data/Adj_DOT_Accidents1987_2016.csv"),mtime("Data/WI_USDA_Sections.csv"),mtime("Data/USDA_centroids.csv"),mtime("Data/Cty_Traffic.csv"),mtime("Data/DMU_DeerAbundance1981_2013.csv"),mtime("Data/DMU_DeerDensity1981_2013.csv"),mtime("Data/DMU_HunterAbundance1975_2013.csv"),mtime("Data/DMU_HunterDensity1975_2013.csv"),mtime("Data/hunterdens1416.csv"),mtime("Data/hunterabun1416.csv"),mtime("Data/Cty_Abun_2014_2016.csv"),mtime("Data/permit_issued1970_2013.csv"),mtime("Code/Climate_DataGeneration.R"),mtime("Data/noaa_latlongUpd.csv"),mtime("Data/WI_USDA_Sections.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set1.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set2.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set3.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set4.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set5.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set6.csv"),mtime("Data/Cty_NOAA_Temp2016_2017.csv"),mtime("Data/Cty_NOAA_Precip1981_1985.csv"),mtime("Data/Cty_NOAA_Precip1986_1991.csv"),mtime("Data/Cty_NOAA_Precip1992_1997.csv"),mtime("Data/Cty_NOAA_Precip1998_2003.csv"),mtime("Data/Cty_NOAA_Precip2004_2009.csv"),mtime("Data/Cty_NOAA_Precip2010_2015.csv"),mtime("Data/Cty_NOAA_Precip2016_2017.csv"),mtime("Data/climate_indices.csv"),mtime("Data/mei.csv"),mtime("Data/pdo.csv"))}

#Dependencies (listed in cache.extra above):
#1) Settings variables from the setup chunk
#2) all the data csvs (see Data folder)
#3) all the scripts sourced below (see Code folder)
#4) all the functions called (see Functions folder)

#Clean population data: end result are two lists of matrices called "cty.list" and "usda.list". Cty stands for county. All elements of cty.list are matrices, counties (rows) by year (columns). Elements are named Abun (abundance), Crashes (DVCs), Traffic (traffic), and AdjDVC (Traffic-adjusted DVCs). USDA stands for USDA districts, and all elements in "usda.list" are matrices, districts (rows) by year (columns) and named similarly to cty.list. In both lists, the data sets were complete in spatial dimension but varied in temporal dimension: deer span the years 1981-2016, Crashes 1987-2016 and Traffice/AdjDVCs 1988-2016. Missing years are filled with NAs. Both objects are saved as .rds files in the Results folder.

#***TOM: make a scruipt called tests_datagen_deer. R or similar, which is simple, it just calls the two separate deer data cleaning scripts and compares the two outputs for exact equality. Same for tests_datagen_climate.R.
#***TOM: might want to have tests_master.R which calls all the tests scripts that we may develop, but we can leave this.
system.time(source("Code/Deer_DataGeneration.R"))

#Clean winter weather and climate data: end results are four lists of matrices called "winter.clim", climindex, winter.clim.usda, and climindex.usda. "winter.clim"" includes matrices, counties (rows) by year (columns) that are the averages of NOAA weather station data from Dec[t-1] to Mar[t], with named elements of Tmin (minimum temperature), Tmax (maximum temperature), Prcp (precipitation), and Snwd(snow depth). Not all counties had weather data in all years and are filled with NAs where missing. "winter.clim.usda"" are matrices, districts (rows) by year (columns) and includes the same variables and variable names as "winter.clim"" but averaged over USDA districts (~ 7 counties per district). All objects are saved as .rds files in the Results folder."climindex" and "climindex.usda" are matrices of climate indices averaged over winter (Dec[t-1]-Mar[t]) and summer (Apr[t]-Nov[t]). Values in each matrices are repeated across rows because the climate indices are not a spatial variable. The dimensions of each match the spatial dimensions of other county (climindex) or district (cliindex.usda) data sets. 
system.time(source("Code/Climate_DataGeneration.R"))

```

```{r analysis, echo=F, cache=TRUE, results="hide", fig.show="hide", cache.extra=list(cty.list,usda.list,winter.clim,climindex,winter.clim.usda,climindex.usda,nsurrogs,mtime("Data/abunsurrsum.csv"),mtime("Data/dvcsurrsum.csv"),mtime("Code/DeerCoherence_wsyn.R"))}

#Run analysis on deer abundance and DVCs using county and district data depending on scale.flag
set.seed(101)
system.time(source("Code/DeerCoherence_wsyn.R"))
```

<!---generate plots--->
```{r plots, echo=F, cache=T, results="hide", fig.show="hide", cache.extra=list(cty.list,usda.list,winter.clim,climindex,winter.clim.usda,climindex.usda,wlm_abun,wlm_dvc,mtime("Code/deer_plots.R"),mtime("Functions/Fn_wmfwt.R"),mtime("Functions/Fn_rankplot.R"),mtime("Code/PedagogFig.R"),mtime("Functions/deer_plotting_functions.R"))}
#generate plots
set.seed(201)
system.time(source("Code/deer_plots.R"))
#***TOM: for every panel in the main text or supp mat for which a wsyn plotting routine can make that panel (albeit without nice formatting), lets try to make sure the paanel has been made and saved to Results, albeit not imported into the paper.
```

```{r echo=F, results="hide"}

#need to run so that objects that are large numbers can be evaluated with inline code
options(scipen = 999999)

#load in results
options(scipen=6)
#Load tables of results
TabS4_results<-readRDS(file = "Results/TabS4_results.rds")
TabS1_results<-readRDS(file = "Results/TableS1.rds")

usda_abunsnwd_syncexp34<-TableS4$SynchronyExplained[TableS4$Predictor=="Snwd" & TableS4$Response=="Abun" & TableS4$Timescale=="3-4"]
usda_dvcabunSyncExp<-TabS4_results$SynchronyExplained[TabS4_results$Response=="DVCs" &
                                                        TabS4_results$Predictor=="Abundance"]
usda_adjdvcabunSyncExp<-TabS4_results$SynchronyExplained[TabS4_results$Response=="Adjusted DVCs" &
                                                        TabS4_results$Predictor=="Abundance"]
snowabunSyncExp34<-TabS1_results$SynchronyExplained[TabS1_results$Predictor=="Snwd" & TabS1_results$Timescale=="3-4"]
avgdeerfluc<-readRDS(file="Results/totaldeerfluctuations.rds")
avgdvcfluc<-readRDS(file="Results/totaldvcfluctuations.rds")
avgdvccostsLow<-readRDS(file="Results/totaldvccostsLow.rds")
avgdvccostsHigh<-readRDS(file="Results/totaldvccostsHigh.rds")
```
# Materials and methods

## Data and pre-processing

We obtained deer abundance estimates from the Wisconsin Department of 
Natural Resources (WIDNR) spanning a `r dim(cty.list$Abun)[2]`-yr period 
(`r minyear`-`r maxyear`; Fig. S1 \ref{FigS1_Timeseries}). 
From 1981-2013, deer abundance was estimated for deer management units 
(DMUs, $N=$ 101-139 depending on the year). For most years and DMUs, 
abundance was estimated using a sex-age-kill (SAK) model, with aerial surveys or 
accounting models used for a smaller number of years and DMUs [@widnr2001]. 
In $2014$, DMU boundaries were changed to match the administrative level of 
county ($N=$ `r length(unique(dat$COUNTY_NAM))`). Because of this, and because other 
spatial variables (e.g., DVCs, climate) were gathered at the county level, 
we transformed the 1981-2013 abundance estimates for DMUs 
into county-level estimates. To do so, we first calculated the areas 
of intersection between DMU and county boundaries for each year (as 
DMU boundaries changed yearly), using the 'intersect' function in 
Arc GIS 10.3 (ESRI, Redlands, CA). We then calculated deer abundance 
for each intersection area by multiplying the amount of deer habitat in 
each intersection area by the WIDNR density estimate of deer for the DMU 
that the intersection fell within. Deer habitat was considered to comprise 
areas of permanent cover (e.g., forests) that were $>4$ ha in size. DMU deer 
densities were calculated by dividing the estimated abundance for the DMU 
by the amount of deer habitat within the DMU [@widnr2001]. This procedure 
assumes approximately spatially uniform densities of deer within deer 
habitat across each DMU. The abundance for a county was the sum of 
the estimated abundances of the county's intersections with the DMUs. 
We dropped one county (Menominee) due to incomplete data for most 
variables, leaving `r length(unique(dat$COUNTY_NAM))` counties for statistical analysis.

We obtained estimated hunter abundance data for each DMU from the WIDNR 
that spanned the years 1992-`r maxyear`
(Fig. S1 \ref{FigS1_Timeseries}), which constituted an index of the estimated 
number of hunters during the first two days of the 9-day gun 
hunting season [@widnr2001], assuming this was a good proxy 
for hunter numbers across the season. 
<!--***DAN: I think we should add 1-2 sentences arguing why this is a  reasonable assumption, perhaps by giving data, if available, on how many gun v other types of hunters there are, and how many people go the opening 2 days versus later in the week. Let's discuss, Tom.-->
<!--***Tom::I doubt whether there is any data on your last statement, how many go early versus late. I'm not sure I follow the gun v other types of hunters argument- do you mean that the majority of deer get killed by gun hunters and thus that would be the best estimate of hunters for regulating deer?-->
We estimated hunter abundances 
for counties using the same method as for deer abundance. We 
dropped 18 counties due to incomplete survey 
efforts of hunters or missing data, leaving 53
counties for subsequent analysis. 

We obtained estimates of DVCs for each county, spanning the 
years 1987-`r maxyear`, from the WI Department 
of Transportation (WIDOT; Fig. S1\ref{FigS1_Timeseries}). These data reflect 
the number of police-investigated DVCs. These data represent an 
index of DVCs, as opposed to an absolute number of incidents, 
as not all DVCs are reported. In Michigan, nearly half of 
DVCs went unreported to the police or insurance companies 
over a five year period [@Marcoux2010_dvc]. Additionally, 
DVC information was collected with reporting effort that 
may have varied for different counties 
(Daniel Storm, WIDNR, Personal Communication), and the 
threshold of damage for the police to respond to and report on 
an incident increased statewide in 1996 from US\$500 to US\$1000. 
However, features of the data such as these could only have obscured 
and could not have artefactually generated the strongly 
significant spatial coherence relationships we report between 
DVCs and deer abundance. Shortcomings of the DVC data added 
noise to the DVC data and likely obscured the relationship 
with deer abundance, so that if better DVC data were available 
this relationship may have been even stronger than that reported. 
We also obtained traffic volume estimates (millions of miles 
driven) for each county spanning the years 1988-`r maxyear` from the 
WIDOT, to control for traffic in our analysis of DVCs.

We obtained daily weather data (minimum and maximum air temperature 
[here called Tmin and Tmax], snow depth, and precipitation) from 
all available weather stations in each county from the 
National Climatic Data Center ([`https://www.ncdc.noaa.gov/`](https://www.ncdc.noaa.gov/)). We 
averaged daily values across the winter ($\text{Dec}_{t-1}$ 
to $\text{Mar}_t$) and across stations within a county to produce 
annual time series of winter weather by county which were used in 
all subsequent analyses (Fig. S1 \ref{FigS1_Timeseries}). The number of 
weather stations per county and data collected at each station 
varied, resulting in different spatial extents for each variable 
in order to retain the full temporal extent: Tmin ($N=$ `r dim(winter.clim$Tmin[!is.na(rowMeans(winter.clim$Tmin)),])[1]`
counties), Tmax ($N=$ `r dim(winter.clim$Tmax[!is.na(rowMeans(winter.clim$Tmax)),])[1]`), precipitation 
($N=$ `r dim(winter.clim$Prcp[!is.na(rowMeans(winter.clim$Prcp)),])[1]`), snow depth ($N=$ `r dim(winter.clim$Snwd[!is.na(rowMeans(winter.clim$Snwd)),])[1]`). 
We also calculated a Winter Severity Index (WSI, $N=$ `r dim(winter.clim$WSI[!is.na(rowMeans(winter.clim$WSI)),])[1]`), 
a metric known to impact deer populations [@widnr2001]. WSI is the cumulative 
sum of the total number of days for which snow depth was greater 
than 18 inches and Tmin was simultaneously less than $0^\circ$F. 

We obtained monthly estimates of three global climate indices: 
the North Atlantic Oscillation (NAO), the multivariate 
El Niño/Southern Oscillation Index (MEI), and the Pacific 
Decadal Oscillation (PDO), all of which have been shown to 
influence large ungulate population dynamics in the northcentral 
USA [@Post1998_popgrowth,@Post2004_greenland]. We averaged monthly values across the 
approximate growing season (Apr-Nov), and the winter 
($\text{Dec}_{t-1}$ to $\text{Mar}_t$) for each index 
(Fig. S1 \ref{FigS1_Timeseries}). We used a total of 11 weather and 
climate variables in subsequent analyses: winter Tmin, Tmax, 
snow depth, and precipitation; winter NAO, MEI, and PDO; 
growing-season NAO, MEI and PDO; and the WSI. All were annual 
time series at the county level.

## Analysis

We performed all analyses described below and in the main text 
at three spatial scales: counties (N = 44-`r dim(cty.list$Abun)[1]`> depending on 
the variables involved; mean county 
area $\pm$ SD = `r round(mean(gps$Area_km2),0)`2017 $\pm$ 799`r round(sd(gps$Area_km2),0)` $\text{km}^2$), 
United States Department of Agriculture (USDA) districts ($N = 9$; mean 
district area $\pm$ SD = 16138 `r round(mean(usda.centroid$Area_km2),0)` $\pm$ 799 `r round(sd(usda.centroid$Area_km2),0)` $\text{km}^2$), 
and statewide (Fig. S2\ref{FigS2_map}). Analyses at three spatial scales 
were performed because the SAK model used by the WIDNR to estimate deer 
abundance for each management unit has been criticized as less accurate 
at smaller spatial scales [@Millspaugh2009]. However, the bias in abundance 
estimates previously reported may have been overestimated, as more recent analyses 
suggest the uncertainty in SAK estimates is substantially less 
($\pm 20\%$ error rates; WIDNR, personal communication). 
<!--***DAN: It was Robert that told us this, and he is a coathor, so perhaps we should take out the personal communication parens? It would be best if we could get a citation for this, even a white paper, if there is one and we can fit it in.-->
In addition, the criticism of the SAK [@Millspaugh2009] was based 
on a model that did not match perfectly with practices of the WIDNR. 
<!--***DAN: I added the above sentence, Tom, based on a comment of Roberts that had been inserted as a marginal note in the Word doc that this Rmd replaces. Please check. If we keep the "personal communication" paren above then we should also insert one here.-->
Regardless, 
to ensure our results were not biased by spatial extent, we analyzed 
synchrony at multiple spatial extents. USDA district data were 
produced as the sum or 
average of county-level variables, as the two scales had nested boundaries. 
There were roughly $6$ to $8$ counties per district (Fig. S2\ref{FigS2_map}). 
Statewide analysis used state total or average time series for each 
variable. In general, the patterns of significance and phase relationships 
we observed remained unchanged in their main substance using data 
aggregated to larger spatial scales (Table S4\ref{TabS4_SummaryDistrict}, S5\ref{TabS5_SpatCohPWWAndClimInds_District}; 
Fig. S6\ref{FigS6_WMFAndPredictionsDistricts}, suggesting the results for counties are not 
meaningfully biased by possible inaccuracies in SAK abundance estimation 
procedures at the county level.

We performed an optimal Box-Cox transformation on each time series to help ensure Gaussian marginal distributions [@Sheppard2016_aphids], which are necessary for the Fourier-surrogate-based  analyses described below. This process also included linear detrending (and subtracting the mean) to remove any long-term trends that might otherwise obscure patterns of synchrony [@Buonaccorsi2001] Time series
variances were also standardized to 1.

We visually assessed the strength of synchrony 
and its dependence on time and timescale for 
all spatiotemporal variables using two 
statistical tools: the wavelet mean field and 
the wavelet phasor mean field [@Sheppard2013,@Sheppard2016_aphids]. 
Both of these find standard application in 
some biological fields; they are described in 
detail elsewhere [@Sheppard2013,@Sheppard2016_aphids] and 
operationally here. Both techniques take as 
input time series measured at the same times 
in several locations, and return as output 
complex-number-valued functions of time 
and timescale. When the complex magnitudes of 
these functions are plotted against time 
and timescale, the plots characterize the degree 
of synchrony among the input time series and how 
it may have changed over time or differed by 
the timescale considered (Fig. 1\ref{Fig1}). 
The wavelet phasor mean field magnitude 
quantifies the degree to which phases of 
oscillation in the input time series were the 
same across locations, as a function of time 
and timescale. The wavelet mean field 
magnitude incorporates information not only 
on phase synchronization but also on the 
tendency of oscillatory components on any 
given timescale to have magnitudes which are 
correlated through time across the sampling 
locations. Both quantities are based on Morlet 
wavelet transforms of each input time series. 
Statistical significance of the wavelet phasor mean 
field, compared to a null hypothesis of no phase 
synchrony, can be assayed for each combination of 
time and timescale. For any given time and 
timescale, significance testing compares the degree 
of phase consistency between sampling locations for 
real time series to a null hypothesis of random 
phases. If real phase consistency was greater than 
that of $99.9\%$ of sets of random phases 
($P < 0.001$; one-tailed test), synchrony was 
deemed significant and important 
[@Sheppard_wavmodel]. Wavelet mean field and 
wavelet phasor mean field magnitude plots for 
winter weather variables are in 
Fig. S7\ref{FigS7_WMFsAndWPMFsAncillary}. 

For climate indices (winter and growing season 
NAO, PDO and MEI), which were single time series 
rather than collections of time series measured at 
multiple locations, we generated plots of 
'normalized' wavelet magnitude 
(Fig. S8\ref{FigS8_WaveletAmps}). Here, wavelet transforms 
were first normalized at each timescale by dividing 
by the square root of the time-averaged squared 
wavelet transform magnitudes. Magnitudes of 
normalized transforms were plotted as a function of 
time and timescale [@Sheppard2016_aphids].  

For both county- and district-level data, we 
assessed pairwise relationships between 
spatiotemporal variables using spatial coherence 
techniques. These find standard application in 
other fields, and are described in detail 
elsewhere [@Sheppard2013,@Sheppard2016_aphids,@Sheppard2017_surrogates] and operationally
here. Spatial coherence tests whether two 
spatiotemporal variables exhibit consistent phase 
differences and correlated magnitudes of 
oscillation through time and across space as a 
function of timescale. Significance is determined 
by comparing spatial coherences of data with 
spatial coherences of appropriately randomized, 
surrogate data sets ($N=100,000$ surrogates 
were used for all tests) that retain the same 
temporal and spatial autocorrelation properties as 
the original time series but are otherwise 
unrelated [@Theiler1992,@Schreiber2000]. Standard Fourier 
surrogates were used [@Schreiber2000,@Sheppard2013,@Sheppard2016_aphids,]. 
We calculated how often observed spatial coherence 
between pairs of variables was ranked higher than 
coherences of surrogate data sets, aggregating 
across the timescale band of interest using an 
average-rank-based method described in detail 
elsewhere [@Sheppard2016_aphids]. A p-value of $0.05$ 
means that coherences were higher, in an average 
sense across the timescale band, than the same 
quantities calculated for $95,000$ of $100,000$ 
surrogate data sets. Ranks of actual spatial 
coherences in surrogate spatial coherences can 
also be plotted as a function of timescale 
(Fig. S3\ref{FigS3_PhaseDiffs}). 

As opposed to correlation-based approaches that 
assume in-phase relationships, spatial coherence 
allows for any kind of phase relationship and 
provides as output the average phase that occurred. 
Therefore, when two variables were significantly 
spatially coherent over a timescale band, we 
calculated the mean phase difference between the 
variables over the band, in units of $\pi$ 
radians, to determine if oscillations had 
approximately in-phase ($|\bar{\theta}|=0$ to 
$0.25$), quarter-cycle ($|\bar{\theta}|=0.25$ to 
$0.75$), or anti-phase ($|\bar{\theta}|=0.75$ to 
$1$) relationships. We used the scalloped version 
of the wavelet transforms of each variable for 
calculating phase differences. 

As with correlations, the causal direction of 
spatial coherence is not directly revealed by the 
coherence itself, though biological arguments 
sometimes support one causal hypothesis more than 
others. Weather could not reasonably be influenced 
by deer abundance. Therefore, a highly significant 
spatial coherence between a weather variable and 
deer abundance on a timescale band of interest 
provides strong evidence that either the weather 
variable helped cause deer fluctuations and 
synchrony for those timescales, possibly 
indirectly, or some other weather variable, 
highly spatially 
coherent with the first variable, caused the 
fluctuations and synchrony. The highly significant 
coherence between deer abundances and DVCs we 
present in the main text is likewise probably 
indicative of greater deer abundances resulting in 
more DVCs. DVCs are too uncommon to meaningfully 
influence deer abundance (Fig. S1\ref{FigS1_Timeseries}), 
and the 
in-phase relationship our analyses showed between 
deer abundances and DVCs on $3-7$-year timescales 
is much more plausibly consistent with deer 
dynamics driving DVC dynamics than the reverse. 

We used spatial coherence to test for the effects 
of the five weather variables (average winter Tmin, 
Tmax, snow depth, precipitation, and WSI), six 
climate variables (winter and growing season PDO, 
MEI and NAO) and hunter abundance as potential 
drivers of synchrony in deer abundance over the 
$3-7$-year timescale band. We also used spatial 
coherence to test for a relationship between deer 
abundance and DVCs, and abundance with DVCs 
adjusted for traffic volume. When the temporal and 
spatial extents of two spatiotemporal variables 
data were not identical, we retained only the 
locations and time range for which data were 
available for both variables when testing for 
spatial coherence. When testing for spatial 
coherence between a spatiotemporal variable and a 
climate index (PDO, MEI or NAO, each of which 
comprised only a single time series), we considered 
that the same index time series pertained to all 
locations for which the spatiotemporal variable was 
measured. 

For statewide analyses, for which all variables 
were represented only by single, state average or 
total time series, timescale-specific relationships 
between variables were tested using ordinary 
wavelet coherence. Wavelet coherence is a 
non-spatial version of the spatial coherence, and 
tests whether two time series exhibit consistent 
phase differences and correlated magnitudes of 
oscillation through time, as a function of 
timescale. We tested for relationships between 
statewide deer abundance time series and climate 
indices, statewide averages for winter weather, 
statewide hunter abundance time series, and 
statewide total DVCs. 

We calculated the amount of deer abundance 
synchrony explained by individual weather and 
climate variables, as well as the amount of DVC 
synchrony explained by deer abundance, following 
the wavelet Moran theorem of [@Sheppard2016_aphids]. 
As part of this procedure, we also calculated the 
average 'cross terms' of [@Sheppard2016_aphids] over 
the timescale band of interest (see supplementary 
files of ref @Sheppard2016_aphids, equation 22), again following the 
procedures described in that reference. The precise 
mathematical meaning of cross terms is explained in 
[@Sheppard2016_aphids]; for operational purposes, they 
provide a test of whether modelling assumptions of 
[@Sheppard2016_aphids] are sufficiently met to use the 
wavelet Moran theorem to estimate fractions of 
synchrony explained. Cross terms less than $50\%$ 
of estimated fractions of synchrony explained were 
considered necessary.

We calculated the amount of deer abundance 
synchrony jointly explained by snow depth, 
PDOw and MEIw using a wavelet multiple regression 
model approach [@Sheppard_wavmodel]. This novel 
method, described in detail in [@Sheppard_wavmodel], 
is analogous to multiple linear regression, with a 
model describing the relationship between a 
response variable and multiple predictor variables. 
But in contrast to standard regression, response 
and predictor variables are power-normalized 
wavelet transforms of spatiotemporal variables. 
Model coefficients are complex-valued functions of 
timescale encoding estimated phase lags and 
magnitude multipliers between a predictor variable 
and its effects on the response variable. 
Coefficients are estimated in a way that has the 
effect of maximizing the spatial coherence between 
response transforms and model-predicted transforms. 
Thus, the predictor transforms in the model can be 
used to statistically explain variation in the 
wavelet transforms of the response, as well as to 
produce a wavelet mean field plot of the predicted 
synchrony as a function of time and timescale based 
on the multiple explanatory variables (colors in 
Figs 2C\ref{Fig2}, S6E\ref{FigS6_}, colors). 
Fractions of synchrony explained by model 
predictors for a timescale band are again 
available, through a generalization 
[@Sheppard_wavmodel] of the wavelet Moran theorem 
of @Sheppard2016_aphids, again subject to checking 
cross terms. 
<!--***DAN: This is the para subject to not quite knowing what to do given Lawrence's paper is not published yet.-->

In order to quantify the degree to which 
synchronizing effects are responsible for 
fluctuations in statewide total deer and DVC time 
series (Fig. 4\ref{Fig4} and associated text), 
we adapted the standard Fourier surrogate procedure 
of @Theiler1992. We constructed artificial 
deer abundance and DVC time series for each 
location, having the same variance and spectral 
characteristics as the original data but no spatial 
synchrony in the $3-7$-year timescale band of 
interest. Components of variability and synchrony 
outside this band (such as longer-term trend or 
fluctuations, and higher frequency components 
associated with 'spikiness' in the data) were left 
unchanged. To produce surrogate data for a given 
location, we took the Fourier transform of the time 
series and randomized the phases of the Fourier 
components inside the $3-7$-year timescale band 
before inverse transforming to produce the 
surrogate time series. Because only phases of the 
Fourier transform are randomized, power spectra and 
variances of time series are unchanged. 
Additionally, because phases in the $3-7$-year 
timescale band are randomized independently, 
surrogate time series so produced no longer exhibit 
a tendency to synchrony in the $3-7$ year timescale 
range [@Schreiber2000]. Phase randomization was 
accomplished by adding a random phase increment 
between $0$ and $2\pi$ to the phase of each Fourier 
component with a frequency greater than or equal to 
$1/7$, but less than $1/3$ cycles per year. 
Additionally, because the phase values of the 
Fourier components of a real signal are 
anti-symmetric about the Nyquist frequency ($1/2$ 
cycles/year), Fourier components with frequencies 
less than or equal to $6/7$ and more than $2/3$ 
cycles per year had the same set of phase 
increments subtracted to preserve the anti-symmetry 
property of Fourier transforms. We summed each set 
of surrogate time series spatially to produce a 
surrogate state-total time series representative of 
the hypothetical case in which $3-7$-year timescale 
synchrony was absent. Such surrogate state-total 
time series were compared to the actual time series 
(deer abundance or DVCs) to show the nature of the 
additional variance in the state-total time series 
attributable to synchrony (Fig. 4\ref{Fig4}).

<!--***DAN: Tom, you had attached a bunch of marginal comments to the version of this para in the Word doc, and I tried to act on those as best I could. Please revire the result-->
We estimated the approximate monetary impact of 
synchrony in DVCs based on several reported 
assumptions about DVCs. Using an average difference 
between peak and trough DVC years 
(Fig. 4\ref{Fig4}) of `r avgdvcfluc`, and if we assume 
that each reported DVC results in an average of 
US\$2024 of damage [@Conover2011_bookchp], the 
difference in damages statewide between peak and 
trough years is more than US\$5M. Given that DVCs 
are only reported about 50% of the time 
[@Marcoux2010_dvc], this number is actually likely 
greater than US\$10M. Using different assumptions 
of the cost of DVCs [@Huijser2008_dvc], the 
difference between peak and trough years in DVCs 
costs may exceed US\$22M.    

# Supplementary text

## USDA district results

When aggregated to USDA districts, deer abundance 
showed a prominent synchrony feature at $3-7$ year 
timescales, similar to the county-level analysis 
(Fig. S6A,C\ref{FigS6_WMFAndPredictionsDistricts}). 
The wavelet phasor mean field of deer 
abundance showed the phase synchrony was quite 
strong, and significantly different from random 
phase orientations. 

Deer abundance was significantly related to snow 
depth, MEIw, MEIs, and PDOw 
(Table S4\ref{TabS4_SummaryDistrict}); these three 
variables were the same ones identified as 
significantly coherent with deer abundance using 
county-level analyses. The phase relationships 
between these variables were also similar to 
county-level relationships, where snow depth and 
abundance were nearly anti-phase, and climate 
indices and abundance showed approximately 
quarter-cycle phase shifts (Table S4\ref{TabS4_SummaryDistrict}). 
The climate indices explained similar amounts of 
deer abundance synchrony as for the county-level 
data, but snow explained a higher amount of 
synchrony at $`r round(100*usda_abunsnwd_syncexp34,0)`\%$ for $3-4$-year timescales, as 
compared with $`r round(100*snowabunSyncExp34,0)`\%$ at the county-level. Combined, 
snow depth, MEIw, and PDOw explained $`r round(100*usda.abunmod_se[[1]],0)`\%$ of the 
synchrony in deer abundance using 
USDA district data (Fig. S6E\ref{FigS6_WMFAndPredictionsDistricts}).

<!--***DAN: Tom, I made some substantial edits to the below para, pls review-->
DVCs aggregated to USDA districts had a similar 
synchrony feature to deer abundance over $3-7$ year 
timescales (Fig. S6B,D\ref{FigS6_WMFAndPredictionsDistricts}). As with 
counties, deer abundance was a significant 
predictor of DVC synchrony (Table S4\ref{TabS4_SummaryDistrict}), 
and explained a substantial fraction ($`r round(100*usda_dvcabunSyncExp,0)`\%$) of 
the synchrony (Fig. S6F\ref{FigS6_WMFAndPredictionsDistricts}). This value 
is nearly double the synchrony explained for 
county-level analysis. Additionally, the 
county-level 
analysis of the possible synchronizing effects of
deer abundance on DVCs had cross-terms that were 
high relative to 
the synchrony `explained' in DVCs by abundance 
(Table S1\ref{TabS1_CountyCoherenceSummary}). The renders the estimate of synchrony explained uniterpretable (*Methods*). 
Large cross terms may reflect the 
effects of dispersal of 
deer between counties or movement of cars between 
counties on the statistics. 
<!--***DAN: do we need additional explanation here?-->
But such effects would be
reduced at the larger district level, consistent
with our results that cross terms were small
enough to be ignored 
at district level. The amount of DVC 
synchrony explained by 
abundance remained high ($`r round(100*usda_adjdvcabunSyncExp,0)`\%$) even after 
controlling for traffic volume. 
Thus, in contrast to the county-level result, the 
result that deer abundance synchrony explained
$`r round(100*usda_dvcabunSyncExp,0)`\%$ of DVC synchrony was straightforwardly 
interpretable.
## Statewide results

In general results of the statewide analysis 
mostly agreed with the smaller spatial unit 
analyses. Deer abundance and DVCs were marginally 
significant over the $3-7$-year timescale band 
($P = `r ann.dvc.abun_pval`$), with most of the 
significance occurring over 
the $3-5$ year part of the timescale average 
($P = ann.dvc.abun_pval35$). DVCs were not 
significant with abundance after correcting for 
traffic ($P = `r ann.adjdvc.abun_pval`$). Snow depth, 
MEIs, MEIw and PDOw were all significantly 
coherent with deer abundance over the $3-7$ 
timescale band (Snow: $P = `r ann.abun.snow_pval`$; 
MEIw: $P = `r ann.abun.wmei_pval`$; MEIs: 
$P = `r ann.abun.smei_pval`$; PDOw: 
$P = `r ann.abun.wpdo_pval`$). Deer hunters and deer 
abundance were not significantly coherent at the 
state level ($P = `r ann.abun.hunter_pval`$).

\newpage

# References {-}

<div id="refs"></div>

\newpage
# Supplementary figures
\begin{figure}[h!]
\includegraphics[width=\textwidth]{Results/FigS1.png}
\caption{Raw time series of (A) deer abundance, (B) deer-vehicle collisions, 
(C) average winter ($\text{Dec}_{t-1}$ to $\text{Mar}_t$) snow depth, and 
(D) winter climate indices (Multivariate El Niño Southern Oscillation Index, 
MEI; Pacific Decadal Oscillation, PDO), and hunter abundances (E). 
Each line in A-C, E represents a county. Other variables (e.g., Tmin) were 
used in analyses but are not shown here due to lack of significant 
assocations with the deer and DVC variables that were the focus of the 
study.\label{FigS1_Timeseries}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[height=0.8\textheight]{Results/FigS2.png}
\caption{Map of Wisconsin, USA. Black lines and yellow dots delineate county boundaries and centroids. Color shading and black dots delineate USDA district boundaries and centroids.\label{FigS2_map}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/FigS3.png}
\caption{Phase differences between variables as a function of timescale for all significant relationships of 
Table \ref{TabS1_CountyCoherenceSummary}, county-level data: A) winter MEI ($\text{MEI}_{\text{w}}$) 
and deer abundance, B) summer MEI and 
deer abundance, C) winter PDO ($\text{PDO}_{\text{w}}$) and deer abundance, 
D) snow depth and deer abundance, E) deer abundance and 
deer-vehicle collisions, F) deer abundance and deer-vehicle collisions adjusted for traffic volume, and 
G) deer abundance and hunter abundance. $\bar{\theta}$ indicates the mean phase (in units of $\pi$
radians) for the shaded timescale bands. Horizontal axes differ in extent among panels due to different
time ranges of available data for different variables. \label{FigS3_PhaseDiffs}}
\end{figure}
<!--***DAN: Tom, I found this sentence included as the last sentence of the above caption: "Vertical axes differ between left and right panels because time series were shorter for DVCs." This does not make any sense to me.
I think it must be an error, so I removed it. But if I am mistaken and the sentence should be put back, please
put it back and clarify/correct it. For one thing, the vertical axes do not differ across panels.-->

\newpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/FigS4.png}
\caption{Rank, by timescale, of spatial coherence values in surrogate spatial coherence distributions (\emph{Methods}) for significant relationships (Table \ref{TabS1_CountyCoherenceSummary}) using county-level data. The red horizontal dashed line corresponds to a nominal confidence level of $95\%$. In A), results are comparisons of the listed variables with deer abundance. In B), `Abun-DVCs' is a comparison of deer abundance and DVCs, `Abun-Adj. DVCs' is a comparison of deer abundance and DVCs adjusted for traffic, and `Hunters-Abun' is a comparison of hunter numbers and deer abundance. The red horizontal line would be analogous to a $P$-value of $0.05$ for an individual timescale (\emph{Methods}).\label{FigS4_RanksInSurrogs}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[width=.6\textwidth]{Results/FigS5.png}
\caption{Wavelet mean field (A) and wavelet phasor mean field (B) magnitudes of county-level hunter abundance 
time series, and predicted synchrony of deer abundance based on a wavelet model with sole predictor hunter 
abundance (C). Higher values in A, B indicate greater synchrony (A) or phase synchrony (B) of hunter abundance 
time series at the indicated times and timescales. Contours on (B) indicate statistical significance of phase 
synchrony at $P = 0.001$. Colors in (C) show predicted synchrony in deer abundance, while contours show the 
actual wavelet mean field magnitude of deer abundance (from Fig. \ref{MT-Fig2_DeerSync}A). Agreement is poor, 
giving a 
visual indication of the statistical result that hunter abundance does not explain deer abundance or synchrony 
well on $3-7$-year timescales.\label{FigS5_WMFHunter}}
\end{figure}

<!--***DAN: Tom, the contours on C are supposed to look *exactly* the same as the countours on Fig. 2C, right?
They do not (they are not even particularly close!). What's going on?-->

\newpage

\begin{figure}[!h]
\includegraphics[height=.8\textheight]{Results/FigS6.png}
\caption{Wavelet mean field (A, B) and phasor mean field (C, D) magnitudes, and predicted synchrony (E, F) for deer abundance (A, C, E) and DVCs (B, D, F) using USDA-district data. Higher values in A-D indicate greater synchrony (A, B) or phase synchrony (C, D) at the indicated times and timescales. Contours on (C, D) indicate statistical significance of phase synchrony at $P = 0.001$. Colors in (E) show synchrony in deer abundance predicted from a wavelet model using snow depth, $\text{MEI}_{\text{w}}$, and $\text{PDO}_{\text{w}}$ as predictors, while contours show the actual wavelet mean field magnitude of deer abundance from (A), for comparison; agreement is good, giving a visual indication of the statistical result that climatic Moran effects explain deer synchrony. Colors in (F) show synchrony in DVCs predicted by a wavelet model with sole predictor deer abundance, while contours are from (B) and again show good agreement. Vertical axes differ between left and right panels because time series were shorter for DVCs. \label{FigS6_WMFAndPredictionsDistricts}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[height=.9\textheight]{Results/FigS7.png}
\caption{Wavelet mean fields (left column) and wavelet phasor mean fields (right column) of winter Tmin (A, B), Tmax (C, D), snow depth (E, F) and precipitation (G, H) using county-level data. Colors and contours as in Fig 2A,B\ref{Fig2}. \label{FigS7_WMFsAndWPMFsAncillary}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[height=.9\textheight]{Results/FigS8.png}
\caption{Wavelet amplitude of the winter and summer PDO (A,B), NAO (C,D), and MEI (E,F), respectively. Amplitude is the magnitude of the wavelet transform, normalized by the square root of the time-averaged, squared magnitudes of the wavelet transform. Higher values indicate greater variation content at that time/or timescale. \label{FigS8_WaveletAmps}}
\end{figure}

\newpage
\clearpage

# Supplementary tables

```{r TableS1,echo=F,results='markup'}
options(knitr.kable.NA = '') #makes it put blanks instead of "NA" for NAs
knitr::kable(TableS1,
             format='pandoc',
             digits=4,
             col.names=c("Predictor","Response","Timescale", "P-value","Mean phase ($\\bar{\\theta}$)","Synchrony explained","Average cross terms"),
             caption = "Summary of spatial coherence tests and related results using county-level data (*Methods*). Each row is based on a test of spatial wavelet coherence of the variables in the first two columns. Tests were across the $3-7$-year timescale band, except for ancillary results in the footnotes. $P$-values are provided for all tests, and average phases over the timescale band used, fractions of synchrony explained, and average cross terms (*Methods*) are provided where meaningful (for significant tests, $P < 0.05$, or marginally significant tests). A positive mean phase indicates the response is leading, and a negative mean phase indicates the predictor is leading. Cross-terms are zero for the climate indices because they used the same values for all locations (*Methods*). All values were rounded to display four digits.$^1$ \\label{TabS1_CountyCoherenceSummary}",
             booktabs=T)
```

\newpage

```{r TableS2,echo=F,results='markup'}
knitr::kable(TableS2,
             col.names=c("Predictor","Response","Timecale","P-value","Mean phase ($\\bar{\\theta}$)"),
             format='pandoc',
             caption = "$P$-values of wavelet coherence and mean phase difference between climate indices. Values are over $3-7$ year timescales Mean phases are only shown for pairs of variables that were both significantly coherent with deer abundance). \\label{TabS2_PairwiseClimVarSpatCoh}",
             booktabs=T)
```

\newpage

```{r TableS3,echo=F,results='markup'}
knitr::kable(TableS3,
             format='pandoc',
             col.names=c("Predictor","Response","Timecale","P-value","Mean phase ($\\bar{\\theta}$)"),
             caption = "$P$-values of spatial coherence between climate indices and average winter weather conditions using county-level data over $3-7$ year timescales. \\label{TabS3_SpatCohPWWAndClimInds}",
             booktabs=T)
```

\newpage

```{r TableS4,echo=F,results='markup'}
knitr::kable(TableS4,
             format='pandoc',
             col.names=c("Predictor","Response","Timescale", "P-value","Mean phase ($\\bar{\\theta}$)","Synchrony explained","Average cross terms"),
             caption = "Summary of spatial coherence tests and related results using USDA district-level data (*Methods*). Each row is based on a test of spatial coherence of the variables in the first two columns. Tests were across the $3-7$-year timescale band, except for ancillary results in the footnotes. $P$-values are provided for all tests, and average phases over the timescale band used, fractions of synchrony explained, and average cross terms (*Methods*) are provided where meaningful (i.e., for significant tests, $P < 0.05$). A positive mean phase indicates the response is leading, and a negative mean phase indicates the predictor is leading. Cross-terms are zero for the climate indices because they used the same values for all locations. \\label{TabS4_SummaryDistrict}",
             booktabs=T)
```

\newpage

```{r TableS5,echo=F,results='markup'}
knitr::kable(TableS5,
             format='pandoc',
             caption = "$P$-values of spatial coherence between climate indices and average winter weather conditions using USDA district-level data over 3-7 year timescales. \\label{TabS5_SpatCohPWWAndClimInds_District}",
             booktabs=T)
```
