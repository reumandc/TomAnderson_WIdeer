---
title: Supplementary Materials for "Synchrony Causes Major Cycles in Deer Populations
  and Deer-Vehicle Collisions Across Wisconsin"
author: Thomas L. Anderson, Lawrence W. Sheppard, Jonathan A. Walter, Robert E. Rolley,
  Daniel C. Reuman
date: 'correspondence to: anderstl@gmail.com, reuman@ku.edu'
output:
  pdf_document:
    fig_caption: yes
    keep_tex: yes
    includes:
      in_header: head_supp.sty
  html_document:
    df_print: paged
  word_document: default
geometry: left=1cm,right=1cm,top=2.5cm,bottom=2.8cm
link-citations: yes
csl: science.csl
tables: yes
bibliography: AndersDeerShortRefs.bib
urlcolor: blue
---

\textbf{This PDF file includes:}  
> Materials and Methods  
> Supplementary Text  
> Figs S1 to S8  
> Table S1 to S5  
> Full Reference list[@Leibhold2004_sync; @Allstad2015_gypsysync; @Moran1953; @Ranta1997_moran; @Kendall2000_moran; @Abbott2007_moran;@Defriez2016_plankton;@Sheppard2016_aphids;@Defriez2017_terrestrial; @Sheppard2017_surrogates; @Walter2017_geogsync; @Cote2004_deerimpacts; @Conover2011_bookchp; @Winkler2013_hunters; @usfws2011_survey; @Sheppard_wavmodel;  @Mysterud2008_deerclimate; @Hegel2012_caribou; @Rodionov2003_elnino; @Post1998_popgrowth; @Post2004_greenland; @Grotan2005_roedeer; @Huijser2008_dvc; @Marcoux2010_dvc; @Koenig2016_birdsync; @Shestakova2016_forestsync; @Cai2014_elnino;@widnr2001; @Ciuti2015; @Millspaugh2009; @Buonaccorsi2001; @Sheppard2013; @Theiler1992; @Schreiber2000]  

<!--Libraries-->
```{r libraries, echo=F, message=FALSE}
library(reshape2,quietly=T)
library(tools,quietly=T)
library(fields,quietly=T)
library(rmarkdown)
library(shape)
library(tinytex)
library(devtools,quietly=T)
library(withr,quietly=T)
```

<!--Flags controlling the run and other setup-->
```{r setup, echo=F}
#which density to use ("dnr" for original estimates, "tom" for your own calculations)
dens.flag<-"dnr"

#what is the earliest year you want? (abundance: 1981; DVC: 1987; Traffic: 1988, Hunters: 1992)
minyear<-1981

#what is the last year you want? (max is 2016)
maxyear<-2016

#set number of surrogates to use for spatial wavelet coherence
nsurrogs<-100000

#a function needed for caching
source("Code/mtime.R") 
```

<!--Generate the data-->
```{r data_generation, echo=F, cache=TRUE, results="hide", fig.show="hide", cache.extra=list(dens.flag,minyear,maxyear,mtime("Code/Deer_DataGeneration.R"),mtime("Data/WI_Cty_CentroidDD.csv"),mtime("Data/DOT_Accidents1987_2016.csv"),mtime("Data/Adj_DOT_Accidents1987_2016.csv"),mtime("Data/WI_USDA_Sections.csv"),mtime("Data/USDA_centroids.csv"),mtime("Data/Cty_Traffic.csv"),mtime("Data/DMU_DeerAbundance1981_2013.csv"),mtime("Data/DMU_DeerDensity1981_2013.csv"),mtime("Data/DMU_HunterAbundance1975_2013.csv"),mtime("Data/DMU_HunterDensity1975_2013.csv"),mtime("Data/hunterdens1416.csv"),mtime("Data/hunterabun1416.csv"),mtime("Data/Cty_Abun_2014_2016.csv"),mtime("Data/permit_issued1970_2013.csv"),mtime("Code/Climate_DataGeneration.R"),mtime("Data/noaa_latlongUpd.csv"),mtime("Data/WI_USDA_Sections.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set1.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set2.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set3.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set4.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set5.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set6.csv"),mtime("Data/Cty_NOAA_Temp2016_2017.csv"),mtime("Data/Cty_NOAA_Precip1981_1985.csv"),mtime("Data/Cty_NOAA_Precip1986_1991.csv"),mtime("Data/Cty_NOAA_Precip1992_1997.csv"),mtime("Data/Cty_NOAA_Precip1998_2003.csv"),mtime("Data/Cty_NOAA_Precip2004_2009.csv"),mtime("Data/Cty_NOAA_Precip2010_2015.csv"),mtime("Data/Cty_NOAA_Precip2016_2017.csv"),mtime("Data/climate_indices.csv"),mtime("Data/mei.csv"),mtime("Data/pdo.csv"))}

#Dependencies (listed in cache.extra above):
#1) Settings variables from the setup chunk
#2) all the data csvs (see Data folder)
#3) all the scripts sourced below (see Code folder)
#4) all the functions called (see Functions folder)

#Clean population data: end result are two lists of matrices called "cty.list" and "usda.list". Cty stands for county. All elements of cty.list are matrices, counties (rows) by year (columns). Elements are named Abun (abundance), Crashes (DVCs), Traffic (traffic), and AdjDVC (Traffic-adjusted DVCs). USDA stands for USDA districts, and all elements in "usda.list" are matrices, districts (rows) by year (columns) and named similarly to cty.list. In both lists, the data sets were complete in spatial dimension but varied in temporal dimension: deer span the years 1981-2016, Crashes 1987-2016 and Traffice/AdjDVCs 1988-2016. Missing years are filled with NAs. Both objects are saved as .rds files in the Results folder. These data sets are also used to generate state-level (single time series) data for deer abundance, DVCs, and hunter numbers. 

#***QC_Tests/tests_datagen_deer.R and QC_Tests/tests_datagen_climate.R are testing scripts to verify different data aggregatoin steps provide identical lists of raw data
source("Code/Deer_DataGeneration.R")

#Clean winter weather and climate data: end results are four lists of matrices called "winter.clim", climindex, winter.clim.usda, and climindex.usda. "winter.clim"" includes matrices, counties (rows) by year (columns) that are the averages of NOAA weather station data from Dec[t-1] to Mar[t], with named elements of Tmin (minimum temperature), Tmax (maximum temperature), Prcp (precipitation), and Snwd(snow depth). Not all counties had weather data in all years and are filled with NAs where missing. "winter.clim.usda"" are matrices, districts (rows) by year (columns) and includes the same variables and variable names as "winter.clim"" but averaged over USDA districts (~ 7 counties per district) and are complete in both dimensions. All objects are saved as .rds files in the Results folder."climindex" and "climindex.usda" are matrices of climate indices averaged over winter (Dec[t-1]-Mar[t]) and summer (Apr[t]-Nov[t]). Values in each matrices are repeated across rows because the climate indices are not a spatial variable. The dimensions of each match the spatial dimensions of other county (climindex) or district (climindex.usda) data sets. These data sets are also used to generate state-level (single time series) data for snow depth and climate indices. 
source("Code/Climate_DataGeneration.R")

```

```{r analysis, echo=F, cache=TRUE, results="hide", fig.show="hide", cache.extra=list(cty.list,usda.list,winter.clim,climindex,winter.clim.usda,climindex.usda,nsurrogs,mtime("Data/abunsurrsum.csv"),mtime("Data/dvcsurrsum.csv"),mtime("Code/DeerCoherence_wsyn.R"))}

#Run spatial coherence analysis on deer abundance and DVCs using county and district data. Tests include the effects of climate indices on deer abundance, winter weather on deer abundance, climate indices on winter weather, deer abundance on DVCs, deer abundance on traffic-adjusted DVCs. Also, run wavelet coherence on state level data between the same sets of variables. 
set.seed(101)
source("Code/DeerCoherence_wsyn.R")
```

<!---generate plots--->
```{r plots, echo=F, cache=T, results="hide", fig.show="hide", cache.extra=list(cty.list,usda.list,winter.clim,climindex,winter.clim.usda,climindex.usda,wlm_abun,wlm_dvc,mtime("Code/deer_plots.R"),mtime("Functions/Fn_wmfwt.R"),mtime("Functions/Fn_rankplot.R"),mtime("Code/PedagogFig.R"),mtime("Functions/deer_plotting_functions.R"))}
#generate plots
set.seed(201)
source("Code/deer_plots.R")
```

```{r echo=F, results="hide"}

#need to run so that objects that are large numbers can be evaluated with inline code
options(scipen = 999999)

#load in results
options(scipen=6)
#Load tables of results
TabS4_results<-readRDS(file = "Results/TableS4.rds")
TabS1_results<-readRDS(file = "Results/TableS1.rds")

usda_abunsnwd_syncexp34<-TabS4_results$SynchronyExplained[TabS4_results$Predictor=="Snow Depth" & TabS4_results$Response=="Abundance" & TabS4_results$Timescale=="3-4"]
usda_dvcabunSyncExp<-TabS4_results$SynchronyExplained[TabS4_results$Response=="DVCs" &
                                                        TabS4_results$Predictor=="Abundance"]
usda_adjdvcabunSyncExp<-TabS4_results$SynchronyExplained[TabS4_results$Response=="Traffic-adj. DVCs" &
                                                        TabS4_results$Predictor=="Abundance"]
snowabunSyncExp34<-TabS1_results$SynchronyExplained[TabS1_results$Predictor=="Snow Depth" & TabS1_results$Timescale=="3-4"]
avgdeerfluc<-readRDS(file="Results/totaldeerfluctuations.rds")
avgdvcfluc<-readRDS(file="Results/totaldvcfluctuations.rds")
avgdvccostsLow<-readRDS(file="Results/totaldvccostsLow.rds")
avgdvccostsHigh<-readRDS(file="Results/totaldvccostsHigh.rds")

abunmodelSyncExp<-readRDS(file="Results/abunmodelSyncExp.rds")
abunmodelXterms<-readRDS(file="Results/abunmodelXterms.rds")
usda.abunmodelSyncExp<-readRDS(file="Results/usda.abunmodelSyncExp.rds")
usda.abunmodelXterms<-readRDS(file="Results/usda.abunmodelXterms.rds")
gunhunter_percent<-round(100*mean(state.totals$GunHunters[state.totals$Year>1980]/(state.totals$GunHunters[state.totals$Year>1980]+state.totals$BowHunters[state.totals$Year>1980])),0)
```
# Materials and methods

## Deer and hunter abundance data

We obtained deer abundance estimates from the Wisconsin Department of 
Natural Resources (WIDNR) spanning the `r dim(cty.list$Abun)[2]`-yr period `r minyear`-`r maxyear`; (Fig. \ref{FigS1_Timeseries}). 
From 1981-2013, deer abundance was estimated for deer management units 
(DMUs, $N=$ 101-139 depending on the year). For most years and DMUs, 
abundance was estimated using a sex-age-kill (SAK) model, with aerial surveys or 
accounting models used for a smaller number of years and DMUs [@widnr2001]. 
In $2014$, DMU boundaries were changed to match counties ($N=72$). Because of this, and because other 
spatial variables (e.g., DVCs, climate) were gathered at the county level, 
we transformed the 1981-2013 abundance estimates for DMUs 
into county-level estimates. To do so, we first calculated the areas 
of intersection between DMU and county boundaries for each year (as 
DMU boundaries changed frequently), using the 'intersect' function in 
Arc GIS 10.3 (ESRI, Redlands, CA). We then calculated deer abundance 
for each intersection area by multiplying the amount of deer habitat in 
each intersection area by the WIDNR density estimate of deer for the DMU 
that the intersection fell within. Deer habitat was considered to comprise 
areas of permanent cover (e.g., forests) that were $>4$ ha in size, plus agriculture and grass fields within 100 m of permanent cover. DMU deer 
densities were calculated by dividing the DMU abundances originally provided to us
by the amount of deer habitat within the DMU [@widnr2001]. This procedure 
assumes approximately spatially uniform densities of deer within deer 
habitat across each DMU. The abundance for a county was the sum of 
the estimated abundances of the county's intersections with DMUs. 
We dropped one county (Menominee) due to incomplete data for most 
variables, leaving `r length(unique(dat$COUNTY_NAM))` counties for statistical analysis.

We obtained from the WIDNR estimated hunter abundance data for each DMU for the years 1992-`r maxyear`
(Fig. \ref{FigS1_Timeseries}); these data constituted an index of the estimated 
number of hunters during the first two days of the 9-day gun 
hunting season [@widnr2001], assuming this was a good proxy 
for hunter numbers across the season. Gun hunters on average represent $`r gunhunter_percent`\%$ of the total hunters in WI each year over the years of this study.
<!--***DAN: I think we should add 1-2 sentences arguing why this is a  reasonable assumption, perhaps by giving data, if available, on how many gun v other types of hunters there are, and how many people go the opening 2 days versus later in the week. Let's discuss, Tom.-->
<!--***Tom::I doubt whether there is any data on your last statement, how many go early versus late. I'm not sure I follow the gun v other types of hunters argument- do you mean that the majority of deer get killed by gun hunters and thus that would be the best estimate of hunters for regulating deer?-->
<!--***DAN: Yes, that is what I mean. We are using numbers of gun hunters during the first two days of the gun season as an index for total hunters of all kinds during all of the hunting seasons for weapons of different types. So, if possible, it would be good to give some supporting evidence that numbers of gun hunters in the whole 9-day gun season are correlated with numbers in the first weekend, and that numbers of total hunters are well-represented by numbers of gun hunter (which could be either because there is a correlation between total hunters and gun hunter, or because the large majority of hunters are gun hunters).--><!--***TOM::--See if my statement helps. --><!--***DAN: yes, this is better. Please delete all these comments once you have read this, Tom, I think the issue is resolved now.-->
We estimated hunter abundances 
for counties using the same method as for deer abundance. We 
dropped 18 counties due to incomplete survey 
efforts of hunters or missing data, leaving 53
counties for analysis that used the hunter density data. 

## DVC data

We obtained estimates of DVCs for each county, spanning the 
years 1987-`r maxyear`, from the WI Department 
of Transportation (WIDOT; Fig. \ref{FigS1_Timeseries}). These data reflect 
the number of police-investigated DVCs; they are an 
index of DVCs, as opposed to an absolute number of incidents, 
since not all DVCs are reported. In Michigan, nearly half of 
DVCs went unreported to the police or insurance companies 
over a five-year period [@Marcoux2010_dvc]. Additionally, 
DVC information was collected with reporting effort that 
may have varied for different counties 
(Daniel Storm, WIDNR, Personal Communication), and the 
threshold of damage for the police to respond to and report on 
an incident increased statewide in 1996 from US\$500 to US\$1000. 
However, features of the data such as these could only have obscured 
and could not have artefactually generated the strongly 
significant spatial wavelet coherence relationships we report between 
DVCs and deer abundance. Shortcomings of the DVC data added 
noise to the DVC data and likely obscured the relationship 
with deer abundance, so that if better DVC data were available 
this relationship may have been even stronger than that reported. 
We also obtained traffic volume estimates (millions of miles 
driven) for each county spanning the years 1988-`r maxyear` from the 
WIDOT, to control for traffic in our analysis of DVCs.

## Weather and climate data

We obtained daily weather data (minimum and maximum air temperature 
[here called Tmin and Tmax], snow depth, and precipitation) from 
all available weather stations in each county from the 
National Climatic Data Center ([`https://www.ncdc.noaa.gov/`](https://www.ncdc.noaa.gov/)). We 
averaged daily values across the winter ($\text{Dec}_{t-1}$ 
to $\text{Mar}_t$) and across stations within a county to produce 
annual time series of winter weather by county which were used in 
all subsequent analyses (Fig. \ref{FigS1_Timeseries}). The number of 
weather stations per county and data collected at each station 
varied, resulting in different spatial extents for each variable 
in order to retain the full temporal extent: Tmin, $N=$ `r dim(winter.clim$Tmin[!is.na(rowMeans(winter.clim$Tmin)),])[1]`
counties; Tmax, $N=$ `r dim(winter.clim$Tmax[!is.na(rowMeans(winter.clim$Tmax)),])[1]`; precipitation, $N=$ `r dim(winter.clim$Prcp[!is.na(rowMeans(winter.clim$Prcp)),])[1]`; snow depth, $N=$ `r dim(winter.clim$Snwd[!is.na(rowMeans(winter.clim$Snwd)),])[1]`. 
We also calculated a Winter Severity Index (WSI, $N=$ `r dim(winter.clim$WSI[!is.na(rowMeans(winter.clim$WSI)),])[1]`), 
a metric known to impact deer populations [@widnr2001]. WSI is the sum of the total number of days for which snow depth was greater 
than 18 inches or Tmin was less than $0^\circ$F. 

We obtained monthly estimates of three global climate indices: 
the North Atlantic Oscillation (NAO), the multivariate 
El Ni\~no/Southern Oscillation Index (MEI), and the Pacific 
Decadal Oscillation (PDO). All of these have been shown to 
influence large ungulate population dynamics in the north central 
USA [@Post1998_popgrowth;@Post2004_greenland]. 
We averaged monthly values across the 
approximate growing season (Apr-Nov), and the winter 
($\text{Dec}_{t-1}$ to $\text{Mar}_t$) for each index 
(Fig. \ref{FigS1_Timeseries}). We used a total of 11 weather and 
climate variables in subsequent analyses: winter Tmin, Tmax, 
snow depth, and precipitation; winter NAO, MEI, and PDO; 
growing-season NAO, MEI and PDO; and the WSI. All were annual 
time series at the county level. <!--TOM: I'm not sure this technically correct for teh climate indices, since its one value for all counties? Maybe delete this?-->

## Data pre-processing

We performed all analyses described below and in the main text 
at three spatial scales: counties (N = 44-`r dim(cty.list$Abun)[1]` depending on 
the variables involved; mean county 
area $\pm$ SD = `r round(mean(gps$Area_km2),0)` $\pm$ `r round(sd(gps$Area_km2),0)` $\text{km}^2$), 
United States Department of Agriculture (USDA) districts ($N = 9$; mean 
district area $\pm$ SD = `r round(mean(usda.centroid$Area_km2),0)` $\pm$ `r round(sd(usda.centroid$Area_km2),0)` $\text{km}^2$), 
and statewide (Fig. \ref{FigS2_map}). Analyses at three spatial scales 
were performed because the SAK model used by the WIDNR to estimate deer 
abundance for each management unit has been criticized as less accurate 
at smaller spatial scales [@Millspaugh2009]. The bias in abundance 
estimates previously reported [@Millspaugh2009] may have been overestimated, as more recent analyses 
suggest the uncertainty in SAK estimates is substantially less 
($\pm 20\%$ error rates). 
In addition, the criticism of the SAK [@Millspaugh2009] was based 
on a model that did not match perfectly with practices of the WIDNR. 
Nevertheless, 
to ensure our results were not biased, we analyzed 
synchrony on multiple spatial scales including two larger scales 
(districts and statewide) for which SAK data have not been criticized. 
USDA district data were 
produced as the sum or 
average of county-level variables, as districts were always conglomerates 
of counties (Fig. \ref{FigS2_map}). 
Statewide analysis used state total or average time series for each 
variable. In general, results remained unchanged in their main substance using data 
aggregated to larger spatial scales (Table \ref{TabS4_SummaryDistrict}, \ref{TabS5_SpatCohPWWAndClimInds_District}, 
Fig. \ref{FigS8_WMFAndPredictionsDistricts}), suggesting results for counties were not 
meaningfully influenced by possible inaccuracies in SAK abundance estimation 
procedures at the county level.

We performed an optimal Box-Cox transformation on each time series to help ensure Gaussian marginal distributions [@Sheppard2016_aphids], which are necessary for the Fourier-surrogate-based spatial wavelet coherence and wavelet linear regression procedured described below. This process also included linear detrending (and subtracting the mean) to remove any long-term trends that might otherwise obscure patterns of synchrony [@Buonaccorsi2001]. Time series
variances were also standardized to 1. These steps were done via the `cleandat` function in the `wsyn` package for the R programming language, available at `www.github.com/reumandc/wsyn/CRANv1p0p0` and on the Comprehensive R Archive Network (CRAN).

## The wavelet mean field and wavelet phasor mean field

We assessed the strength of synchrony 
and its dependence on time and timescale for 
all spatiotemporal variables using two 
statistical tools: the wavelet mean field and 
the wavelet phasor mean field [@Sheppard2013;@Sheppard2016_aphids]. 
Both of these are standard tools in 
some biological fields and well established; they are described in 
mathematical detail elsewhere [@Sheppard2013;@Sheppard2016_aphids] and 
operationally here. Both techniques take as 
input time series measured at the same times 
in several locations, and return as output 
complex-number-valued functions of time 
and timescale. When the complex magnitudes of 
these functions are plotted against time 
and timescale, the plots characterize the degree 
of synchrony among the input time series and how 
it may have changed over time or differed by 
timescale (Figs \ref{MT-Fig1_example}, \ref{PedagogFigWMF}). 
The wavelet phasor mean field magnitude 
quantifies the degree to which phases of 
oscillation in the input time series were the 
same across locations, as a function of time 
and timescale. The wavelet mean field 
magnitude incorporates information not only 
on phase synchronization but also on the 
tendency of oscillatory components on any 
given timescale to have magnitudes which are 
correlated through time across the sampling 
locations. Both quantities are based on complex Morlet 
wavelet transforms of each input time series. 
Statistical significance of the wavelet phasor mean 
field, compared to a null hypothesis of no phase 
synchrony, can be assessed for each combination of 
time and timescale. For any given time and 
timescale, significance testing compares the degree 
of phase consistency between sampling locations for 
real time series to a null hypothesis of random 
phases. If real phase consistency was greater than 
that of $99.9\%$ of sets of random phases 
($P < 0.001$, one-tailed test, see contours on, e.g., Figs \ref{MT-Fig2_DeerSync}B and \ref{MT-Fig3_DvcSync}B), synchrony was 
deemed significant and important 
[@Sheppard_wavmodel]. Wavelet mean field and 
wavelet phasor mean field magnitude plots for 
winter weather variables are in 
Fig. \ref{FigS9_WMFsAndWPMFsAncillary}. Wavelet mean fields were computed using the
function `wmf` and wavelet phasor mean fields were computed using the function `wpmf` in the `wsyn` package for the R programming language.

All plots based on wavelet transforms are "scalloped", i.e., values corresponding to longer timescales and times closer to the start or end of available data are not plotted. This is because the wavelet transform is based on convolutions of wavelet functions with the timeseries being transformed. Convolutions for which a substantial portion of the wavelet function overhangs the edge of the data are unreliable. "Scalloping" wavelet plots is standard practice.

## Spatial wavelet coherence and wavelet coherence

For both county- and district-level data, we 
assessed pairwise relationships between 
spatiotemporal variables using the spatial wavelet coherence 
technique. This technique is also a well-established and standard tool in some biological fields; it is described in detail 
elsewhere [@Sheppard2013;@Sheppard2016_aphids;@Sheppard2017_surrogates] and  operationally
here. Spatial wavelet coherence tests whether two 
spatiotemporal variables exhibit consistent phase 
differences and correlated magnitudes of 
oscillation through time and across space, as a 
function of timescale. Significance is determined 
by comparing spatial wavelet coherence of data with 
spatial wavelet coherences of appropriately randomized, 
surrogate data sets ($N=$ `r nsurrogs` surrogates 
were used for all tests) 
that retain the same 
temporal and spatial autocorrelation properties as 
the original time series but are otherwise 
unrelated to each other [@Theiler1992;@Schreiber2000]. Standard Fourier 
surrogates were used [@Schreiber2000;@Sheppard2013;@Sheppard2016_aphids]. 
We calculated how often observed spatial wavelet coherence 
between pairs of variables was ranked higher than 
coherences of surrogate data sets, aggregating 
across the timescale band of interest using an 
average-rank-based method described in detail 
elsewhere [@Sheppard2016_aphids]. A $p$-value of $0.05$ 
means that the empirical spatial wavelet coherence was higher, in an average 
sense across the timescale band of interest, than the same 
quantity calculated for `r 0.95*nsurrogs` of `r nsurrogs` 
surrogate data sets representing the null hypothesis of no relationship between variables. Ranks of actual spatial wavelet
coherences in surrogate spatial wavelet coherences were 
also plotted as a function of timescale 
(Fig. \ref{FigS4_PhaseDiffs}). Spatial wavelet coherences were computed and results were processed using the `coh`, `bandtest`, `plotrank`, `plotphase` and related functions in the `wsyn` package for the R programming language. The fast algorithm of [@Sheppard2017_surrogates] for assessing the statistical significance of spatial wavelet coherence was used.

Correlation-based approaches have been standard practice in synchrony studies [@Buonaccorsi2001], but these methods assume in-phase relationships. In contrast, spatial wavelet coherence 
allows for any kind of phase relationship and 
provides as part of its output the average phase that occurred between two variables. 
Therefore, when two variables had significant 
spatial wavelet coherence over a timescale band, we 
calculated the mean phase difference between the 
variables over the band, $\bar{\theta}$, in units of $\pi$ 
radians, to determine if oscillations had 
approximately in-phase ($|\bar{\theta}|=0$ to 
$0.25$), quarter-cycle ($|\bar{\theta}|=0.25$ to 
$0.75$), or anti-phase ($|\bar{\theta}|=0.75$ to 
$1$) relationships. We used "scalloped" 
wavelet transforms for 
calculating phase differences. Phase difference was not meaningful when spatial
wavelet coherence was not significant and so was not reported.

As with correlations, causal relationships between variables are not directly 
revealed by the spatial wavelet coherence. But biological arguments, combined 
with significant coherence and phase information, 
can strongly support one causal hypothesis over 
others. Climate and weather variables could not reasonably be influenced 
by deer abundance. Therefore, a highly significant 
spatial wavelet coherence between a weather variable and 
deer abundance on a timescale band of interest 
provides strong evidence that either the weather 
variable helped cause deer fluctuations and 
synchrony for those timescales, possibly 
indirectly, or some other weather variable, 
highly spatially 
coherent with the first variable, caused the 
fluctuations and synchrony. The highly significant 
coherence between deer abundances and DVCs we 
present in the main text is likewise probably 
indicative of greater deer abundances resulting in 
more DVCs. DVCs are too uncommon to meaningfully 
influence deer abundance (Fig. \ref{FigS1_Timeseries}), 
and the 
in-phase relationship our analyses revealed  between 
deer abundances and DVCs on $3-7$-year timescales 
is more consistent with deer 
dynamics driving DVC dynamics than the reverse. 

We used spatial wavelet coherence to test 
five weather variables (average winter Tmin, 
Tmax, snow depth, precipitation, and WSI), six 
climate variables (winter and growing season PDO, 
MEI and NAO) and hunter abundance as potential 
drivers of synchrony in deer abundance over the 
$3-7$-year timescale band. We also used spatial wavelet
coherence to test for a relationship of deer 
abundance with DVCs, and deer abundance with DVCs 
adjusted for traffic volume. When the temporal and 
spatial extents of available data for two spatiotemporal variables 
were not identical, we retained only the 
locations and time range over which data were 
available for both variables when testing for 
spatial wavelet coherence. When testing for spatial 
wavelet coherence between a spatiotemporal variable and a 
climate index (PDO, MEI or NAO, each of which 
comprised only a single time series), we considered 
that the same index time series pertained to all 
locations for which the spatiotemporal variable was 
measured. 

For statewide analyses, for which all variables 
were represented only by single, state-average or 
total time series rather than spatiotemporal data, timescale-specific relationships 
between variables were tested using ordinary 
wavelet coherence. Wavelet coherence is a 
non-spatial version of the spatial wavelet coherence, and 
tests whether two time series exhibit consistent 
phase differences and correlated magnitudes of 
oscillation through time, as a function of 
timescale. We tested for relationships between 
statewide deer abundance time series and climate 
indices, statewide averages for winter weather, 
statewide hunter abundance time series, and 
statewide total DVCs. The same functions in the `wsyn` package listed above for spatial wavelet coherence were used, as they can compute both ordinary wavelet coherence and spatial wavelet coherence.

## Wavelet Moran theorem, fractions of synchrony explained, and predicted synchrony

We calculated the amount of deer abundance 
synchrony explained by individual weather and 
climate variables, as well as the amount of DVC 
synchrony explained by deer abundance, following 
the wavelet Moran theorem of [@Sheppard2016_aphids]. 
As part of this procedure, we also calculated the 
average "cross terms" of [@Sheppard2016_aphids] over 
the timescale band of interest (see supplementary 
files of ref @Sheppard2016_aphids, equation 22), again following the 
procedures described in that reference. The precise 
mathematical meaning of cross terms is explained in 
[@Sheppard2016_aphids]; for operational purposes, they 
provide a test of whether modelling assumptions of 
[@Sheppard2016_aphids] are sufficiently met to use the 
wavelet Moran theorem to estimate fractions of 
synchrony explained. Cross terms less than $10\%$ 
of estimated fractions of synchrony explained were 
considered necessary to make statements about fractions of synchrony explained. Cross terms associated with a spatial wavelet coherence between a spatiotemporal variable and a non-spatial variable (such as one of the climate indices) were always $0$ by mathematical necessity [@Sheppard2016_aphids].

We calculated the amount of deer abundance 
synchrony jointly explained by snow depth, 
$\text{MEI}_{\text{w}}$, and $\text{PDO}_{\text{w}}$ using a wavelet multiple regression 
approach [@Sheppard_wavmodel]. This method, the detailed mathematics of which are described in [@Sheppard_wavmodel] along with an application, 
is analogous to multiple linear regression, with a 
model describing the relationship between a 
response variable and multiple predictor variables; 
but in contrast to standard regression, response 
and predictor variables are 
wavelet transforms of spatiotemporal variables. The approach gives several outputs which we use. First, the approach gives the fraction of synchrony (in our case, $`r round(abunmodelSyncExp,0)`\%$ for $3-7$-year timescales) in the response variable (county-level deer abundance) that can be explained by the synchrony of the predictors (snow depth, $\text{MEI}_{\text{w}}$, and $\text{PDO}_{\text{w}}$). The validity of this result is again subject to whether cross terms were small (less than $10\%$ of the fraction of synchrony explained). They were small, $`r round(abunmodelXterms,0)`\%$, for our model. The approach also gives a "predicted synchrony" plot (colors in Fig. \ref{MT-Fig2_DeerSync}C), which is a function of time and timescale. The plot shows what the pattern of synchrony in the response variable (deer abundance) would look like if the only drivers of synchrony were the predictor variables. Predicted synchrony plots can be compared directly to the wavelet mean field magnitude plot of the response variable, similarity of the two plots giving a visual indication of whether the predictors in the model adequately explain synchrony in the response variable. The function `wlm` and related functions from `wsyn` implement these tools.

Proper partitioning of spatial synchrony, into a component explained by the synchronous drivers in a wavelet linear model and a component corresponding to factors independent of those drivers (residuals in the model), is only possible if cross terms, which also appear in the model, are small compared to the other components [@Sheppard2016_aphids; @Sheppard_wavmodel].
Large cross terms correspond to a general association between the model (drivers, or predictor variables) at one location and the residuals of the model at other locations [@Sheppard2016_aphids; @Sheppard_wavmodel].  Such associations may occur as a result of the population at the first location dispersing to the second location and being included in the count there. Considering a coarser spatial scale limits the potential for dispersal to have such an influence on our statistics, so one expects that if cross terms are large at the county spatial scale, the problem may be mitigated at the district scale, as happened in some
of our analyses (see section "USDA district results" in Supplementary text). 

## Randomization procedure for removing synchrony at $3-7$-year timescales

In order to quantify the degree to which 
synchronizing effects are responsible for 
fluctuations in statewide total deer and DVC time 
series (Fig. \ref{MT-Fig4_StateWideFluctuations} and associated text), 
we adapted the standard Fourier surrogate procedure 
of @Theiler1992. We constructed artificial 
deer abundance and DVC time series for each 
location, having the same variance and spectral 
characteristics as the original data but no spatial 
synchrony in the $3-7$-year timescale band of 
interest. Components of variability and synchrony 
outside this band (such as longer-term trends or 
fluctuations, and higher-frequency components 
associated with 'spikiness' in the data) were left 
unchanged. To produce surrogate data for a given 
location, we took the Fourier transform of the time 
series and randomized the phases of the Fourier 
components inside the $3-7$-year timescale band 
before inverse transforming to produce the 
surrogate time series. Because only phases of the 
Fourier transform were randomized, power spectra and 
variances of time series are unchanged. 
Additionally, because phases in the $3-7$-year 
timescale band are randomized independently, 
surrogate time series so produced no longer exhibit 
a tendency to synchrony in the $3-7$-year timescale 
range [@Schreiber2000]. Phase randomization was 
accomplished by adding a random and uniformly distributed phase increment 
between $0$ and $2\pi$ to the phase of each Fourier 
component with a frequency greater than or equal to 
$1/7$, but less than $1/3$ cycles per year. 
Additionally, because the phase values of the 
Fourier components of a real signal are 
anti-symmetric about the Nyquist frequency ($1/2$ 
cycles/year), Fourier components with frequencies 
less than or equal to $6/7$ and more than $2/3$ 
cycles per year had the same set of phase 
increments subtracted to preserve the anti-symmetry 
property of Fourier transforms. We summed each set 
of surrogate time series spatially to produce a 
surrogate state-total time series representative of 
the hypothetical case in which $3-7$-year timescale 
synchrony was absent. Such surrogate state-total 
time series were compared to the actual time series 
(deer abundance or DVCs) to show the nature of the 
additional variance in the state-total time series 
that was attributable to synchrony (Fig. \ref{MT-Fig4_StateWideFluctuations}).

## Approximate monetary impact of DVCs

We estimated the approximate monetary impact of 
synchrony in DVCs based on several reported 
assumptions about DVCs. Using an average difference in DVCs
between peak and trough years 
(Fig. \ref{MT-Fig4_StateWideFluctuations}) of `r avgdvcfluc`, and if we assume 
that each reported DVC results in an average of 
US\$2024 of damage [@Conover2011_bookchp], the 
difference in damages statewide between peak and 
trough years is more than US\$5M. Given that DVCs 
may be only reported about 50% of the time 
[@Marcoux2010_dvc], this number is actually likely 
greater than US\$10M. Using different assumptions 
of the cost of DVCs [@Huijser2008_dvc], the 
difference between peak and trough years in DVC 
costs may exceed US\$22M.    

## Open science

We have adopted an open science approach throughout the project. As indicated in the sections above on individual methods, all computations were done using functions from the `wsyn` package for the R programming language, the source code of which is available from `www.github.com/reumandc/wsyn/CRANv1p0p0`. The package can be installed into R from CRAN or via `devtools::install_github(repo="reumandc/wsyn/CRANv1p0p0")`.
The `wsyn` package includes a vignette documenting how to use the functions implemented there, and giving examples; the vignette provides additional description of the methods of this paper. All data and code producing this paper are archived at `ww.github.com/reumandc/TomAnderson_WIdeer`, including the complete revision history of the process that led to the presented analyses.
The suite of analyses leading to this paper can be re-run and the paper re-compiled at the touch of a button via the codes in that repository - see the `Readme.md` file in the repository for instructions.

# Supplementary text

## USDA district results

Using district-level data, deer abundance 
again showed a prominent synchrony feature at $3-7$ year 
timescales, similar to the county-level analysis 
(Fig. \ref{FigS8_WMFAndPredictionsDistricts}A,C). Deer abundance was significantly related to $\text{MEI}_{\text{w}}$, 
and was marginally significantly related to $\text{PDO}_{\text{w}}$ on $3-7$-year timescales
(Table \ref{TabS4_SummaryDistrict}). Deer abundance was significantly related to snow depth on $3-4$-year timescales. These variables were the same ones identified as 
significantly coherent with deer abundance using 
county-level data. 
The phase relationships 
between these variables and deer abundance were also very similar 
to county-level relationships: snow depth and 
deer abundance were nearly in anti-phase; and climate 
indices and deer abundance showed approximately 
quarter-cycle phase shifts (Table \ref{TabS4_SummaryDistrict}). Combined, snow depth, $\text{MEI}_{\text{w}}$, and $\text{PDO}_{\text{w}}$ explained $`r round(usda.abunmodelSyncExp,0)`\%$ of the 
synchrony in deer abundance using 
USDA district data, and patterns of synchrony in deer abundance predicted by that model closely resembled actual patterns of deer abundance synchrony (Fig. \ref{FigS8_WMFAndPredictionsDistricts}E). Cross terms for this model were of small magnitude, $`r round(usda.abunmodelXterms,0)`\%$.

The climate indices explained similar amounts of 
deer abundance synchrony as for the county-level 
data (Table \ref{TabS4_SummaryDistrict}). Cross terms for snow depth and deer abundance over $3-4$-year timescales were too large at the county level to make a reliable statement of synchrony explained at that level, but cross terms were not too large for the district-level analysis, and snow depth explained $`r round(usda_abunsnwd_syncexp34,0)`\%$ of synchrony at $3-4$-year timescales. This makes sense in light of possible effects of dispersal at smaller spatial scales, as explained in the section "Wavelet Moran theorem..." above; effects of dispersal would have been reduced at district level because a smaller proportion of deer disperse between spatial units for larger spatial units.
The result that snow depth appeared to influence deer on $3-4$-year timescales, while $\text{MEI}_{\text{w}}$ and $\text{PDO}_{\text{w}}$ were significantly spatially coherent and explained synchrony at $4-7$-year timescales pertained to district-level data as it did for county-level data.

As in the county-level analyses, hunter abundance time series were not spatially coherent with deer abundance time series on $3-7$-year timescales (Table \ref{TabS4_SummaryDistrict}), so any synchrony there may have been in hunter abundances at those timescales could not have explained synchrony in deer. Again similar to the county-level analyses, hunter abundance time series were significantly coherent with deer abundance on $2-2.5$-year timescales (Table \ref{TabS4_SummaryDistrict}), but there was little deer abundance synchrony on those timescales to explain (Fig. \ref{FigS8_WMFAndPredictionsDistricts}A,C).

DVC data aggregated to USDA districts had a similar 
synchrony feature to deer abundance over $3-7$ year 
timescales (Fig. \ref{FigS8_WMFAndPredictionsDistricts}B,D). As 
at county level, deer abundance time series were significantly spatially coherent with DVC time series on $3-7$-year timescales (Table \ref{TabS4_SummaryDistrict}).
Whereas cross terms were high enough at county-level to render meaningless statements about fractions of DVC synchrony explained by deer synchrony, this was not the case at district level: cross terms were low (Table \ref{TabS4_SummaryDistrict}), and fractions of DVC synchrony explained by deer synchrony were $`r round(usda_dvcabunSyncExp,0)`\%$ for raw DVC data and $`r round(usda_adjdvcabunSyncExp,0)`\%$ for traffic-adjusted DVCs. The difference in cross terms between county- and district-level analyses again makes sense in light of dispersal, as explained above. Large cross terms may reflect the 
effects on the statistics of dispersal of 
deer between counties or movements of cars between 
counties, but such effects would be
reduced at the larger district level because reduced fractions of deer and cars disperse from one spatial unit to another for these larger spatial units. 
Patterns of synchrony in DVCs predicted by synchrony in deer looked similar to actual patterns of synchrony in DVCs (Fig. \ref{FigS8_WMFAndPredictionsDistricts}F). 

## Statewide results

In general, results of statewide analyses 
mostly agreed with the smaller-spatial-unit 
analyses, when they could be compared. Results on synchrony were not available at state level because at that level each variable is only represented by a single time series, but we compared wavelet coherence results between variables at the statewide spatial scale to spatial wavelet coherence results between variables using smaller spatial units. Statewide deer abundance and DVC time series were marginally 
significantly coherent over $3-7$-year timescales 
($P = `r round(ann.dvc.abun_pval,4)`$), with the strongest relationship occurring over 
$3-5$-year timescales ($P = `r round(ann.dvc.abun_pval35,4)`$). 
$\text{MEI}_{\text{w}}$ and $\text{PDO}_{\text{w}}$ were significantly 
coherent with deer abundance over the $3-7$-year 
timescale band ($\text{MEI}_{\text{w}}$, $P = `r round(ann.abun.wmei_pval,4)`$; $\text{MEI}_{\text{s}}$, 
$P = `r round(ann.abun.smei_pval,4)`$; $\text{PDO}_{\text{w}}$, 
$P = `r round(ann.abun.wpdo_pval,4)`$). Snow depth was not significant over $3-7$-year timescales ($P = `r round(ann.abun.snow_pval37,4)`$), but was significant at $3-4$-year timescales ($P = `r round(ann.abun.snow_pval34,4)`$), consistent with the results at other spatial resolutions. 
<!--***DAN: Tom: please add a test for snow depth on 3-4-year timescales--><!--TOM: Done; was significant-->
Hunter abundance and deer 
abundance were not significantly coherent at the 
state level on $3-7$-year timescales ($P = `r round(ann.abun.hunter_pval37,4)`$) or $2-2.5$-year timescales ($P = `r round(ann.abun.hunter_pval2_2.5,4)`$).
<!--***DAN: Tom, pls add a test for 2-2.5-year timescales--><!--TOM: Done, not significant-->

\newpage

# References {-}

<div id="refs"></div>

\newpage
# Supplementary figures
\begin{figure}[h!]
\includegraphics[width=\textwidth]{Results/FigS1.png}
\caption{Raw time series of (A) deer abundance, (B) deer-vehicle collisions, 
(C) average winter ($\text{Dec}_{t-1}$ to $\text{Mar}_t$) snow depth, and 
(D) winter climate indices (Multivariate El Ni√±o Southern Oscillation Index, 
MEI; Pacific Decadal Oscillation, PDO), and hunter abundances (E). 
Each line in A-C, E represents a county. Other variables were 
used in analyses (see text) but are not shown here due to lack of significant 
assocations with the deer and DVC variables that were the focus of the 
study.\label{FigS1_Timeseries}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[height=0.8\textheight]{Results/FigS2.png}
\caption{Map of Wisconsin, USA. Black lines and yellow dots delineate county boundaries and centroids. Color shading and black dots delineate USDA district boundaries and centroids.\label{FigS2_map}}
\end{figure}

\newpage

<!--***DAN: To get the references in the below caption to work,
I had to do them manually. Right now I am using author-date, but it needs to be changed to
numeric callouts right at the very end. If you could figure out a way to automate those, it would be great, but I don't think its possible because the below is latex code.--><!--TOM: I tried looking, but haven't found a solution yet-->

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/PedagogFig_WMF.png}
\caption[Demonstration of the wavelet mean field]{Detecting time- and timescale-specific
synchrony with the wavelet mean field. This figure was taken without change from
Sheppard \emph{et al.} (2016), where additional details are also available. Panels a-d show the principle of how synchrony
can differ for different timescales of dynamics. Time series y1 and y2 (a)
are exactly anti-correlated (out of phase), as are y3 and y4 (b). Combining
y1 with y3 and y1 with y4
gives two time series (c) which are synchronized on long timescales, but anti-synchronized
on short timescales. The reverse is also possible (d). This timescale-specific
structure of synchrony cannot be detected with correlation coefficients, which are
0 for both c and d, because contributions from different timescales cancel.
In practice, real population and environmental signals are broadband, and exact cancellation
is unlikely, but asynchrony at some frequencies can strongly conceal important
synchrony at other frequencies. Panels e-k demonstrate this concealment, using artificial data,
and also show how the wavelet mean field detects time- and timescale-specific synchrony.
Each of 11 artificial time series were constructed as the sum of: 1) a single common
signal of amplitude 1 that changes its oscillatory period at $t=50$ from 10 years
to 5 years (e); 2) oscillations
of amplitude 3 that have the same oscillatory period
(3 years), but random and independent phases in
each of the 11 constructed
time series (f); and 3) white noise of standard deviation 1.5, again independently
generated for each of the 11 time series (g). Synchrony in the resulting time series cannot
be visually detected (i), nor is it readily apparent by examining the
55 pairwise correlation coefficients between time series (j), which spanned a
wide range of values including 0. But the wavelet mean field magnitude (k)
showed clear color bands at 10-year period for $t<50$ and 5-year period for
$t>50$. The wavelet mean field magnitude displays strength of
synchrony as a function of timescale
of dynamics and time, here with red indicating synchrony and blue asynchrony.
Wavelet phasor mean fields provide plots similar to (k) but with values
between 0 and 1 that indicate the strength of phase synchrony and that can be
straightforwardly significance tested as described in Sheppard \emph{et al.} (In Review). \label{PedagogFigWMF}}
\end{figure}

\newpage

<!--***DAN: To get the references in the below caption to work,
I had to do them manually. Right now I am using author-date, but it needs to be changed to
numeric callouts right at the very end.--><!--TOM: same comment as above, still haven't found a solution-->

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/PedagogFig_SpatCoh.png}
\caption[Demonstration of spatial wavelet coherence]{Measuring relationships between variables using spatial wavelet coherence.
This figure was adapted with only minor changes
from supplementary figure 5 of Sheppard \emph{et al.} (2016).
The time series of panel e were used as drivers in producing the time series of
panel f and the figure shows
how this relationship can be detected with the spatial wavelet coherence technique.
The time series of panel e
were constructed as the sum of: 1) a single common signal of amplitude $1$ and
period $12$ years (a); 2) a
single common signal of amplitude $5$ and period $2$ years (b); and 3)
normally distributed white noise of standard deviation $1.5$,
independently generated for each of the $10$ time series (c). The time series
of panel f were produced via the
relationship $y_n(t) = (x_n(t)+x_n(t-1))/2 + \epsilon_n (t)$ where
the $\epsilon_n (t)$ were independent normal random numbers
of mean $0$ and standard deviation $3$. This transmits the period-$12$
component of the $x$ signals to the $y$ but
not the period-$2$ component because averaging covers a whole
period for that component. Correlations (f,
green numbers) between $x_n(t)$ and $y_n(t)$ did not indicate
any particular relationship. Correlations cannot
detect the relationship between the $x$ and $y$ because the technique confounds
phenomena occurring on different
timescales. Spatial wavelet coherence revealed a highly significant relationship
at periods around $12$ years (g) and on
average over long timescales (left $P$-value on panel g, long timescales
defined as $>4$ years) but no relationship
(right $P$-value) for short timescales ($<4$ years). The red line on g is the
spatial wavelet coherence and black lines are
$50$th, $95$th, and $99$th percentiles of spatial wavelet coherences
of synchrony-preserving surrogate data sets Sheppard \emph{et al.} (2016)
appropriately representing the
null hypothesis of no relationship between the $x$ and $y$.
Also see Sheppard \emph{et al.} (2016) for a description of how the aggregate long- and short-timescale $P$-values were computed. \label{PedagogFigSpatCoh}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/FigS4.png}
\caption{Phase differences between variables as a function of timescale for the main significant relationships of 
Table \ref{TabS1_CountyCoherenceSummary}, county-level data: A) winter MEI ($\text{MEI}_{\text{w}}$) 
and deer abundance, B) summer MEI and 
deer abundance, C) winter PDO ($\text{PDO}_{\text{w}}$) and deer abundance, 
D) snow depth and deer abundance, E) deer abundance and 
deer-vehicle collisions, F) deer abundance and deer-vehicle collisions adjusted for traffic volume, and 
G) deer abundance and hunter abundance. $\bar{\theta}$ indicates the mean phase (in units of $\pi$
radians) for the shaded timescale bands. Horizontal axes differ in extent among panels due to different
time ranges of available data for different variables. \label{FigS4_PhaseDiffs}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/FigS6.png}
\caption{Rank, by timescale, of spatial wavelet coherence values in surrogate spatial wavelet coherence distributions (\emph{Methods}) for the main significant relationships of Table \ref{TabS1_CountyCoherenceSummary}, using county-level data. The red horizontal dashed line corresponds to a nominal confidence level of $95\%$. In A), results are comparisons of the listed variables with deer abundance. In B), `Abun-DVCs' is a comparison of deer abundance and DVCs, `Abun-Adj. DVCs' is a comparison of deer abundance and DVCs adjusted for traffic volume, and `Hunters-Abun' is a comparison of hunter numbers and deer abundance. The red horizontal line would be analogous to a $P$-value of $0.05$ for an individual timescale (\emph{Methods}).\label{FigS6_RanksInSurrogs}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[width=.4\textwidth]{Results/FigS7.png}
\caption{Wavelet mean field (A) and wavelet phasor mean field (B) magnitudes of county-level hunter abundance 
time series, and predicted synchrony of deer abundance based on a wavelet model with sole predictor hunter 
abundance (C). Higher values in A, B indicate greater synchrony (A) or phase synchrony (B) of hunter abundance 
time series at the indicated times and timescales. Contours on (B) indicate statistical significance of phase 
synchrony at $P = 0.001$. Colors in (C) show predicted synchrony in deer abundance, while contours show the 
actual wavelet mean field magnitude of deer abundance, similar to the contours shown in Fig. \ref{MT-Fig2_DeerSync}C. Slight differences exist here vs Fig. \ref{MT-Fig2_DeerSync}C because of different spatiotemporal extents of the data used in hunter analyses. Agreement is poor between colors and contours 
on panel C, giving a 
visual indication of the statistical result that hunter abundance does not explain deer abundance or synchrony 
well on $3-7$-year timescales.\label{FigS7_WMFHunter}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[height=.8\textheight]{Results/FigS8.png}
\caption{Wavelet mean field (A, B) and phasor mean field (C, D) magnitudes, and predicted synchrony (E, F) for deer abundance (A, C, E) and DVCs (B, D, F) using USDA-district data. Higher values in A-D indicate greater synchrony (A, B) or phase synchrony (C, D) at the indicated times and timescales. Contours on (C, D) indicate statistical significance of phase synchrony at $P = 0.001$. Colors in (E) show synchrony in deer abundance predicted from a wavelet model using snow depth, $\text{MEI}_{\text{w}}$, and $\text{PDO}_{\text{w}}$ as predictors, while contours show the actual wavelet mean field magnitude of deer abundance from (A), for comparison. Agreement is good, giving a visual indication of the statistical result that climatic Moran effects explain deer synchrony. Colors in (F) show synchrony in DVCs predicted by a wavelet model with sole predictor deer abundance, while contours are from (B) and again show good agreement. Vertical axes differ between left and right panels because time series were shorter for DVCs. \label{FigS8_WMFAndPredictionsDistricts}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[height=.9\textheight]{Results/FigS9.png}
\caption{Wavelet mean fields (left column) and wavelet phasor mean fields (right column) of winter Tmin (A, B), Tmax (C, D), snow depth (E, F) and precipitation (G, H) using county-level data. Colors and contours as in Fig \ref{MT-Fig2_DeerSync}A,B. \label{FigS9_WMFsAndWPMFsAncillary}}
\end{figure}

\newpage
\clearpage

# Supplementary tables

```{r TableS1,echo=F,results='markup'}
options(knitr.kable.NA = '') #makes it put blanks instead of "NA" for NAs
rownames(TableS1)<-NULL
knitr::kable(TableS1,
             format='pandoc',
             digits=4,
             col.names=c("Predictor","Response","Timescale", "P-value","Mean phase ($\\bar{\\theta}$)","Synchrony explained","Average cross terms"),
             caption = "Summary of spatial wavelet coherence tests and related results using county-level data. $P$-values and mean phases are from tests of spatial wavelet coherence (*Methods*) of the variables in columns 1 and 2 over the indicated timescale band. Mean phases over the timescale band (units of $\\pi$ radians) are provided only when meaningful, i.e., when spatial wavelet coherence was significant, $P < 0.05$, or marginally significant. A positive mean phase indicates the variable in the column *Response* is leading, and a negative mean phase indicates the variable in the column *Predictor* is leading. The *Synchrony explained* and *Average cross terms*  columns, which give percentages, are based on wavelet linear regressions (*Methods*) of the *Response* transforms against the *Predictor* transforms. When cross terms are low, synchrony explained is interpretable as the approximate percentage of synchrony in the response explainable as due to the synchrony in the predictor. They were low enough except for tests involving DVCs, for which USDA district-level results were more reliable (main text and Table \\ref{TabS4_SummaryDistrict}). Cross-terms are zero for test involving climate indices because for those tests the same values were used for all locations (*Methods*). All values were rounded to display four digits. \\label{TabS1_CountyCoherenceSummary}",
             booktabs=T)
```

\newpage

```{r TableS2,echo=F,results='markup'}
rownames(TableS2)<-NULL
knitr::kable(TableS2,
             col.names=c("Predictor","Response","Timecale","P-value","Mean phase ($\\bar{\\theta}$)"),
             format='pandoc',
             digits=4,
             caption = "$P$-values of wavelet coherence tests, and associated mean phase differences for significant and marginally significant tests, between climate indices. Values are over $3-7$ year timescales. All values were rounded to display four digits. \\label{TabS2_PairwiseClimVarSpatCoh}",
             booktabs=T)
```

<!--\newpage

```{r TableS3,echo=F,results='markup'}
rownames(TableS3)<-NULL
knitr::kable(TableS3,
             format='pandoc',
             digits=4,
             col.names=c("Predictor","Response","Timecale","P-value","Mean phase ($\\bar{\\theta}$)"),
             caption = "$P$-values of spatial wavelet coherence tests, and associated mean phase differences  for significant and marginally significant tests, between climate indices and average winter weather conditions using county-level data over $3-7$ year timescales. All values were rounded to display four digits. \\label{TabS3_SpatCohPWWAndClimInds}",
             booktabs=T)
```
-->

\newpage

```{r TableS4,echo=F,results='markup'}
rownames(TableS4)<-NULL
knitr::kable(TableS4,
             format='pandoc',
             digits=4,
             col.names=c("Predictor","Response","Timescale", "P-value","Mean phase ($\\bar{\\theta}$)","Synchrony explained","Average cross terms"),
             caption = "Summary of spatial wavelet coherence tests and related results using USDA district-level data (*Methods*). $P$-values and mean phases are from tests of spatial wavelet coherence (*Methods*) of the variables in columns 1 and 2 over the indicated timescale band. Mean phases over the timescale band (units of $\\pi$ radians) are provided only when meaningful, i.e., when spatial wavelet coherence was significant, $P < 0.05$, or marginally significant. A positive mean phase indicates the variable in the column *Response* is leading, and a negative mean phase indicates the variable in the column *Predictor* is leading. The *Synchrony explained* and *Average cross terms*  columns (which give percentages) are based on wavelet linear regressions (*Methods*) of the *Response* transforms against the *Predictor* transforms. When cross terms are low, synchrony explained is interpretable as the approximate percentage of synchrony in the response explainable as due to the synchrony in the predictor. They were low enough for all results in this table. Cross-terms are zero for test involving climate indices because for those tests the same values were used for all locations (*Methods*). All values were rounded to display four digits. \\label{TabS4_SummaryDistrict}",
             booktabs=T)
```

\newpage

```{r TableS5,echo=F,results='markup'}
rownames(TableS5)<-NULL
knitr::kable(TableS5,
             format='pandoc',
             digits=4,
             caption = "$P$-values of spatial wavelet coherence tests, and associated mean phase differences for significant and marginally significant tests, between climate indices and average winter weather conditions using USDA district-level data over 3-7 year timescales. All values were rounded to display four digits. \\label{TabS5_SpatCohPWWAndClimInds_District}",
             booktabs=T)
```
