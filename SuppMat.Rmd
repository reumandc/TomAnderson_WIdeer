---
title: "Synchronous effects produce major cycles in deer populations and deer-vehicle collisions: Supporting information"
author: "Anderson, Sheppard, Walter, Rolley, Reuman"
output:
  pdf_document:
    number_sections: yes
    fig_caption: yes
    keep_tex: yes
    includes:
      in_header: head_supp.sty
  html_document:
    df_print: paged
  word_document: default
geometry: left=1cm,right=1cm,top=2.5cm,bottom=2.8cm
link-citations: yes
csl: ecologyletters.csl
tables: yes
bibliography: AndersDeerShortRefs.bib
urlcolor: blue
nocite: |
  @Sheppard2016_aphids, @Sheppard_wavmodel
---

\tableofcontents
\listoffigures
\listoftables

<!--Libraries-->
```{r libraries, echo=F, message=FALSE}
library(reshape2,quietly=T)
library(tools,quietly=T)
library(fields,quietly=T)
library(mvtnorm)
library(rmarkdown)
library(shape)
library(tinytex)
library(devtools,quietly=T)
library(withr,quietly=T)
```

<!--Flags controlling the run and other setup-->
```{r setup, echo=F}
#which density to use ("dnr" for original estimates, "tom" for your own calculations)
dens.flag<-"dnr"

#what is the earliest year you want? (abundance: 1981; DVC: 1987; Traffic: 1988, Hunters: 1992)
minyear<-1981

#what is the last year you want? (max is 2016)
maxyear<-2016

#set number of surrogates to use for spatial wavelet coherence
nsurrogs<-100000

#a function needed for caching
source("Code/mtime.R") 
```

<!--Generate the data-->
```{r data_generation, echo=F, cache=TRUE, results="hide", fig.show="hide", cache.extra=list(dens.flag,minyear,maxyear,mtime("Code/Deer_DataGeneration.R"),mtime("Data/WI_Cty_CentroidDD.csv"),mtime("Data/DOT_Accidents1987_2016.csv"),mtime("Data/Adj_DOT_Accidents1987_2016.csv"),mtime("Data/WI_USDA_Sections.csv"),mtime("Data/USDA_centroids.csv"),mtime("Data/Cty_Traffic.csv"),mtime("Data/DMU_DeerAbundance1981_2013.csv"),mtime("Data/DMU_DeerDensity1981_2013.csv"),mtime("Data/DMU_HunterAbundance1975_2013.csv"),mtime("Data/DMU_HunterDensity1975_2013.csv"),mtime("Data/hunterdens1416.csv"),mtime("Data/hunterabun1416.csv"),mtime("Data/Cty_Abun_2014_2016.csv"),mtime("Data/permit_issued1970_2013.csv"),mtime("Code/Climate_DataGeneration.R"),mtime("Data/noaa_latlongUpd.csv"),mtime("Data/WI_USDA_Sections.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set1.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set2.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set3.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set4.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set5.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set6.csv"),mtime("Data/Cty_NOAA_Temp2016_2017.csv"),mtime("Data/Cty_NOAA_Precip1981_1985.csv"),mtime("Data/Cty_NOAA_Precip1986_1991.csv"),mtime("Data/Cty_NOAA_Precip1992_1997.csv"),mtime("Data/Cty_NOAA_Precip1998_2003.csv"),mtime("Data/Cty_NOAA_Precip2004_2009.csv"),mtime("Data/Cty_NOAA_Precip2010_2015.csv"),mtime("Data/Cty_NOAA_Precip2016_2017.csv"),mtime("Data/climate_indices.csv"),mtime("Data/mei.csv"),mtime("Data/pdo.csv"))}

#Dependencies (listed in cache.extra above):
#1) Settings variables from the setup chunk
#2) all the data csvs (see Data folder)
#3) all the scripts sourced below (see Code folder)
#4) all the functions called (see Functions folder)

#Clean population data: end result are two lists of matrices called "cty.list" and "usda.list". Cty stands for county. All elements of cty.list are matrices, counties (rows) by year (columns). Elements are named Abun (abundance), Crashes (DVCs), Traffic (traffic), and AdjDVC (Traffic-adjusted DVCs). USDA stands for USDA districts, and all elements in "usda.list" are matrices, districts (rows) by year (columns) and named similarly to cty.list. In both lists, the data sets were complete in spatial dimension but varied in temporal dimension: deer span the years 1981-2016, Crashes 1987-2016 and Traffice/AdjDVCs 1988-2016. Missing years are filled with NAs. Both objects are saved as .rds files in the Results folder. These data sets are also used to generate state-level (single time series) data for deer abundance, DVCs, and hunter numbers. 

#***QC_Tests/tests_datagen_deer.R and QC_Tests/tests_datagen_climate.R are testing scripts to verify different data aggregatoin steps provide identical lists of raw data
source("Code/Deer_DataGeneration.R")

#Clean winter weather and climate data: end results are four lists of matrices called "winter.clim", climindex, winter.clim.usda, and climindex.usda. "winter.clim"" includes matrices, counties (rows) by year (columns) that are the averages of NOAA weather station data from Dec[t-1] to Mar[t], with named elements of Tmin (minimum temperature), Tmax (maximum temperature), Prcp (precipitation), and Snwd(snow depth). Not all counties had weather data in all years and are filled with NAs where missing. "winter.clim.usda"" are matrices, districts (rows) by year (columns) and includes the same variables and variable names as "winter.clim"" but averaged over USDA districts (~ 7 counties per district) and are complete in both dimensions. All objects are saved as .rds files in the Results folder."climindex" and "climindex.usda" are matrices of climate indices averaged over winter (Dec[t-1]-Mar[t]) and summer (Apr[t]-Nov[t]). Values in each matrices are repeated across rows because the climate indices are not a spatial variable. The dimensions of each match the spatial dimensions of other county (climindex) or district (climindex.usda) data sets. These data sets are also used to generate state-level (single time series) data for snow depth and climate indices. 
source("Code/Climate_DataGeneration.R")

```

```{r analysis, echo=F, cache=TRUE, results="hide", fig.show="hide", cache.extra=list(cty.list,usda.list,winter.clim,climindex,winter.clim.usda,climindex.usda,nsurrogs,mtime("Data/abunsurrsum.csv"),mtime("Data/dvcsurrsum.csv"),mtime("Code/DeerCoherence_wsyn.R"))}

#Run spatial coherence analysis on deer abundance and DVCs using county and district data. Tests include the effects of climate indices on deer abundance, winter weather on deer abundance, climate indices on winter weather, deer abundance on DVCs, deer abundance on traffic-adjusted DVCs. Also, run wavelet coherence on state level data between the same sets of variables. 
set.seed(101)
source("Code/DeerCoherence_wsyn.R")
```

<!---generate plots--->
```{r plots, echo=F, cache=T, results="hide", fig.show="hide", cache.extra=list(cty.list,usda.list,winter.clim,climindex,winter.clim.usda,climindex.usda,wlm_abun,wlm_dvc,mtime("Code/deer_plots.R"),mtime("Functions/Fn_wmfwt.R"),mtime("Functions/Fn_rankplot.R"),mtime("Code/PedagogFig.R"),mtime("Code/TheoryExample1.R"),mtime("Code/TheoryExample2.R"),mtime("Code/TheoryExample3.R"),mtime("Functions/deer_plotting_functions.R"))}
#generate plots 
set.seed(201)
source("Code/deer_plots.R")
```

```{r echo=F, results="hide"}

#need to run so that objects that are large numbers can be evaluated with inline code
options(scipen = 999999)

#load in results
options(scipen=6)
#Load tables of results
TabS2_results<-readRDS(file = "Results/TableS2.rds")
Tab1_results<-readRDS(file = "Results/Table1.rds")

usda_abunsnwd_syncexp34<-TabS2_results$SynchronyExplained[TabS2_results$Predictor=="Snow Depth" & TabS2_results$Response=="Abundance" & TabS2_results$Timescale=="3-4"]
usda_dvcabunSyncExp<-TabS2_results$SynchronyExplained[TabS2_results$Response=="DVCs" &
                                                        TabS2_results$Predictor=="Abundance"]
usda_adjdvcabunSyncExp<-TabS2_results$SynchronyExplained[TabS2_results$Response=="Traffic-adj. DVCs" &
                                                        TabS2_results$Predictor=="Abundance"]
snowabunSyncExp34<-Tab1_results$SynchronyExplained[Tab1_results$Predictor=="Snow Depth" & Tab1_results$Timescale=="3-4"]
avgdeerfluc<-readRDS(file="Results/totaldeerfluctuations.rds")
avgdvcfluc<-readRDS(file="Results/totaldvcfluctuations.rds")
avgdvccostsLow<-readRDS(file="Results/totaldvccostsLow.rds")
avgdvccostsHigh<-readRDS(file="Results/totaldvccostsHigh.rds")

abunmodelSyncExp<-readRDS(file="Results/abunmodelSyncExp.rds")
abunmodelXterms<-readRDS(file="Results/abunmodelXterms.rds")
usda.abunmodelSyncExp<-readRDS(file="Results/usda.abunmodelSyncExp.rds")
usda.abunmodelXterms<-readRDS(file="Results/usda.abunmodelXterms.rds")
gunhunter_percent<-round(100*mean(state.totals$GunHunters[state.totals$Year>1980]/(state.totals$GunHunters[state.totals$Year>1980]+state.totals$BowHunters[state.totals$Year>1980])),0)

usda.snowabunSyncExp3_4<-TabS2_results$SynchronyExplained[TabS2_results$Response=="Abundance" &  TabS2_results$Predictor=="Snow Depth" & TabS2_results$Timescale=="3-4"]
abunwmeiSyncExp47<-round(Tab1_results$SynchronyExplained[Tab1_results$Predictor=="Winter MEI"&Tab1_results$Timescale=="4-7"],2)
abunwpdoSyncExp47<-Tab1_results$SynchronyExplained[Tab1_results$Predictor=="Winter PDO" &  Tab1_results$Timescale=="4-7"]
```

<!--Save workspace. This is here because the Methods used to be in the sup mat,
occurred immediately below this chunk, and used all sorts of variables that were 
created above. Some were saved as rds files, some not. Rather than make sure all 
variables that are used in the Methods are saved as rds files and then loaded
before the new location of Methods in the main text, just save the whole workspace
here and then load it there.-->
```{r echo=F, results="hide"}
save.image(file="WholeWorkspace.RData")
```

<!--The new Fourier analyses developed in response to Ecology Letters reviewer, 2020 03-->
```{r echo=FALSE, results="hide", cache=TRUE, fig.show="hide", cache.extra=list(mtime("Data/abunsurrsum.csv"),mtime("dvcsurrsum.csv"))}
source("Code/FourierAnalyses.R")
```

# Theory \label{SI:theory}

\textbf{Model and main theorem.} We start by specifying the general model we consider. 
The model is similar to those used in the supplementary information of 
@Desharnais2018, but in
contrast to their models, our model
considers more than two habitat patches and does not consider dispersal.
Due to the similarity in models, some of our below sentences describing our model 
are copied 
with very little or no change in wording
from that reference.
Suppose population dynamics are given by
\begin{equation}
w_{i} = c_1 w_i(t-1)+ \cdots + c_n w_i(t-n)+q_0 \epsilon_{i}(t)+\cdots+q_{m}\epsilon_{i}(t-m),\label{eq:mainmodel}
\end{equation}
\noindent where $w_{i}(t)$ is the deviation of a population index $x_{i}(t)$ in
habitat patch $i$ ($i=1,\ldots,N$) at time $t$ from an equilibrium value $x_{i}^{*}$. 
The environmental noise process $\epsilon=(\epsilon_{1},\ldots,\epsilon_{N})$
is assumed to be a second-order stationary stochastic process with $\E(\epsilon_{i})=0$
for all $i$. Without loss of generality, $c_n \neq 0$ and $q_m \neq 0$. We also assume
the complex roots of the polynomial $1-c_1 z - c_2 - \cdots - c_n z^n=0$
have modulus greater than one. This assumption is a necessary and sufficient condition 
for stability of the equilibrium of the general model of which (\ref{eq:mainmodel})
is a linearization (@Desharnais2018, their supplementary information section 1.2) 
and also for the existence of a stationary
stochastic process that is a solution of (\ref{eq:mainmodel}) 
[@Desharnais2018; @Brillinger2001]. 
We denote by $x_{\text{tot}}(t)$ the total population $\sum_{i=1}^N x_i(t)$,
which has the same characteristics of variability through time 
as $w_{\text{tot}}(t)=\sum_{i=1}^N w_i(t)$.

To develop our theory, we need the language and fundamental mathematical results of
stochastic processes and their spectra and cross spectra. 
Spectral statistics are extremely well-developed, widely known, and widely applied in numerous fields;
background on spectral statistics can be found from many sources [@Reinsel1997; @Shumway2000;@Brillinger2001]. We here define notation. 
Let $S_{\epsilon_{i}\epsilon_{i}}(f)$
denote the power spectrum of the process $\epsilon_{i}$ and let $S_{\epsilon_{i}\epsilon_{j}}(f)$
denote the cross spectrum of the processes $\epsilon_{i}$ and $\epsilon_{j}$.
Here $f$ is the frequency of a periodic oscillation, the reciprocal of its period 
(i.e., its timescale). Throughout, we use, for units of $f$, cycles per time interval between 
population sampling events, and we consider $f$ between $0$ and $0.5$ (the Nyquist frequency). 
This is the range of frequencies
about which sampled data provide any information. 
The cospectrum, denoted $C_{\epsilon_{i}\epsilon_{j}}(f)$, is $\Rp(S_{\epsilon_{i}\epsilon_{j}}(f))$, 
the real part. Analogously, let $S_{w_i w_i}(f)$,
$S_{w_i w_j}(f)$ and $C_{w_i w_j}(f)=\Rp(S_{w_i w_j}(f))$ be the spectrum, cross spectrum
and cospectrum of the population processes $w_i$ and $w_j$.
Given a multivariate process such as $\epsilon=(\epsilon_1,\ldots,\epsilon_N)$ or
$w=(w_1,\ldots,w_N)$, the spectral matrix of the process is denoted
$S_{\epsilon \epsilon}(f)$ or $S_{ww}(f)$. The spectral matrix, an $N \times N$ matrix-valued function
of frequency, has the spectra
$S_{\epsilon_i \epsilon_i}(f)$ on the diagonal and the cross spectra $S_{\epsilon_i \epsilon_j}(f)$ 
in the off-diagonal. The special notation $S_{\text{tot}}(f)$ is used for 
the spectrum of $w_{\text{tot}}$ (which is the same as the spectrum of $x_{\text{tot}}$).

The main theoretical result is as follows.
\begin{thm}
Let $\mu=\exp(-2\pi i f)$, and define $\gamma=q_{ 0}+q_{ 1}\mu+\cdots+q_{m}\mu^{m}$ and
$\lambda=c_{ 1 }\mu+c_{ 2}\mu^{2}+\cdots+c_{n}\mu^{n}$ in terms of $\mu$ and the 
coefficients of the population model. Then
$S_{\text{\emph{tot}}} = \left| \frac{\gamma}{1-\lambda} \right|^{ 2} \left[ \sum_i S_{\epsilon_{i}\epsilon_{i}} +\sum_{i \neq j} C_{\epsilon_{i}\epsilon_{j}}\right]$.
\label{prop:mainthm}
\end{thm}
\noindent The proof is in section \ref{sect:mainproof}.
Thus the power spectrum of the total population, which tells us whether and how the 
total population time series cycles, is influenced by three terms.
First, $\left| \frac{\gamma}{1-\lambda} \right|^{ 2}$, which reflects the nature of
dynamics intrinsic to the population ($\gamma$ and $\lambda$ are determined by
the model coefficients $c_1,\ldots,c_n$ and $q_0,\ldots,q_m$). This is the quantity 
denoted $F_{\text{popdyn}}(f)$ in the main text. Second,
$\sum_i S_{\epsilon_{i}\epsilon_{i}}$, the  sum of the power
spectra of the environmental noise time series, which reflects the extent to which the noise
itself may be periodic. And third, $\sum_{i \neq j} C_{\epsilon_{i}\epsilon_{j}}$,
the sum of the cospectra of the noise, which reflects the extent to which noise
synchrony across locations may be specific to certain timescales.

Crucially, the first sum, $\sum_i S_{\epsilon_{i}\epsilon_{i}}$, 
is of $N$ quantities and the
second sum, $\sum_{i \neq j} C_{\epsilon_{i}\epsilon_{j}}$, is of $N^2 - N$ quantities. 
This suggests that, when $N$ is large enough, timescale specificity of
synchrony of noise across locations ($N^2-N$ terms) will tend to be more important 
for $S_{\text{tot}}$ than the nature of the periodicity of the noise ($N$ terms).
Of course, whether this intuition is actually true depends on the specific values of 
the terms in each sum. But if N is, say, $71$ (there are $71$ counties in Wisconsin
for which deer data were available), then $4970=N^2-N \gg N=71$, so $N^2-N$ is larger
than $N$ by around 2 orders of magnitude. Thus the term
$\sum_{i \neq j} C_{\epsilon_{i}\epsilon_{j}}$ will make a much bigger contribution
to $S_{\text{tot}}$ than will the term $\sum_i S_{\epsilon_{i}\epsilon_{i}}$ unless
cospectra are correspondingly smaller than spectra, on average, by around 2 orders
of magnitude. The following three examples make clear the overwhelming importance 
of synchrony for cycling of the spatial-total population.

\textbf{Example 1.} For example 1, we constrasted a case for which
environmental noise was asynchronous with a case for which environmental noise
had timescale-specific synchrony to show that, in the latter case, cycling
of the regional-total population was much more noticable. The nature
of population dynamics and the local statistical characteristics of environmental 
noise were kept fixed across the two cases.

For example 1, we considered $N=70$ sampling locations (likewise
for subsequent examples).
The environmental noise processes, $\epsilon_i(t)$ were constructed so that the power spectrum
of noise at each location was 
$S_{\epsilon_i \epsilon_i} = \left| \frac{1}{1-c_1 \mu -c_2 \mu^2} \right|^2$ and
the cross spectrum between any two locations was 
$S_{\epsilon_i \epsilon_j}=\rho \left| \frac{1}{1-c_1 \mu -c_2 \mu^2} \right|^2$, for $c_1=0$ and $c_2=-1/9$.
The function of frequency $\left| \frac{1}{1-c_1 \mu -c_2 \mu^2} \right|^2$
has a single peak at a frequency of $0.25$ cycles per sampling interval (corresponding to
a period of 4 sampling intervals) for the values of $c_1$ and $c_2$ used, 
so the spectra $S_{\epsilon_i \epsilon_i}$
indicate environmental noise that tends to oscillate with a period of $4$ years.
See below for the precise means by which environmental noise was constructed.

We considered two cases within theoretical example 1. For case 1, we used
$\rho=0.8$ and for case 2 we used $\rho=0$. Thus for case 1, noise was 
synchronous between locations (cospectra between locations were not zero), 
and this synchrony was dominated by a timescale of 4 years (cospectra
had a peak at a frequency corresponding to that period). For case 2,
noise time series in different sampling locations were unrelated (cospectra
were 0), though spectra were the same as case 1. Analytically calculated 
noise spectra and estimates based on simulations are in Fig. 
\ref{TheoryExample1}A-B; likewise, for cospectra, see Fig. \ref{TheoryExample1}C-D.

For cases 1 and 2 of example 1 and for all cases of all
subsequent theoretical examples, population dynamics were governed
in all sampling locations by an AR(1) process, i.e., $n=1$ and $m=0$ in 
equation (\ref{eq:mainmodel}). In all examples and cases we used $c_1=0.15$.
An AR(1) population model ensures that populations are not intrinsically 
cyclic in any sense, so any periodicity that arises comes ultimately
from the environmental noise and its synchrony.

Applying the theorem, 
\begin{equation}
S_{\text{tot}} = \left| \frac{1}{1-\rho_p \mu} \right|^2
\left|\frac{1}{1-c_1 \mu - c_2 \mu^2} \right|^2
\left[N + (N^2-N)\rho \right].
\end{equation}
\noindent The first factor here, $\left| \frac{1}{1-\rho_p \mu} \right|^2$,
captures the influence of population dynamics on $S_{\text{tot}}$.
The second term is the factor common to the sums $\sum_i S_{\epsilon_{i}\epsilon_{i}}$
and $\sum_{i \neq j} C_{\epsilon_{i}\epsilon_{j}}$ in the expression of 
theorem \ref{prop:mainthm}. The third term shows the relative contributions
of periodicity in noise time series ($N$) and 
synchrony between noise time series in different locations 
($(N^2-N)\rho$). Unless $\rho$ is very small, the contribution of
synchrony will be much larger. In case 1, for which we used 
$\rho=0.8$, the contribution of synchrony to $S_{\text{tot}}$
dwarfs the contribution due directly to periodicity of the noise
($N=70$ and $(N^2-N)\rho=3864$).
In case 2, for which we used $\rho=0$, there is no synchrony, and as
a result the total power of $w_{\text{tot}}$ (equal to the integral under
$S_{\text{tot}}$) is very small. $S_{\text{tot}}$ is plotted for
cases 1 and 2, respectively, in Fig. \ref{TheoryExample1}E-F. The much greater
power and periodicity in $w_{\text{tot}}$ can be seen in example time 
series, as well (Fig. \ref{TheoryExample1}G-H).

Noise for example 1 was generated via an AR(2) process. Let 
$\delta(t) = (\delta_1(t),\ldots,\delta_N(t))$ be drawn, independently for 
each time, $t$, from a multivariate normal distribution with mean $(0,\ldots,0)$
and covariance matrix consisting of entries $\rho$ in the off diagonal and $1$
in the diagonal. Let $\epsilon_i(t)=c_1 \epsilon_i(t-1) + c_2 \epsilon_i(t-2)+\delta_i(t)$.
Theorem \ref{thm:lem} in SI section \ref{sect:mainproof} provides the spectra
and cross spectra of the noise process $\epsilon$ which are stated above.

\textbf{Example 2.} For example 2, we contrasted a case in which
the synchrony of environmental noise was not timescale specific, with a case
for which it was, to show that timescale specificity of environmental synchrony
is what produces cycling in the regional-total population. The nature
of population dynamics and the local statistical characteristics of environmental 
noise were again kept fixed across the two cases, as was the total (across
all timescales) synchrony of environmental noise.

For example 2, the environmental noise processes 
$\epsilon_i(t)$ were constructed so that the power spectrum
of noise at each location was 
$S_{\epsilon_i \epsilon_i} = \left| \frac{1}{1-c_1 \mu -c_2 \mu^2} \right|^2+1$ and
the cross spectrum between any two locations was 
$S_{\epsilon_i \epsilon_j}=\rho_1 \left| \frac{1}{1-c_1 \mu -c_2 \mu^2} \right|^2+\rho_2$ 
for $c_1=0$ and $c_2=-4/9$. For these values of $c_1$ and $c_2$, 
the function of frequency $\left| \frac{1}{1-c_1 \mu -c_2 \mu^2} \right|^2$
again has a single peak at frenqency $0.25$ cycles per sampling interval
(corresponding to an oscillatory period of 4 sampling intervals). 
See below for the precise means by which environmental noise was constructed.

We again considered two cases. For case 1, $\rho_1=0$ and $\rho_2=0.8$,
so cospectra were flat and synchrony was nonzero but was also not 
timescale-specific. For case 2, $\rho_2$ was set to $0$ and $\rho_1$ was chosen 
so that covariances between locations were the same, in expectation, as 
they were in case 1. Because the expected covariance between environmental 
noise time series at locations $i$ and $j$ can be obtained from the 
cospectrum $C_{\epsilon_{i}\epsilon_{j}}=S_{\epsilon_{i}\epsilon_{j}}$ via integration, 
$\int_{-1/2}^{1/2} S_{\epsilon_{i}\epsilon_{j}}(f) df$, this was accomplished 
by choosing $\rho_1$ so that 
$\int_{-1/2}^{1/2} \rho_1 \left| \frac{1}{1-c_1 \mu -c_2 \mu^2} \right|^2 df
= \int_{-1/2}^{1/2} 0.8 df = 0.8$. Thus, for case 2,
$\rho_1 = \frac{0.8}{\int_{-1/2}^{1/2} \left| \frac{1}{1-c_1 \mu -c_2 \mu^2} \right|^2 df}$. 
This was calculated numerically, and equals approximately $0.64$.
Thus environmental synchrony has the same overall strength (location-to-location covariances
were the same) in the two cases, but synchrony was specific to timescales around 4 sampling
intervals for case 2 and was equal across all timescales for case 1.
Analytically calculated 
noise spectra and estimates based on simulations are in Fig. 
\ref{TheoryExample2}A-B; likewise, for cospectra, see Fig. \ref{TheoryExample2}C-D.

Applying the theorem, 
\begin{equation}
S_{\text{tot}} = \left| \frac{1}{1-\rho_p \mu} \right|^2
\left[(N^2-N)\left( \rho_1 \left| \frac{1}{1-c_1 \mu -c_2 \mu^2} \right|^2+\rho_2 \right)+N\left( \left| \frac{1}{1-c_1 \mu -c_2 \mu^2} \right|^2+1 \right)\right].\label{eq:stotexamp2}
\end{equation}
\noindent In case 1, this is
\begin{equation}
S_{\text{tot}} = \left| \frac{1}{1-\rho_p \mu} \right|^2
\left[(N^2-N)\rho_2+N\left( \left| \frac{1}{1-c_1 \mu -c_2 \mu^2} \right|^2+1 \right)\right].
\end{equation}
\noindent Because $N^2-N \gg N$, the dominant term inside the hard brackets is the first term,
which is not peaked as a function of frequency. So $S_{\text{tot}}$ will not be peaked, i.e., in case 1
the total population is non-periodic. Recall that case 1 is the case 
in which synchrony was not timescale specific. In case 2, equation (\ref{eq:stotexamp2})
becomes 
\begin{equation}
S_{\text{tot}} = \left| \frac{1}{1-\rho_p \mu} \right|^2
\left[(N^2-N)\left( \rho_1 \left| \frac{1}{1-c_1 \mu -c_2 \mu^2} \right|^2 \right)+N\left( \left| \frac{1}{1-c_1 \mu -c_2 \mu^2} \right|^2+1 \right)\right].
\end{equation}
\noindent The dominant term inside the hard brackets is now peaked as a function of 
frequency, so $S_{\text{tot}}$ will 
be peaked, i.e., the total population is periodic. Recall that case 2
is the case in which synchrony was timescale specific. 
So it is the peakedness (or not) of synchrony that influences whether 
$S_{\text{tot}}$ is peaked (or not) and therefore whether the total population shows 
cyclic tendencies.
$S_{\text{tot}}$ is plotted for
cases 1 and 2, respectively, in Fig. \ref{TheoryExample2}E-F. The greater
periodicity is also apparent from example $w_{\text{tot}}$ time series
(Fig. \ref{TheoryExample2}G-H).

Noise for example 2 was the sum of two processes. The first process was an 
AR(2) process. Let $\delta^{(1)}(t) = (\delta^{(1)}_1(t),\ldots,\delta^{(1)}_N(t))$ be drawn, independently for each time, $t$, from a multivariate normal distribution with mean $(0,\ldots,0)$
and covariance matrix consisting of entries $\rho_1$ in the off diagonal and $1$
in the diagonal. Let $\epsilon^{(1)}_i(t)=c_1 \epsilon^{(1)}_i(t-1) + c_2 \epsilon^{(1)}_i(t-2)+\delta^{(1)}_i(t)$. The second process was simple white noise.
Let $\epsilon^{(2)}(t) = (\epsilon^{(2)}_1(t),\ldots,\epsilon^{(2)}_N(t))$ be drawn, independently for each time, $t$, from a multivariate normal distribution with mean $(0,\ldots,0)$
and covariance matrix consisting of entries $\rho_2$ in the off diagonal and $1$
in the diagonal. The noise used was $\epsilon(t)=\epsilon^{(1)}(t)+\epsilon^{(2)}(t)$.

\textbf{Example 3.} For example 3, we contrasted a case in 
which the synchrony of environmental noise was specific to one timescale band
with a case in which the synchrony of environmental noise was specific to
another timescale band, to show that the cycling of the regional total
population occurs on the same timescale band as the synchrony. The nature
of population dynamics and the local statistical characteristics of environmental 
noise were again kept fixed across the two cases, as was the total (across
all timescales) synchrony of environmental noise.

For example 3, the environmental noise processes 
$\epsilon_i(t)$ were constructed so that 
the power spectrum
of noise at each location was 
$S_{\epsilon_i \epsilon_i} = \left| \frac{1}{1-c_1^{(1)} \mu -c_2^{(1)} \mu^2} \right|^2+
\left| \frac{1}{1-c_1^{(2)} \mu -c_2^{(2)} \mu^2} \right|^2$ and
the cross spectrum between any two locations was 
$S_{\epsilon_i \epsilon_j}=\rho^{(1)} \left| \frac{1}{1-c_1^{(1)} \mu -c_2^{(1)} \mu^2} \right|^2+
\rho^{(2)}\left| \frac{1}{1-c_1^{(2)} \mu -c_2^{(2)} \mu^2} \right|^2$, for 
$c_1^{(1)}=2/3$, $c_2^{(1)}=-4/9$, $c_1^{(2)}=-2/3$, $c_2^{(2)}=-4/9$.
The function of frequency $\left| \frac{1}{1-c_1^{(1)} \mu -c_2^{(1)} \mu^2} \right|^2$
has a single peak at a frequency of $1/6$ cycles per sampling interval and the 
function $\left| \frac{1}{1-c_1^{(2)} \mu -c_2^{(2)} \mu^2} \right|^2$ has a single
peak at frequency $1/3$ cycles per sampling interval, so noise spectra reveal
that the noise cycles at two periodicities simultaneously. 

We considered two cases within example 3. In case 1, we used
$\rho^{(1)}=0.8$ and $\rho^{(2)}=0$, whereas in case 2 we used 
$\rho^{(1)}=0$ and $\rho^{(2)}=0.8$. Thus, of the two peridocities present
in the environmental noise, only one was synchronous in case 1, and
only the other was synchronous in case 2.
Analytically calculated 
noise spectra and estimates based on simulations are in Fig. 
\ref{TheoryExample3}A-B; likewise, for cospectra, see Fig. \ref{TheoryExample3}C-D.

Applying the theorem, 
\begin{align}
S_{\text{tot}} &= \left| \frac{1}{1-\rho_p \mu} \right|^2
N\left[ \left| \frac{1}{1-c_1^{(1)}\mu-c_2^{(1)}\mu^2} \right|^2 
+ \left| \frac{1}{1-c_1^{(2)}\mu-c_2^{(2)}\mu^2} \right|^2\right] \\
&+ \left| \frac{1}{1-\rho_p \mu} \right|^2
(N^2-N)\left[ \rho^{(1)} \left| \frac{1}{1-c_1^{(1)}\mu-c_2^{(1)}\mu^2} \right|^2+ \rho^{(2)}\left| \frac{1}{1-c_1^{(2)}\mu-c_2^{(2)}\mu^2} \right|^2 \right].
\end{align}
\noindent The first term here is dominated by the second in both cases. The periodicity 
in $w_{\text{tot}}$ represented by the second term depends on the values of $\rho^{(1)}$ and
$\rho^{(2)}$ in a straightforward way. The peak that manifests in
$S_{\text{tot}}$ is the peak of the synchronous one of the two components
of noise; the non-synchronous noise component has very little influence
on $S_{\text{tot}}$. $S_{\text{tot}}$ is plotted for
cases 1 and 2, respectively, in Fig. \ref{TheoryExample3}E-F. The differing
periodicities of the total population in the two cases can also be seen 
in example time series (Fig. \ref{TheoryExample3}G-H). Thus in all cases
we have examined (and quite generally, as long as $N^2-N \gg N$) 
it is the nature of synchrony that determines whether the spatial-total
population is cycling, much more so than whether noise is itself periodic.

Noise for example 3 was again the sum of two processes. 
The first process was an
AR(2) process. Let $\delta^{(1)}(t) = (\delta^{(1)}_1(t),\ldots,\delta^{(1)}_N(t))$ be drawn, independently for each time, $t$, from a multivariate normal distribution with mean $(0,\ldots,0)$
and covariance matrix consisting of entries $\rho^{(1)}$ in the off diagonal and $1$
in the diagonal. Let $\epsilon^{(1)}_i(t)=c_1^{(1)} \epsilon^{(1)}_i(t-1) + c_2^{(1)} \epsilon^{(1)}_i(t-2)+\delta^{(1)}_i(t)$. The second process was
another AR(2) process with different parameters. 
Let $\delta^{(2)}(t) = (\delta^{(2)}_1(t),\ldots,\delta^{(2)}_N(t))$ be drawn, independently for each time, $t$, from a multivariate normal distribution with mean $(0,\ldots,0)$
and covariance matrix consisting of entries $\rho^{(2)}$ in the off diagonal and $1$
in the diagonal. Let $\epsilon^{(2)}_i(t)=c_1^{(2)} \epsilon^{(2)}_i(t-1) + c_2^{(2)} \epsilon^{(2)}_i(t-2)+\delta^{(2)}_i(t)$.
The noise used was $\epsilon(t)=\epsilon^{(1)}(t)+\epsilon^{(2)}(t)$.

# Proof of the main theorem \label{sect:mainproof}

To prove theorem \ref{prop:mainthm}, we first state and prove, and then apply,
a result that follows from basic properties of filters and stochastic processes.

\begin{thm}
Using notation defined previously, $S_{ww}=\left| \frac{\gamma}{1-\lambda} \right|^2
S_{\epsilon \epsilon}$.
\label{thm:lem}
\end{thm}

\noindent \emph{Proof.} The model (\ref{eq:mainmodel}) for $i=1,\ldots,N$ can be rewritten as 
\begin{equation}
\mathcal{C} w = \mathcal{Q} \epsilon \label{eq:linfiltmod}
\end{equation}
\noindent for the linear filters
\begin{align}
\mathcal{C} &= I-c_1 IB - c_2 IB^2 - \cdots - c_n IB^n \\
\mathcal{Q} &= q_0 I + q_1 IB + \cdots + q_m IB^m,
\end{align}
\noindent where $I$ is the $N \times N$ identity matrix. 
Here $B$ is the backshift operator,
$B^{l}\delta(t)=\delta(t-l)$, for a stochastic process $\delta(t)$.
See @Reinsel1997, @Shumway2000, and @Brillinger2001
for background on linear filters. Computing the spectral matrices of both
sides of (\ref{eq:linfiltmod}) gives
\begin{equation}
T(\mathcal{C}) S_{ww} \overline{T(\mathcal{C})} = T(\mathcal{Q}) S_{\epsilon\epsilon}
\overline{T(\mathcal{Q})}
\end{equation}
\noindent where $T(\mathcal{C})$ and $T(\mathcal{Q})$ 
are the transfer function matrices of the linear filters
$\mathcal{C}$ and $\mathcal{Q}$, respectively (see, for instance,
section 1.1.3 of @Reinsel1997). But 
$T(\mathcal{C}) = (1-\lambda)I$ and $T(\mathcal{Q})=\gamma I$
(section 1.1.3 of @Reinsel1997), so
\begin{align}
S_{ww} &= (1-\lambda)^{-1} I \gamma I S_{\epsilon\epsilon} \overline{\gamma} I (1-\overline{\lambda})^{-1}I \\
&= \left| \frac{\gamma}{1-\lambda} \right|^2 S_{\epsilon\epsilon},
\end{align}
\noindent as was to be demonstrated. $\blacksquare$

Now applying this result, we have
\begin{align}
S_{\text{tot}} &= \sum_{i,j} C_{w_i w_j} \\
&= \sum_{i,j} \left| \frac{\gamma}{1-\lambda} \right|^{ 2} C_{\epsilon_{i}\epsilon_{j}} \\
&= \left| \frac{\gamma}{1-\lambda} \right|^{ 2} \left[ \sum_i S_{\epsilon_{i}\epsilon_{i}} +\sum_{i \neq j} C_{\epsilon_{i}\epsilon_{j}}\right],\label{eq:splitup}
\end{align}
\noindent which proves the main theorem. The second equality above follows from
theorem \ref{thm:lem}.

# Supplementary methods \label{SI:methods}

\textbf{Deer, DVC, and hunter data.}
For `r length(unique(dat$COUNTY_NAM))` counties, we calculated deer abundance estimates 
spanning the `r dim(cty.list$Abun)[2]`-yr period `r minyear`-`r maxyear` (main text Fig. 
\ref{MT-Fig2_Timeseries}). These time series were based on 
data from "deer management units," provided by 
the Wisconsin Department of Natural Resources (WIDNR). Deer management units 
(DMUs) are regions which partition the state,
determined by the WIDNR for the purpose of deer population assessment and management
($N=$ 101-139 depending on the year).
From 1981-2013, deer abundance was estimated by the WIDNR for DMUs. For most years and DMUs, 
abundance was estimated using a sex-age-kill (SAK) model, with aerial surveys or 
accounting models used for a smaller number of years and DMUs [@widnr2001]. 
In $2014$, DMU boundaries were changed to match counties ($N=72$). Because of this, and because other spatial variables (e.g., DVCs, climate) were gathered at the county level,
we transformed the 1981-2013 abundance estimates for DMUs 
into county-level estimates. To do so, we first calculated the areas 
of intersection between DMU and county boundaries for each year (as 
DMU boundaries changed frequently), using the 'intersect' function in 
Arc GIS 10.3 (ESRI, Redlands, CA). We then calculated deer abundance 
for each intersection area by multiplying the amount of deer habitat in 
each intersection area by the WIDNR density estimate of deer for the DMU 
that the intersection fell within. Deer habitat was considered to comprise 
areas of permanent cover (e.g., forests) that were $>4$ ha in size, plus agriculture and grass fields within 100 m of permanent cover. DMU deer 
densities were calculated by dividing the DMU abundances originally provided to us
by the amount of deer habitat within the DMU [@widnr2001]. This procedure 
assumes approximately spatially uniform densities of deer within deer 
habitat across each DMU. The abundance for a county was the sum of 
the estimated abundances of the county's intersections with DMUs. 
We dropped one county (Menominee) due to incomplete data for most 
variables, leaving `r length(unique(dat$COUNTY_NAM))` counties for statistical analysis.

We also calculated estimated hunter abundance, also from data from the WINDR, 
for each county for the years 1992-`r maxyear`
(main text Fig. \ref{MT-Fig2_Timeseries}); these data constituted an index of the estimated 
number of hunters during the first two days of the 9-day gun 
hunting season [@widnr2001]. Gun hunters on average represent $`r gunhunter_percent`\%$ of the total hunters in WI
each year over the years of this study. We estimated hunter abundances for counties
using the same method as for deer abundance. We dropped 18 counties due to incomplete
survey efforts of hunters or missing data, leaving 53 counties for analysis that used
the hunter density data. 

We obtained estimates of DVCs for each county, spanning the 
years 1987-`r maxyear`, from the WI Department 
of Transportation (WIDOT; main text Fig. \ref{MT-Fig2_Timeseries}). These data reflect the number of police-investigated DVCs; they are an 
index of DVCs, as opposed to an absolute number of incidents, 
since not all DVCs are reported. In Michigan, nearly half of 
DVCs went unreported to the police or insurance companies 
over a five-year period [@Marcoux2010_dvc]. Additionally, 
DVC information was collected with reporting effort that 
may have varied for different counties 
(Daniel Storm, WIDNR, Personal Communication), and the 
threshold of damage for the police to respond to and report on 
an incident increased statewide in 1996 from US\$500 to US\$1000. 
However, features of the data such as these could only have obscured 
and could not have artefactually generated the strongly 
significant spatial wavelet coherence relationships we report between 
DVCs and deer abundance. Shortcomings of the DVC data added 
noise and likely obscured the relationship 
with deer abundance, so that if better DVC data were available 
this relationship would likely have been even stronger than reported. 
We also obtained traffic volume estimates (millions of miles 
driven) for each county spanning the years 1988-`r maxyear` from the 
WIDOT, to control for traffic in our analysis of DVCs.

\textbf{Climate data notes.}
We obtained daily weather data (snow depth, 
precipitation, and minimum and maximum air temperature - here called Tmin and Tmax) from all available weather stations in each county from the 
National Climatic Data Center ([`https://www.ncdc.noaa.gov/`](https://www.ncdc.noaa.gov/)). We 
averaged daily values across the winter ($\text{Dec}_{t-1}$ 
to $\text{Mar}_t$) and across stations within a county to produce 
annual time series of winter weather by county which were used in 
all subsequent analyses (main text Fig. \ref{MT-Fig2_Timeseries}). The number of weather stations per county and data collected at each station 
varied, resulting in different spatial extents of time series available for for each variable 
in order to retain the full temporal extent: Tmin, $N=$ `r dim(winter.clim$Tmin[!is.na(rowMeans(winter.clim$Tmin)),])[1]`
counties; Tmax, $N=$ `r dim(winter.clim$Tmax[!is.na(rowMeans(winter.clim$Tmax)),])[1]`; precipitation, $N=$ `r dim(winter.clim$Prcp[!is.na(rowMeans(winter.clim$Prcp)),])[1]`; snow depth, $N=$ `r dim(winter.clim$Snwd[!is.na(rowMeans(winter.clim$Snwd)),])[1]`. 
We also calculated a Winter Severity Index (WSI, $N=$ `r dim(winter.clim$WSI[!is.na(rowMeans(winter.clim$WSI)),])[1]`), 
a metric known to impact deer populations [@widnr2001]. WSI is the sum of the total number of days for which snow depth was greater 
than 18 inches or Tmin was less than $0^\circ$F. 

We obtained monthly estimates of three global climate indices: 
the North Atlantic Oscillation (NAO), the multivariate 
El Ni$\~{n}$o Southern Oscillation Index (MEI), and the Pacific 
Decadal Oscillation (PDO). All of these have been shown to 
influence large ungulate population dynamics in the north central 
USA [@Post1998_popgrowth;@Post2004_greenland]. 
We averaged monthly values across the 
approximate growing season (Apr-Nov), and separately across the winter 
($\text{Dec}_{t-1}$ to $\text{Mar}_t$) for each index 
(main text Fig. \ref{MT-Fig2_Timeseries}). We used a total of 11 weather and 
climate variables in subsequent analyses: winter Tmin, Tmax, 
snow depth, and precipitation; winter NAO, MEI, and PDO; 
growing-season NAO, MEI and PDO; and the WSI. 

\textbf{Data pre-processing.} We performed all analyses described below and in the main text 
at three spatial scales: counties (N = 44-`r dim(cty.list$Abun)[1]` depending on 
the variables involved; mean county 
area $\pm$ SD = `r round(mean(gps$Area_km2),0)` $\pm$ `r round(sd(gps$Area_km2),0)` $\text{km}^2$), 
United States Department of Agriculture (USDA) districts ($N = 9$; mean 
district area $\pm$ SD = `r round(mean(usda.centroid$Area_km2),0)` $\pm$ `r round(sd(usda.centroid$Area_km2),0)` $\text{km}^2$), 
and statewide (Fig. \ref{FigS1_map}). Analyses at three spatial scales 
were performed because the SAK model used by the WIDNR to estimate deer 
abundance for each management unit has been criticized as less accurate 
at smaller spatial scales [@Millspaugh2009]. This criticism of the 
SAK model may have been overstated, as more recent analyses 
within the WIDNR suggest that uncertainty in SAK estimates is substantially less 
than the $121\%$ error rates indicataed by @Millspaugh2009. Analyses of WI deer abundance 
data for a subset 
of years produced $95\%$ credible intervals around population estimates that were $\pm20-40\%$. 
In addition, the criticism of the SAK [@Millspaugh2009] was based 
on a model that did not match perfectly with practices of the WIDNR. 
Nevertheless, 
to ensure our results were not biased, we analyzed 
synchrony on multiple spatial scales including two larger scales 
(districts and statewide) for which SAK data have not been criticized. 
USDA district data were produced as the sum or 
average of county-level variables, as districts were always conglomerates 
of counties (Fig. \ref{FigS1_map}). 
Statewide analysis used state total or average time series for each 
variable. In general, results remained unchanged in their main substance using data 
aggregated to larger spatial scales (Table \ref{TabS2_SummaryDistrict}, 
Fig. \ref{FigS7_WMFAndPredictionsDistricts}), suggesting results for counties were not 
meaningfully influenced by possible inaccuracies in SAK abundance estimation 
procedures at the county level. We also emphasize that inaccuracies 
in the estimation of deer abundances may have obscured the patterns of
timescale-specific synchrony and the spatial wavelet coherence and 
wavelet linear model results we 
report, but could not reasonably have artefactually created them.

We performed an optimal Box-Cox transformation on each time series to help ensure Gaussian marginal 
distributions [@Sheppard2016_aphids], which are necessary for the Fourier-surrogate-based spatial 
wavelet coherence and wavelet linear regression testing procedures described below. This process also 
included linear detrending (and subtracting the mean) to remove any long-term trends that might 
otherwise obscure patterns of synchrony [@Buonaccorsi2001]. Time series
variances were also standardized to 1. These steps were done via the `cleandat` function in the 
`wsyn` package for the R programming language [@wsyn].

\textbf{The wavelet mean field and wavelet phasor mean field.} We assessed the strength of synchrony 
and its dependence on time and timescale for 
all spatiotemporal variables using two 
statistical tools: the wavelet mean field and 
the wavelet phasor mean field [@Sheppard2013;@Sheppard2016_aphids]. 
Both techniques take as 
input time series measured at the same times 
in several locations, and return as output 
complex-number-valued functions of time 
and timescale. When the magnitudes of these complex functions are plotted against time 
and timescale, the plots characterize the degree 
of synchrony among the input time series and how 
it may have changed over time or differed by 
timescale (Figs \ref{MT-Fig1_example}, \ref{PedagogFigWMF}). 
The wavelet phasor mean field magnitude 
quantifies the degree to which phases of 
oscillation in the input time series were the 
same across locations, as a function of time 
and timescale. The wavelet mean field 
magnitude incorporates information not only 
on phase synchronization but also on the 
tendency of oscillatory components on any 
given timescale to have magnitudes which are 
correlated through time across the sampling 
locations (i.e., oscillations on a given timescale
tend to all be strong, respectively, weak, at the same times). 
Both the wavelet phasor and wavelet mean fields are based 
on complex Morlet 
wavelet transforms of each input time series. 
Wavelet mean fields were computed using the
function `wmf` and wavelet phasor mean fields were computed 
using the function `wpmf` in the `wsyn` package [@wsyn].

Statistical significance of the wavelet phasor mean 
field, compared to a null hypothesis of no phase 
synchrony, can be assessed for each combination of 
time and timescale. For any given time and 
timescale, significance testing compares the degree 
of phase consistency between sampling locations for 
the empirical time series to a null hypothesis of random 
phases. If empirical phase consistency was greater than 
that of $99.9\%$ of sets of random phases 
($P < 0.001$, one-tailed test, see contours on, e.g., main text 
Figs \ref{MT-Fig3_DeerSync}B and \ref{MT-Fig4_DvcSync}B), synchrony was 
deemed significant and important 
[@Sheppard_wavmodel]. Wavelet mean field and 
wavelet phasor mean field magnitude plots for 
winter weather variables are in 
Fig. \ref{FigS8_WMFsAndWPMFsAncillary}.

All plots based on wavelet transforms are "scalloped", i.e., values corresponding to longer timescales and times closer to the start or end of available data are not plotted. This is because the wavelet transform is based on convolutions of wavelet functions with the timeseries being transformed. Convolutions for which a substantial portion of the wavelet function overhangs the edge of the data are unreliable. "Scalloping" wavelet plots is standard practice.

\textbf{Spatial wavelet coherence and wavelet coherence.} For both county- and district-level data, we 
assessed pairwise relationships between 
spatiotemporal variables using the spatial wavelet coherence 
technique [@Sheppard2013;@Sheppard2016_aphids;@Sheppard2017_surrogates]. Spatial wavelet coherence tests whether two 
spatiotemporal variables exhibit consistent phase 
differences and correlated magnitudes of 
oscillation through time and across space, as a 
function of timescale. Significance is determined 
by comparing spatial wavelet coherence of data with 
spatial wavelet coherences of appropriately randomized, 
surrogate data sets ($N=$ `r nsurrogs` surrogates 
were used for all tests) 
that retain the same 
temporal and spatial autocorrelation properties as 
the original time series but are otherwise 
unrelated to each other [@Theiler1992;@Schreiber2000]. Standard Fourier 
surrogates were used [@Schreiber2000;@Sheppard2013;@Sheppard2016_aphids]. 
We calculated how often observed spatial wavelet coherence 
between pairs of variables was ranked higher than 
coherences of surrogate data sets, aggregating 
across the timescale band of interest using an 
average-rank-based method described in detail 
elsewhere [@Sheppard2016_aphids]. A $p$-value of $0.05$ 
means that the empirical spatial wavelet coherence was higher, in an average 
sense across the timescale band of interest, than the same 
quantity calculated for `r 0.95*nsurrogs` of `r nsurrogs` 
surrogate data sets representing the null hypothesis of no relationship between variables. Ranks of actual spatial wavelet
coherences in surrogate spatial wavelet coherences were 
also plotted as a function of timescale 
(Fig. \ref{FigS5_RanksInSurrogs}). Spatial wavelet coherences were computed 
and results were processed using the `coh`, `bandtest`, `plotrank`, 
`plotphase` and related functions in the `wsyn` package. The fast 
algorithm of  @Sheppard2017_surrogates for assessing the statistical 
significance of spatial wavelet coherence was used.

Correlation-based approaches have been standard practice in synchrony studies [@Buonaccorsi2001], but 
these methods assume in-phase relationships. Correlation-based approaches also conflate timescales, 
and recent results show this can hinder detection of synchronous phenomena by obscuring important 
synchrony on some timescales with asynchronous or noisy dynamics on other timescales 
[@Sheppard2016_aphids]. Moreover, synchrony must be specific to certain timescales to produce cyclic 
dynamics of total populations on those timescales (main text Fig. \ref{MT-Fig1_example}). 
In contrast, spatial wavelet coherence 
allows for any kind of phase relationship and 
provides as part of its output the average phase difference that occurred between two variables. It is also  timescale-specific. Therefore, when two variables had significant 
spatial wavelet coherence over a timescale band, we 
calculated the mean phase difference between the 
variables over the band, $\bar{\theta}$, in units of $\pi$ 
radians, to determine if oscillations had 
approximately in-phase ($|\bar{\theta}|=0$ to 
$0.25$), quarter-cycle ($|\bar{\theta}|=0.25$ to 
$0.75$), or anti-phase ($|\bar{\theta}|=0.75$ to 
$1$) relationships. We used "scalloped" 
wavelet transforms for 
calculating phase differences. Phase difference was not meaningful when spatial
wavelet coherence was not significant and so was not reported.

As with correlations, causal relationships between variables are not directly 
revealed by the spatial wavelet coherence. But biological arguments, combined 
with significant coherence and phase information, 
can strongly support one causal hypothesis over 
others. Climate and weather variables could not reasonably be influenced 
by deer abundance. Therefore, a highly significant 
spatial wavelet coherence between a weather variable and 
deer abundance on a timescale band of interest 
provides strong evidence that either the weather 
variable helped cause deer fluctuations and 
synchrony for those timescales, possibly 
indirectly, or some other weather variable, 
highly spatially 
coherent with the first variable, caused the 
fluctuations and synchrony. The highly significant 
coherence between deer abundances and DVCs we 
present in the main text is likewise probably 
indicative of greater deer abundances resulting in 
more DVCs. DVCs are too uncommon to meaningfully 
influence deer abundance (main text Fig. \ref{MT-Fig2_Timeseries}), 
and the 
in-phase relationship our analyses revealed  between 
deer abundances and DVCs on $3-7$-year timescales 
is more consistent with deer 
dynamics driving DVC dynamics than the reverse. The reverse causation, if it occcurred,
would have produced an anti-phase relationship between these variables, with many DVCs
in a year corresponding to reduced deer abundance that year; such a 
relationship was not observed. 

We used spatial wavelet coherence to test 
five weather variables (average winter Tmin, 
Tmax, snow depth, precipitation, and WSI), six 
climate variables (winter and growing season PDO, 
MEI and NAO) and hunter abundance as potential 
drivers of synchrony in deer abundance over the 
$3-7$-year timescale band. We also used spatial wavelet
coherence to test for a relationship of deer 
abundance with DVCs, and deer abundance with DVCs 
adjusted for traffic volume. When the temporal and 
spatial extents of available data for two spatiotemporal variables 
were not identical, we retained only the 
locations and time range over which data were 
available for both variables when testing for 
spatial wavelet coherence. When testing for spatial 
wavelet coherence between a spatiotemporal variable and a 
climate index (PDO, MEI or NAO, each of which 
comprised only a single time series), we considered 
that the same index time series pertained to all 
locations for which the spatiotemporal variable was 
measured. 

\textbf{Wavelet Moran theorem, fractions of synchrony explained, and predicted synchrony.} We calculated the amount of deer abundance 
synchrony explained by individual weather and 
climate variables, as well as the amount of DVC 
synchrony explained by deer abundance, following 
the wavelet Moran theorem of @Sheppard2016_aphids. 
As part of this procedure, we also calculated the 
average "cross terms" of @Sheppard2016_aphids over 
the timescale band of interest (see supplementary 
files of @Sheppard2016_aphids, equation 22), again following the 
procedures described in that reference. The precise 
mathematical meaning of cross terms is explained by @Sheppard2016_aphids; for operational purposes, they 
provide a test of whether modelling assumptions of @Sheppard2016_aphids are sufficiently met to use the 
wavelet Moran theorem to estimate fractions of 
synchrony explained. Cross terms less than $10\%$ 
of estimated fractions of synchrony explained were 
considered necessary to make statements about fractions of synchrony explained. Cross terms associated with a spatial wavelet coherence between a spatiotemporal variable and a non-spatial variable (such as one of the climate indices) were always $0$ by mathematical necessity [@Sheppard2016_aphids].

We calculated the amount of deer abundance 
synchrony jointly explained by snow depth, 
$\text{MEI}_{\text{w}}$, and $\text{PDO}_{\text{w}}$ using a wavelet linear regression 
approach [@Sheppard_wavmodel]. This method, the detailed mathematics of which are described by @Sheppard_wavmodel along with an application, 
is analogous to multiple linear regression, with a 
model describing the relationship between a 
response variable and multiple predictor variables; 
but in contrast to standard regression, response 
and predictor variables are 
wavelet transforms of spatiotemporal variables. The approach gives several outputs which we use. 
First, the approach gives the fraction of synchrony (in our case, $`r round(abunmodelSyncExp,0)`\%$ 
for $3-7$-year timescales) in the response variable (county-level deer abundance) that can be 
explained by the synchrony of the predictors (snow depth, $\text{MEI}_{\text{w}}$, and 
$\text{PDO}_{\text{w}}$). The validity of this result is again subject to whether cross terms were 
small (less than $10\%$ of the fraction of synchrony explained). They were small, 
$`r round(abunmodelXterms,0)`\%$, for our model. The approach also gives a "predicted synchrony" plot 
(colors in main text Fig. \ref{MT-Fig3_DeerSync}C), which is a function of time and timescale. The 
plot shows what the pattern of synchrony in the response variable (deer abundance) would look like if 
the only drivers of synchrony were the predictor variables. Predicted synchrony plots can be compared 
directly to the wavelet mean field magnitude plot of the response variable, similarity of the two 
plots giving a visual indication of whether the predictors in the model adequately explain synchrony 
in the response variable. The function `wlm` and related functions from `wsyn` implement these tools.

Proper partitioning of spatial synchrony, into a component explained by the synchronous drivers in a wavelet linear model and a component corresponding to factors independent of those drivers (residuals in the model), is only possible if cross terms, which also appear in the model, are small compared to the other components [@Sheppard2016_aphids; @Sheppard_wavmodel].
Large cross terms correspond to a general association between the model (drivers, or predictor variables) at one location and the residuals of the model at other locations [@Sheppard2016_aphids; @Sheppard_wavmodel].  Such associations may occur as a result of the population at the first location dispersing to the second location and being included in the count there. Considering a coarser spatial scale limits the potential for dispersal to have such an influence on our statistics, so one expects that if cross terms are large at the county spatial scale, the problem may be mitigated at the district scale, as happened in some
of our analyses (see section "USDA district results" in SI Appendix). 

\textbf{Randomization procedure for removing synchrony at $3-7$-year timescales.} In order to quantify the degree to which 
synchronizing effects are responsible for 
fluctuations in statewide total deer and DVC time 
series (main text Fig. \ref{MT-Fig5_StateWideFluctuations} and associated text), 
we adapted the standard Fourier surrogate procedure 
of Theiler [@Theiler1992]. We constructed artificial 
deer abundance and DVC time series for each 
location, having the same variance and spectral 
characteristics as the original data but no spatial 
synchrony in the $3-7$-year timescale band of 
interest. Components of variability and synchrony 
outside this band (such as longer-term trends or 
fluctuations, and higher-frequency components 
associated with 'spikiness' in the data) were left 
unchanged. To produce surrogate data for a given 
location, we took the Fourier transform of the time 
series and randomized the phases of the Fourier 
components inside the $3-7$-year timescale band 
before inverse transforming to produce the 
surrogate time series. Because only phases of the 
Fourier transform were randomized, power spectra and 
variances of time series are unchanged. 
Additionally, because phases in the $3-7$-year 
timescale band are randomized independently, 
surrogate time series so produced no longer exhibit 
a tendency to synchrony in the $3-7$-year timescale 
range [@Schreiber2000]. Phase randomization was 
accomplished by adding a random and uniformly distributed phase increment 
between $0$ and $2\pi$ to the phase of each Fourier 
component with a frequency greater than or equal to 
$1/7$, but less than $1/3$ cycles per year. 
Additionally, because the phase values of the 
Fourier components of a real signal are 
anti-symmetric about the Nyquist frequency ($1/2$ 
cycles/year), Fourier components with frequencies 
less than or equal to $6/7$ and more than $2/3$ 
cycles per year had the same set of phase 
increments subtracted to preserve the anti-symmetry 
property of Fourier transforms. We summed each set 
of surrogate time series spatially to produce a 
surrogate state-total time series representative of 
the hypothetical case in which $3-7$-year timescale 
synchrony was absent. Such surrogate state-total 
time series were compared to the actual time series 
(deer abundance or DVCs) to show the nature of the 
additional variance in the state-total time series 
that was attributable to synchrony (main text Fig. \ref{MT-Fig5_StateWideFluctuations}).

\textbf{Details on estimating approximate monetary impact of DVCs.} We estimated the approximate monetary impact of 
synchrony in DVCs based on several reported 
assumptions about DVCs. Using an average difference in DVCs
between peak and trough years 
(main text Fig. \ref{MT-Fig5_StateWideFluctuations}) of `r avgdvcfluc`, and if we assume 
that each reported DVC results in an average of 
US\$2024 of damage [@Conover2011_bookchp], the 
difference in damages statewide between peak and 
trough years is more than US\$5M. Given that DVCs 
may be only reported about 50% of the time 
[@Marcoux2010_dvc], this number is actually likely 
greater than US\$10M. Using different assumptions 
of the cost of DVCs [@Huijser2008_dvc], the 
difference between peak and trough years in DVC 
costs may exceed US\$22M.    

<!--Fourier methods that were used to generate supporting results-->
\textbf{Fourier methods, deer.} Although our wavelet methods were most appropriate for discovery
of our results, some researchers are more comfortable with Fourier methods, and many of our
results can also be demonstrated, \emph{post hoc}, using Fourier methods once one has 
realized via the wavelet methods what to look for. So we here describe Fourier methods we
applied which support our wavelet results for deer. The Fourier results support the conclusions that:
1) spectral power in the 3-7yr timescale band for the total deer time series for WI was
significant, much greater than it would have been absent synchrony between county-level
deer time series in the 3-7yr band; and 
<!--***DAN: have not done the calculations suporting 2 below, this is just what I hope to accomplish-->
2) spectral power in the 3-7yr band is much greater for the state-total deer time series than 
for the county-level time series.
<!--***DAN: do you also want to do something with DVCs? Probably should.-->

After discovering (Fig. \ref{MT-Fig3_DeerSync}A) that synchrony in deer is primarily at 3-7yr timescales,
to test whether the theory presented above is reflected in our deer data, it sufficies to show
that spectral power in the 3-7yr timescale band was much greater for the total deer time series 
for WI than it would have been, absent synchrony between county-level deer time series in the 3-7yr 
band. In other words, if synchrony in the 3-7yr band were a cause of 3-7yr deer population 
cycling at the state level, then when synchrony is removed but county-level time series are 
kept otherwise statistically similar, state-level cycling should be significantly and substantially reduced. 
We calculated spectral power in the 3-7yr band and compared the result to the same statistic calculated for
the surrogate time series of Fig. \ref{MT-Fig5_StateWideFluctuations}A (grey lines - methods for generating 
those surrogates are described above). A $p$-value result for the test of the null hypothesis that 
synchrony did not cause or amplify cycling is the fraction of surrogate values greater than the 
value for data. We also displayed the power spectra of the data and the surrogates, to make
possible a visual comparison, and tests of whether, for each timescale/frequency in the 3-7yr band
the spectrum of data was above the distribution of spectra for surrogates. To calculate spectral power in
the 3-7yr band summed a raw periodigram across those timescales; to display the spectrum
we used a consistent estimator of @Brillinger2001 (section 5.6 of that text). The summed
periodogram provides the exact spectral power in the band, whereas the consistent estimator is
smoothed and is more appropriate for display of the spectrum [@Brillinger2001].

Although the surrogates of Fig. \ref{MT-Fig5_StateWideFluctuations}A are most appropriate for our
research goals, some past researchers have used autoregressive surrogates for significance testing
spectral quantities. 
<!--***DAN: Need to insert some references here-->
Because autoregressive surrogates are fairly common, we also tested our 
results using AR(1) surrogates, for completeness. But we emphasize that we consider 
autoregressive surrogates less appropriate for our research goals because they do not 
correspond to a null hypothesis that is explicitly about synchrony. We fitted an AR(1)
model by maximum likelihood to the detrended state-total deer time series, and then
used the resulting parameterized model to generate surrogate timeseries. Spectral power in the 
3-7yr band (computed by summing a raw periodogram across the band) for data was compared
to the distribution of values of the same statistic for surrogates, again producing a $p$-value.
We also displayed the power spectra (using the estimator of section 5.6 of @Brillinger2001) of 
the data and the surrogates, again to make possible visual comparison and tests for individual 
timescales/frequencies. 

Finally, we used maximum likelihood to fit autoregressive models of different orders to 
detrended state-total deer time series, comparing orders using the Akaike Information
Criterion (AIC). Spectra were displayed for the fitted models of orders for which the
AIC indicated the best correspondence with data. 

# Supplementary results \label{SI:results}

\textbf{Additional county results}. The main text focuses on county-level results,
whereas this supplementary section focuses on district-level and statewide
results. Nevertheless a few ancillary county-level results are also reported here, as follows. 
Using county-level data, snow depth and climate index results seemed to 
indicate distinct or partly distinct phenomena 
synchronizing deer on different timescales within the $3-7$-year range. 
Applying the wavelet Moran theorem, snow depth explained $40\%$ of synchrony in deer
abundance at $3-4$-year timescales (Table \ref{Tab1_CountyCoherenceSummary}; see also
USDA district level results, below and Table \ref{TabS2_SummaryDistrict},
which were similar but had smaller cross terms).
<!--***DAN: Tom, I replaced the below text with the above text. It seemed confusing and not entirely necessary
to switch to the USDA-level results and back, given we set a 10% threshold for cross terms and the county-level
result has cross terms just under that. Keeping the old text for now in case we realize a problem
and want to revert back to the old text.
Again applying the wavelet
Moran theorem, snow depth explained $`r round(usda.snowabunSyncExp3_4,0)`\%$ of synchrony in deer
abundance at $3-4$-year timescales when data were aggregated to USDA districts (SI section \ref{SM-SI:results} and Table \ref{SM-TabS2_SummaryDistrict}). 
-->
Dynamics at $3-4$-year timescales were not well explained by either $\text{MEI}_{\text{w}}$ or $\text{PDO}_{\text{w}}$, which instead contributed more
to deer synchrony over $4-7$-year timescales (Table \ref{Tab1_CountyCoherenceSummary}, see also 
Fig. \ref{FigS5_RanksInSurrogs}A and Table \ref{TabS2_SummaryDistrict}). 
$\text{MEI}_{\text{w}}$ and $\text{PDO}_{\text{w}}$ explained $`r round(abunwmeiSyncExp47,)`\%$ 
and $`r round(abunwpdoSyncExp47,0)`\%$ of deer synchrony on $4-7$-year timescales, respectively 
(Table \ref{Tab1_CountyCoherenceSummary}). Snow depth did not explain $4-7$-year 
synchrony: spatial wavelet coherence between snow depth and deer abundance on those timescales was 
not significant (Table \ref{Tab1_CountyCoherenceSummary}, 
Table \ref{TabS2_SummaryDistrict}). The timescale
bands $3-4$ and $4-7$ were chosen by examination of Fig. \ref{FigS5_RanksInSurrogs}.

\textbf{USDA district results.} Using district-level data, deer abundance 
again showed a prominent synchrony feature at $3-7$-year 
timescales, similar to the county-level analysis 
(Fig. \ref{FigS7_WMFAndPredictionsDistricts}A,C). Deer abundance was significantly related to $\text{MEI}_{\text{w}}$, 
and was marginally significantly related to $\text{PDO}_{\text{w}}$ on $3-7$-year timescales
(Table \ref{TabS2_SummaryDistrict}). Deer abundance was significantly related to snow depth on $3-4$-year timescales. These variables were the same ones identified as 
significantly coherent with deer abundance using 
county-level data. 
The phase relationships 
between these variables and deer abundance were also very similar 
to county-level relationships: snow depth and 
deer abundance were nearly in anti-phase; and climate 
indices and deer abundance showed approximately 
quarter-cycle phase shifts (Table \ref{TabS2_SummaryDistrict}). Combined, snow depth, $\text{MEI}_{\text{w}}$, and $\text{PDO}_{\text{w}}$ explained $`r round(usda.abunmodelSyncExp,0)`\%$ of the 
synchrony in deer abundance using 
USDA district data, and patterns of synchrony in deer abundance predicted by that model closely resembled actual patterns of deer abundance synchrony (Fig. \ref{FigS7_WMFAndPredictionsDistricts}E). Cross terms for this model were of small magnitude, $`r round(usda.abunmodelXterms,0)`\%$.

The climate indices explained similar amounts of 
deer abundance synchrony as for the county-level 
data (Table \ref{TabS2_SummaryDistrict}). Cross terms for snow depth and deer abundance over 
$3-4$-year timescales were nearly too large at the county level to make a reliable statement of 
synchrony explained at that level, but cross terms were not too large for the district-level 
analysis, and snow depth explained $`r round(usda_abunsnwd_syncexp34,0)`\%$ of synchrony at 
$3-4$-year timescales. This makes sense in light of possible effects of dispersal at smaller 
spatial scales, as explained in the section "Wavelet Moran theorem..." above; effects of dispersal 
would have been reduced at district level because a smaller proportion of deer disperse between 
spatial units for larger spatial units.
The result that snow depth appeared to influence deer on $3-4$-year timescales, while 
$\text{MEI}_{\text{w}}$ and $\text{PDO}_{\text{w}}$ were significantly spatially coherent and 
explained synchrony at $4-7$-year timescales pertained to district-level data as it did for 
county-level data.

As in the county-level analyses, hunter abundance time series were not spatially coherent with deer abundance time series on $3-7$-year timescales (Table \ref{TabS2_SummaryDistrict}), so any synchrony there may have been in hunter abundances at those timescales could not have explained synchrony in deer. Again similar to the county-level analyses, hunter abundance time series were significantly coherent with deer abundance on $2-2.5$-year timescales (Table \ref{TabS2_SummaryDistrict}), but there was little deer abundance synchrony on those timescales to explain (Fig. \ref{FigS7_WMFAndPredictionsDistricts}A,C).

DVC data aggregated to USDA districts had a similar 
synchrony feature to deer abundance over $3-7$ year 
timescales (Fig. \ref{FigS7_WMFAndPredictionsDistricts}B,D). As 
at county level, deer abundance time series were significantly spatially coherent with DVC time series on $3-7$-year timescales (Table \ref{TabS2_SummaryDistrict}).
Whereas cross terms were high enough at county-level to render meaningless statements about fractions of DVC synchrony explained by deer synchrony, this was not the case at district level: cross terms were low (Table \ref{TabS2_SummaryDistrict}), and fractions of DVC synchrony explained by deer synchrony were $`r round(usda_dvcabunSyncExp,0)`\%$ for raw DVC data and $`r round(usda_adjdvcabunSyncExp,0)`\%$ for traffic-adjusted DVCs. The difference in cross terms between county- and district-level analyses again makes sense in light of dispersal, as explained above. Large cross terms may reflect the 
effects on the statistics of dispersal of 
deer between counties or movements of cars between 
counties, but such effects would be
reduced at the larger district level because reduced fractions of deer and cars disperse from one spatial unit to another for these larger spatial units. 
Patterns of synchrony in DVCs predicted by synchrony in deer looked similar to actual patterns of synchrony in DVCs (Fig. \ref{FigS7_WMFAndPredictionsDistricts}F). 

\textbf{Statewide Analysis and Results.} For statewide analyses, for which all 
variables were represented only by single, state-average or 
total time series rather than spatiotemporal data, timescale-specific relationships 
between variables were tested using ordinary 
wavelet coherence. Wavelet coherence is a 
non-spatial version of the spatial wavelet coherence, and 
tests whether two time series exhibit consistent 
phase differences and correlated magnitudes of 
oscillation through time, as a function of 
timescale. We tested for relationships between 
statewide deer abundance time series and climate 
indices, statewide averages for winter weather, 
statewide hunter abundance time series, and 
statewide total DVCs. The same functions in the `wsyn` package listed above for spatial wavelet coherence were used, as they can compute both ordinary wavelet coherence and spatial wavelet coherence.

In general, results of statewide analyses 
mostly agreed with the smaller-spatial-unit 
analyses, when they could be compared. Results on synchrony were not available at state level because at that level each variable is only represented by a single time series, but we compared wavelet coherence results between variables at the statewide spatial scale to spatial wavelet coherence results between variables using smaller spatial units. Statewide deer abundance and DVC time series were marginally 
significantly coherent over $3-7$-year timescales 
($P = `r round(ann.dvc.abun_pval,4)`$), with the strongest relationship occurring over 
$3-5$-year timescales ($P = `r round(ann.dvc.abun_pval35,4)`$). 
$\text{MEI}_{\text{w}}$ and $\text{PDO}_{\text{w}}$ were significantly 
coherent with deer abundance over the $3-7$-year 
timescale band ($\text{MEI}_{\text{w}}$, $P = `r round(ann.abun.wmei_pval,4)`$; 
$\text{PDO}_{\text{w}}$, $P = `r round(ann.abun.wpdo_pval,4)`$). Snow depth was not 
significant over $3-7$-year timescales ($P = `r round(ann.abun.snow_pval37,4)`$), but 
was significant at $3-4$-year timescales ($P = `r round(ann.abun.snow_pval34,4)`$), 
consistent with the results at other spatial resolutions. 
Hunter abundance and deer 
abundance were not significantly coherent at the 
state level on $3-7$-year timescales ($P = `r round(ann.abun.hunter_pval37,4)`$) or $2-2.5$-year timescales ($P = `r round(ann.abun.hunter_pval2_2.5,4)`$).

<!--Fourier results-->
\textbf{Fourier methods, deer.} Total spectral power in the 3-7yr timescale band for detrended state-total
deer time series (see SI section \ref{SI:methods} for methods) was much greater than the same quantity
computed for the surrogates of Fig. \ref{MT-Fig5_StateWideFluctuations}; this was true for
all the surrogates used (Fig. \ref{FigS_SpectPow3to7Fig5Surrogs}). Since the surrogates represent a case 
in which synchrony inthe 3-7yr timescale band is absent but county-level deer time series are 
kept otherwise statistically similar, this result shows that synchrony in the 3-7yr timescale band
markedly increases state-total population cycling on 3-7yr timescales. The corresponding $p$-value
(SI section \ref{SI:methods}) would be vanishingly small. The power spectrum of the state-total
deer time series was above the spectra of all surrogates at nearly all frequencies corresponding
to timescales in the 3-7yr range (Fig. \ref{FigS_SpectraFig5Surrogs}).

Total spectral power in the 3-7yr timescale band for detrended state-total
deer time series was also greater than the same quantity computed for a fraction `r round(Fourier3PvalRes,4)` 
of AR(1) surrrogates (Fig. \ref{FigS_SpectPow3to7ARSurrogs}). Thus `r round(Fourier3PvalRes,4)` is a $p$-value for a test of the 
null hypothesis corresponding to AR(1) surrogates. However, we emphasize, as explained in SI section \ref{SI:methods},
that that null hypothesis does not explicitly relate to synchrony, and so is less appropriate for our research purposes
then the null hypothesis represented by the surrogates of Fig. \ref{MT-Fig5_StateWideFluctuations}, for which the $p$-value was
vanishingly small, much lower than `r round(Fourier3PvalRes,4)` (see previous paragraph and 
Fig. \ref{FigS_SpectPow3to7Fig5Surrogs}). 

A conservative analyst may argue that a multiple-testing correction is required because the tests in the two preceding
paragraphs focused on timescales in the 3-7yr range, but spectra were generated for timescales across a broader 
range. This is debatable, since our theory and our deer wavelet mean fields, which showed synchrony in the 3-7yr timescale range,
provided an \emph{a priori} reason to test the 3-7yr timescale range, specifically, rather than scanning across multiple 
timescales bands for a spectral peak. Nevertheless, we Bonferroni corrected, as
follows. Power spectra based on 36-year time series, such as those we used, are typically evaluated at 
18 frequencies, and there are 7 such frequencies corresponding to timescales between 3 and 7 years, the ratio being
18/7=2.57. Rounding up to 3 tests, a Bonferroni-adjusted $p$-value threshold for a 
family-wise error rate of $5\%$ may therefore be considered to be 
$0.05/3=0.0166$, so both tests in the preceding two paragraphs were still significant after such a 
conservative correction. 

The power spectrum of the state-total deer time series was also compared visually to the spectra of AR(1) surrogates
(Fig. \ref{FigS_SpectraARSurrogs}). For several timescales within the 3-7yr range the data spectrum was higher than the
95th quantile of surrogate spectra. A conservative analyst may argue that a multiple-testing correction is required, because
mutliple timescales are considered. We consider two corrections, both very conservative but one even more so than the other.
Considering timescales to correspond to independent tests (they do not, for the spectral estimator we used, which 
involves smoothing the raw periodigram across nearby frequencies), and equating the number of timescales within the 3-7yr band to the number of tests performed, the Bonferroni-corrected threshold for a family-wise error rate of $0.05$ 
was $0.05/7=0.0071$. Instead using all 18 timescales
for whuch spectra were available, the Bonferroni-corrected threshold was $0.05/18=0.0027$. The spectrum of data exceeded
the former and almost exceeded the latter threshold for at least one timescale in the 3-7yr range (Fig. 
\ref{FigS_SpectraARSurrogs}). We emphasize that these tests are excessively conservative and sub-optimal for multiple 
reasons: 1) they use AR(1) surrogates, which are not ideal, as discussed above; 2) they require that the spectrum of data 
exceed spectra of surrogates for at least one *specific timescale* in the range 3-7yrs, whereas theory and results on 
synchrony only predict that *total spectral power* in that range will exceed that of appropriate surrogates; 3) they assume 
independence of timescales, and the latter test sub-optimally counts timescales outside the 3-7yr range as tests performed, 
even though theory and wavelet mean field results provide an *a prior* reason to examine only timescales within the
3-7yr range; 4) the Bonferroni correction is well known to be a conservative multiple-testing correction. 
Although the results at the beginning of this section (Fig. \ref{FigS_SpectPow3to7Fig5Surrogs} and accompanying results 
on total spectral power in the 3-7yr range) are more appropriate and also indicate substantially higher 
statistical confidence that our deer provide evidence of our theoretical mechanism, we nevertheless provide these 
alternative analyses to demonstrate the robustness of our conclusions: for deer in WI, timescale-sepcific synchrony 
promotes significant population cycling even under extremely conservative statistical testing procedures. 

Fitting AR models of different orders to the detrended state-total deer time series gave AIC values
as in Table \ref{Table_AR_AIC_Table}. The AR order for which the lowest AIC was obtained was 2.
Order 3 had a similar AIC, but other orders had meaningfully worse AICs. Recall that lower AICs mean 
better model-data agreement, and AIC differences of more than 2 or 3 are considered meaningful.
We plotted the spectrum of the best-fitting AR(2) and AR(3) models (Fig. \ref{FigS_SpectraARFits}). 
These spectra were indistinguishable and they had a peak at frequency about 0.2 (timescale about 5 years). 
Non-peaked spectra, corresponding to the alternative hypothesis that the state-total deer time 
series is not significantly periodic, are represented by the AR(0) and AR(1) models, which have difinitively worse
AIC values (Table \ref{Table_AR_AIC_Table}). Fig. \ref{FigS_DetrendedStateTotalDeer} shows the detrended state-total
deer population time series. Periodicity seems visually evident, consistent with the above multi-pronged analysis.

\newpage

# Supplementary figures and tables

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/TheoryExample1.png}
\caption[Results for theoretical example 1]{Results for theoretical example 1. 
See section \ref{SI:theory} for a full description of the
model setup for the example. Top panels are for case 1 and bottom panels for case 2.
Red lines (A-F) are expected noise spectra (A-B), cospectra (C-D), and spectra
of total populations (E-F). Grey lines are estimates of these same quantities
based on simulations of length 1024 (100 simulations plotted; a periodigram 
estimator with a modified Daniell smoother was used, implemented in the spec.pgram 
function in the R programming language). Panels G-H show example spatial-total populations for one of the simulations.}\label{TheoryExample1}
\end{figure}

\newpage
\clearpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/TheoryExample2.png}
\caption[Results for theoretical example 2]{Results for theoretical example 2. See
section \ref{SI:theory} for a full description of the
model setup for the example. Plot format is like that of Fig. \ref{TheoryExample1}.}\label{TheoryExample2}
\end{figure}

\newpage
\clearpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/TheoryExample3.png}
\caption[Results for theoretical example 3]{Results for theoretical example 3. See 
section \ref{SI:theory} for a full description of the
model setup for the example. Plot format is like that of Fig. \ref{TheoryExample1}.}\label{TheoryExample3}
\end{figure}

\newpage
\clearpage

\begin{figure}[!h]
\includegraphics[height=0.8\textheight]{Results/FigS2.png}
\caption[Map of counties and districts]{Map of Wisconsin, USA. Black lines and yellow dots delineate county boundaries and centroids. Color shading and black dots delineate USDA district boundaries and centroids.\label{FigS1_map}}
\end{figure}

\newpage
\clearpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/PedagogFig_WMF.png}
\caption[Demonstration of the wavelet mean field]{Detecting time- and timescale-specific
synchrony with the wavelet mean field. This figure was taken without change from
Sheppard \emph{et al.} (2016), where additional details are also available. Panels a-d show the principle of how synchrony
can differ for different timescales of dynamics. Time series y1 and y2 (a)
are exactly anti-correlated (out of phase), as are y3 and y4 (b). Combining
y1 with y3 and y1 with y4
gives two time series (c) which are synchronized on long timescales, but anti-synchronized
on short timescales. The reverse is also possible (d). This timescale-specific
structure of synchrony cannot be detected with correlation coefficients, which are
0 for both c and d, because contributions from different timescales cancel.
In practice, real population and environmental signals are broadband, and exact cancellation
is unlikely, but asynchrony at some frequencies can strongly conceal important
synchrony at other frequencies. Panels e-k demonstrate this concealment, using artificial data,
and also show how the wavelet mean field magnitude detects time- and timescale-specific synchrony.
Each of 11 artificial time series were constructed as the sum of: 1) a single common
signal of amplitude 1 that changes its oscillatory period at $t=50$ from 10 years
to 5 years (e); 2) oscillations
of amplitude 3 that have the same oscillatory period
(3 years), but random and independent phases in
each of the 11 constructed
time series (f); and 3) white noise of standard deviation 1.5, again independently
generated for each of the 11 time series (g). Synchrony in the resulting time series cannot
be visually detected (i), nor is it readily apparent by examining the
55 pairwise correlation coefficients between time series (j), which spanned a
wide range of values including 0. But the wavelet mean field magnitude (k)
showed clear color bands at 10-year period for $t<50$ and 5-year period for
$t>50$. The wavelet mean field magnitude displays strength of
synchrony as a function of timescale
of dynamics and time, here with red indicating synchrony and blue asynchrony.
Wavelet phasor mean fields provide magnitude plots similar to (k) but with values
between 0 and 1 that indicate the strength of phase synchrony and that can be
straightforwardly significance tested as described by Sheppard \emph{et al.} (2019). \label{PedagogFigWMF}}
\end{figure}
<!---***TOM: Citations in caption above are not dynamic links, need to change manualy--->

\newpage
\clearpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/PedagogFig_SpatCoh.png}
\caption[Demonstration of spatial wavelet coherence]{Measuring relationships between variables using spatial wavelet coherence.
This figure was adapted with only minor changes
from supplementary figure 5 of Sheppard \emph{et al.} (2016).
The time series of panel e were used as drivers in producing the time series of
panel f and the figure shows
how this relationship can be detected with the spatial wavelet coherence technique.
The time series of panel e
were constructed as the sum of: 1) a single common signal of amplitude $1$ and
period $12$ years (a); 2) a
single common signal of amplitude $5$ and period $2$ years (b); and 3)
normally distributed white noise of standard deviation $1.5$,
independently generated for each of the $10$ time series (c). The time series
of panel f were produced via the
relationship $y_n(t) = (x_n(t)+x_n(t-1))/2 + \epsilon_n (t)$ where
the $\epsilon_n (t)$ were independent normal random numbers
of mean $0$ and standard deviation $3$. This transmits the period-$12$
component of the $x$ signals to the $y$ but
not the period-$2$ component because averaging covers a whole
period for that component. Correlations (f,
green numbers) between $x_n(t)$ and $y_n(t)$ did not indicate
any particular relationship. Correlations cannot
detect the relationship between the $x$ and $y$ because the correlation technique confounds
phenomena occurring on different
timescales. Spatial wavelet coherence revealed a highly significant relationship
at periods around $12$ years (g) and on
average over long timescales (left $P$-value on panel g, long timescales
defined as $>4$ years) but no relationship
(right $P$-value) for short timescales ($<4$ years). The red line on g is the
spatial wavelet coherence and black lines are
$50$th, $95$th, and $99$th percentiles of spatial wavelet coherences
of synchrony-preserving surrogate (randomized) data sets (Sheppard \emph{et al.} 2016)
appropriately representing the
null hypothesis of no relationship between the $x$ and $y$.
Also see Sheppard \emph{et al.} (2016) for a description of how the aggregate long- and short-timescale $P$-values were computed. \label{PedagogFigSpatCoh}}
\end{figure}
<!---***TOM: Citations in caption above are not dynamic links, need to change manualy--->

\newpage
\clearpage

\begin{figure}[!h]
\includegraphics[height=.9\textheight]{Results/FigS8.png}
\caption[Mean fields for environmental variables]{Wavelet mean fields (left column) and wavelet phasor mean fields (right column) of winter Tmin (A, B), Tmax (C, D), snow depth (E, F) and precipitation (G, H) using county-level data. Colors and contours as in main text Fig \ref{MT-Fig3_DeerSync}A,B. \label{FigS8_WMFsAndWPMFsAncillary}}
\end{figure}

\newpage
\clearpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/FigS4.png}
\caption[Phase differences between variables]{Phase differences between variables as a function of timescale for the main significant relationships of main text Table \ref{MT-Tab1_CountyCoherenceSummary} and
Table \ref{Tab1_CountyCoherenceSummary}, county-level data: A) winter MEI ($\text{MEI}_{\text{w}}$) 
and deer abundance, B) summer MEI and 
deer abundance, C) winter PDO ($\text{PDO}_{\text{w}}$) and deer abundance, 
D) snow depth and deer abundance, E) deer abundance and 
deer-vehicle collisions, F) deer abundance and deer-vehicle collisions adjusted for traffic volume, and 
G) deer abundance and hunter abundance. $\bar{\theta}$ indicates the mean phase (in units of $\pi$
radians) for the shaded timescale bands. Horizontal axes differ in extent among panels due to different
time ranges of available data for different variables. \label{FigS4_PhaseDiffs}}
\end{figure}

\newpage
\clearpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/FigS5.png}
\caption[Wavelet coherence rank data]{Rank, by timescale, of spatial wavelet coherence values in surrogate spatial wavelet coherence distributions (\emph{Methods}) for the main significant relationships of main text Table \ref{MT-Tab1_CountyCoherenceSummary} and Table \ref{Tab1_CountyCoherenceSummary}, using county-level data. In A), results are comparisons of the listed variables with deer abundance. In B), `Abun-DVCs' is a comparison of deer abundance and DVCs, `Abun-Adj. DVCs' is a comparison of deer abundance and DVCs adjusted for traffic volume, and `Hunters-Abun' is a comparison of hunter numbers and deer abundance. The red horizontal line would be analogous to a $P$-value of $0.05$ for an individual timescale (\emph{Methods}).\label{FigS5_RanksInSurrogs}}
\end{figure}

\newpage
\clearpage

\begin{figure}[!h]
\includegraphics[width=.3\textwidth]{Results/FigS6.png}
\caption[Hunter mean fields and predictions of deer synchrony based on hunters]{Wavelet mean field (A) and wavelet phasor mean field (B) magnitudes of county-level hunter abundance 
time series, and predicted synchrony of deer abundance based on a wavelet model with sole predictor hunter 
abundance (C). Higher values in A, B indicate greater synchrony (A) or phase synchrony (B) of hunter abundance 
time series at the indicated times and timescales. Contours on (B) indicate statistical significance of phase 
synchrony at $P = 0.001$. Colors in (C) show predicted synchrony in deer abundance, while contours show the 
actual wavelet mean field magnitude of deer abundance, similar to the contours shown in main text Fig. \ref{MT-Fig3_DeerSync}C. Slight differences exist here vs main text Fig. \ref{MT-Fig3_DeerSync}C because of different spatiotemporal extents of the data used in hunter analyses. Agreement is poor between colors and contours 
on panel C, giving a 
visual indication of the statistical result that hunter abundance does not explain deer abundance or synchrony 
well on $3-7$-year timescales.\label{FigS6_WMFHunter}}
\end{figure}

\newpage
\clearpage

\begin{figure}[!h]
\includegraphics[height=.8\textheight]{Results/FigS7.png}
\caption[Mean fields and predicted synchrony for deer and DVCs, USDA district data]{Wavelet mean field (A, B) and phasor mean field (C, D) magnitudes, and predicted synchrony (E, F) for deer abundance (A, C, E) and DVCs (B, D, F) using USDA-district data. Higher values in A-D indicate greater synchrony (A, B) or phase synchrony (C, D) at the indicated times and timescales. Contours on (C, D) indicate statistical significance of phase synchrony at $P = 0.001$. Colors in (E) show synchrony in deer abundance predicted from a wavelet model using snow depth, $\text{MEI}_{\text{w}}$, and $\text{PDO}_{\text{w}}$ as predictors, while contours show the actual wavelet mean field magnitude of deer abundance from (A), for comparison. Agreement is good, giving a visual indication of the statistical result that climatic Moran effects explain deer synchrony. Colors in (F) show synchrony in DVCs predicted by a wavelet model with sole predictor deer abundance, while contours are from (B) and again show good agreement. Vertical axes differ between left and right panels because time series were shorter for DVCs. \label{FigS7_WMFAndPredictionsDistricts}}
\end{figure}

\newpage
\clearpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/Fourier1.png}
\caption[Spectral power, 3-7yr band, state-total deer and Fig. \ref{MT-Fig5_StateWideFluctuations} surrogates]{The red dot shows 
total spectral power, in the 3-7yr timescale range, of the detrended state-total deer population time series for WI, whereas the 
histogram shows values of the same statistic computed for the surrogates (again detrended) of Fig. 
\ref{MT-Fig5_StateWideFluctuations} from the main text. The value for data was much greater than the values for all of the 
surrogates.}\label{FigS_SpectPow3to7Fig5Surrogs}
\end{figure}

\newpage
\clearpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/Fourier2.png}
\caption[Power spectra, state-total deer and Fig. \ref{MT-Fig5_StateWideFluctuations} surrogates]{Power spectrum of the 
state-total deer time series (black line) superimposed with spectra of the surrogates of 
Fig. \ref{MT-Fig5_StateWideFluctuations} (grey lines). Vertical lines 
are at the frequencies corresponding to timescales of 3 and 7 
years. At nearly all the frequencies in that range, the spectrum of the data was above the spectra of all the 
surrogates. Spectra are identical sufficiently far outside the 3-7yr timescale band because Fig. 
\ref{MT-Fig5_StateWideFluctuations} surrogates only involved randomization of Fourier components outside this range.
Spectra are non-identical slightly outside the 3-7yr timescale range because the spectral estimator used was based on smoothing across nearby frequencies.}\label{FigS_SpectraFig5Surrogs}
\end{figure}

\newpage
\clearpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/Fourier3.png}
\caption[Spectral power, 3-7yr band, state-total deer and AR(1) surrogates]{The red dot shows 
total spectral power, in the 3-7yr timescale range, of the detrended state-total deer population time series for WI, whereas the 
histogram shows values of the same statistic computed for the AR(1) surrogates (again detrended; see SI 
section \ref{SI:methods}).}\label{FigS_SpectPow3to7ARSurrogs}
\end{figure}

\newpage
\clearpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/Fourier5.png}
\caption[Power spectra, state-total deer and AR(1) surrogates]{Power spectrum of the 
state-total deer time series (solid black line) superimposed with spectra of AR(1) surrogates (SI section \ref{SI:methods}). 
Vertical lines are at the frequencies corresponding to timescales of 3 and 7 
years. The dashed line is the 95th quantile of the surrogate spectra. The lower dotted line is a 
quantile of the surrogates for a Bonferroni-corrected significance threshold assuming
$n$ independent tests, where $n$ is the number of timescales between 3 and 7 years for which 
spectra were evaluated. The upper dashed line is for a Bonferroni-corrected threshold
using $n$ equal to the total number of frequencies for which spectra were evaluated, both within and
outside the 3-7yr timescale band.}\label{FigS_SpectraARSurrogs}
\end{figure}

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/Fourier6.png}
\caption[Power spectra of AR(2) and AR(3) models fitted to the state-total deer time series]{Power spectra of AR(2) and 
AR(3) models fitted to the state-total deer time series. The AR(2) model spectrum is plotted as a solid black line and the 
AR(3) model spectrum is plotted as a dashed red line; the lines are indistinguishable.}\label{FigS_SpectraARFits}
\end{figure}

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/Fourier7.png}
\caption[Detrended state-total deer population time series]{Detrended state-total deer population time series.}\label{FigS_DetrendedStateTotalDeer}
\end{figure}


\newpage
\clearpage

```{r Table1,echo=F,results='markup'}
options(knitr.kable.NA = '') #makes it put blanks instead of "NA" for NAs
rownames(Table1)<-NULL
knitr::kable(Table1,
             format="latex", align="l",escape=F,
             digits=4,
             col.names=c("Predictor","Response","Timescales", "P-value","Mean phase ($\\bar{\\theta}$)","Synchrony explained","Average cross terms"),
             caption.short="Summary of county-level coherence test results",
             caption = "Summary of spatial wavelet coherence tests and related results using county-level data. $P$-values and mean phases are from tests of spatial wavelet coherence (\\textit{Methods}) of the variables in columns 1 and 2 over the indicated timescale band. Mean phases over the timescale band (units of $\\pi$ radians) are provided only when meaningful, i.e., when spatial wavelet coherence was significant, $P < 0.05$, or marginally significant. A positive mean phase indicates the variable in the column \\textit{Response} is leading, and a negative mean phase indicates the variable in the column \\textit{Predictor} is leading. The \\textit{Synchrony explained} and \\textit{Average cross terms}  columns, which give percentages, are based on wavelet linear regressions (\\textit{Methods}) of the \\textit{Response} transforms against the \\textit{Predictor} transforms. When cross terms are low, synchrony explained is interpretable as the approximate percentage of synchrony in the response explainable as due to the synchrony in the predictor. Cross terms were low enough except for tests involving DVCs, for which USDA district-level results were more reliable (SI Table \\ref{SM-TabS2_SummaryDistrict}). Cross-terms are zero for tests involving climate indices because for those tests the same values were used for all locations (\\textit{Methods}). All values were rounded to display four digits. Abundance = deer abundance. \\label{Tab1_CountyCoherenceSummary}",
             booktabs=T)
```

\newpage

```{r TableS1,echo=F,results='markup'}
rownames(TableS1)<-NULL
knitr::kable(TableS1,
             col.names=c("Predictor","Response","Timecale","P-value","Mean phase ($\\bar{\\theta}$)"),
             format='latex',align="l",escape=F,
             digits=4,
             caption.short="Wavelet coherence tests between climate indices",
             caption = "$P$-values of wavelet coherence tests, and associated mean phase differences for significant and marginally significant tests, between climate indices. Values are over $3-7$ year timescales. All values were rounded to display four digits. \\label{TabS1_PairwiseClimVarSpatCoh}",
             booktabs=T)
```

\newpage
\clearpage

```{r TableS2,echo=F,results='markup'}
rownames(TableS2)<-NULL
knitr::kable(TableS2,
             format='latex',align="l",escape=F,
             digits=4,
             col.names=c("Predictor","Response","Timescale", "P-value","Mean phase ($\\bar{\\theta}$)","Synchrony explained","Average cross terms"),
             caption.short="Summary of USDA district-level coherence test results",
             caption = "Summary of spatial wavelet coherence tests and related results using USDA district-level data (\\textit{Methods}). $P$-values and mean phases are from tests of spatial wavelet coherence (\\textit{Methods}) of the variables in columns 1 and 2 over the indicated timescale band. Mean phases over the timescale band (units of $\\pi$ radians) are provided only when meaningful, i.e., when spatial wavelet coherence was significant, $P < 0.05$, or marginally significant. A positive mean phase indicates the variable in the column \\textit{Response} is leading, and a negative mean phase indicates the variable in the column \\textit{Predictor} is leading. The \\textit{Synchrony explained} and \\textit{Average cross terms}  columns (which give percentages) are based on wavelet linear regressions (\\textit{Methods}) of the \\textit{Response} transforms against the \\textit{Predictor} transforms. When cross terms are low, synchrony explained is interpretable as the approximate percentage of synchrony in the response explainable as due to the synchrony in the predictor. They were low enough for all results in this table. Cross-terms are zero for test involving climate indices because for those tests the same values were used for all locations (\\textit{Methods}). All values were rounded to display four digits. \\label{TabS2_SummaryDistrict}",
             booktabs=T)
```

```{r AR_AIC_Table,echo=F,results='markup'}
rownames(AR_AIC_Table)<-NULL
knitr::kable(AR_AIC_Table,
             format='latex',align="l",escape=F,
             digits=4,
             col.names=c("AR order","AIC"),
             caption.short="AR fits by order for detrended state-total deer time series",
             caption="Autoregressive models of each order were fitted by maximum likelihood to the detrended state-total deer population time series, and AIC values are reported. \\label{Table_AR_AIC_Table}",
             booktabs=TRUE)
```

\newpage
\clearpage

# References {-}

<div id="refs"></div>

