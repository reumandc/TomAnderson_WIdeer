---
output:
  pdf_document:
    fig_caption: yes
    keep_tex: yes
    includes:
      in_header: head_supp.sty
  html_document:
    df_print: paged
  word_document: default
geometry: left=1cm,right=1cm,top=2.5cm,bottom=2.8cm
link-citations: yes
csl: nature.csl
tables: yes
bibliography: AndersDeerShortRefs.bib
urlcolor: blue
---

<!--Libraries-->
```{r libraries, echo=F, message=FALSE}
library(reshape2,quietly=T)
library(tools,quietly=T)
library(fields,quietly=T)
library(rmarkdown)
library(shape)
library(tinytex)
library(devtools,quietly=T)
library(withr,quietly=T)
```

<!--Flags controlling the run and other setup-->
```{r setup, echo=F}
#which density to use ("dnr" for original estimates, "tom" for your own calculations)
dens.flag<-"dnr"

#what is the earliest year you want? (abundance: 1981; DVC: 1987; Traffic: 1988, Hunters: 1992)
minyear<-1981

#what is the last year you want? (max is 2016)
maxyear<-2016

#set number of surrogates to use for spatial wavelet coherence
nsurrogs<-100000

#a function needed for caching
source("Code/mtime.R") 
```

<!--Generate the data-->
```{r data_generation, echo=F, cache=TRUE, results="hide", fig.show="hide", cache.extra=list(dens.flag,minyear,maxyear,mtime("Code/Deer_DataGeneration.R"),mtime("Data/WI_Cty_CentroidDD.csv"),mtime("Data/DOT_Accidents1987_2016.csv"),mtime("Data/Adj_DOT_Accidents1987_2016.csv"),mtime("Data/WI_USDA_Sections.csv"),mtime("Data/USDA_centroids.csv"),mtime("Data/Cty_Traffic.csv"),mtime("Data/DMU_DeerAbundance1981_2013.csv"),mtime("Data/DMU_DeerDensity1981_2013.csv"),mtime("Data/DMU_HunterAbundance1975_2013.csv"),mtime("Data/DMU_HunterDensity1975_2013.csv"),mtime("Data/hunterdens1416.csv"),mtime("Data/hunterabun1416.csv"),mtime("Data/Cty_Abun_2014_2016.csv"),mtime("Data/permit_issued1970_2013.csv"),mtime("Code/Climate_DataGeneration.R"),mtime("Data/noaa_latlongUpd.csv"),mtime("Data/WI_USDA_Sections.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set1.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set2.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set3.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set4.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set5.csv"),mtime("Data/Cty_NOAA_Temp1981_2015_set6.csv"),mtime("Data/Cty_NOAA_Temp2016_2017.csv"),mtime("Data/Cty_NOAA_Precip1981_1985.csv"),mtime("Data/Cty_NOAA_Precip1986_1991.csv"),mtime("Data/Cty_NOAA_Precip1992_1997.csv"),mtime("Data/Cty_NOAA_Precip1998_2003.csv"),mtime("Data/Cty_NOAA_Precip2004_2009.csv"),mtime("Data/Cty_NOAA_Precip2010_2015.csv"),mtime("Data/Cty_NOAA_Precip2016_2017.csv"),mtime("Data/climate_indices.csv"),mtime("Data/mei.csv"),mtime("Data/pdo.csv"))}

#Dependencies (listed in cache.extra above):
#1) Settings variables from the setup chunk
#2) all the data csvs (see Data folder)
#3) all the scripts sourced below (see Code folder)
#4) all the functions called (see Functions folder)

#Clean population data: end result are two lists of matrices called "cty.list" and "usda.list". Cty stands for county. All elements of cty.list are matrices, counties (rows) by year (columns). Elements are named Abun (abundance), Crashes (DVCs), Traffic (traffic), and AdjDVC (Traffic-adjusted DVCs). USDA stands for USDA districts, and all elements in "usda.list" are matrices, districts (rows) by year (columns) and named similarly to cty.list. In both lists, the data sets were complete in spatial dimension but varied in temporal dimension: deer span the years 1981-2016, Crashes 1987-2016 and Traffice/AdjDVCs 1988-2016. Missing years are filled with NAs. Both objects are saved as .rds files in the Results folder. These data sets are also used to generate state-level (single time series) data for deer abundance, DVCs, and hunter numbers. 

#***QC_Tests/tests_datagen_deer.R and QC_Tests/tests_datagen_climate.R are testing scripts to verify different data aggregatoin steps provide identical lists of raw data
source("Code/Deer_DataGeneration.R")

#Clean winter weather and climate data: end results are four lists of matrices called "winter.clim", climindex, winter.clim.usda, and climindex.usda. "winter.clim"" includes matrices, counties (rows) by year (columns) that are the averages of NOAA weather station data from Dec[t-1] to Mar[t], with named elements of Tmin (minimum temperature), Tmax (maximum temperature), Prcp (precipitation), and Snwd(snow depth). Not all counties had weather data in all years and are filled with NAs where missing. "winter.clim.usda"" are matrices, districts (rows) by year (columns) and includes the same variables and variable names as "winter.clim"" but averaged over USDA districts (~ 7 counties per district) and are complete in both dimensions. All objects are saved as .rds files in the Results folder."climindex" and "climindex.usda" are matrices of climate indices averaged over winter (Dec[t-1]-Mar[t]) and summer (Apr[t]-Nov[t]). Values in each matrices are repeated across rows because the climate indices are not a spatial variable. The dimensions of each match the spatial dimensions of other county (climindex) or district (climindex.usda) data sets. These data sets are also used to generate state-level (single time series) data for snow depth and climate indices. 
source("Code/Climate_DataGeneration.R")

```

```{r analysis, echo=F, cache=TRUE, results="hide", fig.show="hide", cache.extra=list(cty.list,usda.list,winter.clim,climindex,winter.clim.usda,climindex.usda,nsurrogs,mtime("Data/abunsurrsum.csv"),mtime("Data/dvcsurrsum.csv"),mtime("Code/DeerCoherence_wsyn.R"))}

#Run spatial coherence analysis on deer abundance and DVCs using county and district data. Tests include the effects of climate indices on deer abundance, winter weather on deer abundance, climate indices on winter weather, deer abundance on DVCs, deer abundance on traffic-adjusted DVCs. Also, run wavelet coherence on state level data between the same sets of variables. 
set.seed(101)
source("Code/DeerCoherence_wsyn.R")
```

<!---generate plots--->
```{r plots, echo=F, cache=T, results="hide", fig.show="hide", cache.extra=list(cty.list,usda.list,winter.clim,climindex,winter.clim.usda,climindex.usda,wlm_abun,wlm_dvc,mtime("Code/deer_plots.R"),mtime("Functions/Fn_wmfwt.R"),mtime("Functions/Fn_rankplot.R"),mtime("Code/PedagogFig.R"),mtime("Functions/deer_plotting_functions.R"))}
#generate plots
set.seed(201)
source("Code/deer_plots.R")
```

```{r echo=F, results="hide"}

#need to run so that objects that are large numbers can be evaluated with inline code
options(scipen = 999999)

#load in results
options(scipen=6)
#Load tables of results
TabS4_results<-readRDS(file = "Results/TableS4.rds")
TabS1_results<-readRDS(file = "Results/TableS1.rds")

usda_abunsnwd_syncexp34<-TabS4_results$SynchronyExplained[TabS4_results$Predictor=="Snow Depth" & TabS4_results$Response=="Abundance" & TabS4_results$Timescale=="3-4"]
usda_dvcabunSyncExp<-TabS4_results$SynchronyExplained[TabS4_results$Response=="DVCs" &
                                                        TabS4_results$Predictor=="Abundance"]
usda_adjdvcabunSyncExp<-TabS4_results$SynchronyExplained[TabS4_results$Response=="Traffic-adj. DVCs" &
                                                        TabS4_results$Predictor=="Abundance"]
snowabunSyncExp34<-TabS1_results$SynchronyExplained[TabS1_results$Predictor=="Snow Depth" & TabS1_results$Timescale=="3-4"]
avgdeerfluc<-readRDS(file="Results/totaldeerfluctuations.rds")
avgdvcfluc<-readRDS(file="Results/totaldvcfluctuations.rds")
avgdvccostsLow<-readRDS(file="Results/totaldvccostsLow.rds")
avgdvccostsHigh<-readRDS(file="Results/totaldvccostsHigh.rds")

abunmodelSyncExp<-readRDS(file="Results/abunmodelSyncExp.rds")
abunmodelXterms<-readRDS(file="Results/abunmodelXterms.rds")
usda.abunmodelSyncExp<-readRDS(file="Results/usda.abunmodelSyncExp.rds")
usda.abunmodelXterms<-readRDS(file="Results/usda.abunmodelXterms.rds")
gunhunter_percent<-round(100*mean(state.totals$GunHunters[state.totals$Year>1980]/(state.totals$GunHunters[state.totals$Year>1980]+state.totals$BowHunters[state.totals$Year>1980])),0)
```

<!--Save workspace. This is here because the Methods used to be in the sup mat,
occurred immediately below this chunk, and used all sorts of variables that were 
created above. Some were saved as rds files, some not. Rather than make sure all 
variables that are used in the Methods are saved as rds files and then loaded
before the new location of Methods in the main text, just save the whole workspace
here and then load it there.-->
```{r echo=F, results="hide"}
save.image(file="WholeWorkspace.RData")
```

# Synchronous effects produce major cycles in deer populations and deer-vehicle collisions: Supplementary information appendix

\begin{center}
Anderson, Sheppard, Walter, Rolley, Reuman
\end{center}

\textbf{USDA district results.} Using district-level data, deer abundance 
again showed a prominent synchrony feature at $3-7$ year 
timescales, similar to the county-level analysis 
(Fig. \ref{FigS8_WMFAndPredictionsDistricts}A,C). Deer abundance was significantly related to $\text{MEI}_{\text{w}}$, 
and was marginally significantly related to $\text{PDO}_{\text{w}}$ on $3-7$-year timescales
(Table \ref{TabS4_SummaryDistrict}). Deer abundance was significantly related to snow depth on $3-4$-year timescales. These variables were the same ones identified as 
significantly coherent with deer abundance using 
county-level data. 
The phase relationships 
between these variables and deer abundance were also very similar 
to county-level relationships: snow depth and 
deer abundance were nearly in anti-phase; and climate 
indices and deer abundance showed approximately 
quarter-cycle phase shifts (Table \ref{TabS4_SummaryDistrict}). Combined, snow depth, $\text{MEI}_{\text{w}}$, and $\text{PDO}_{\text{w}}$ explained $`r round(usda.abunmodelSyncExp,0)`\%$ of the 
synchrony in deer abundance using 
USDA district data, and patterns of synchrony in deer abundance predicted by that model closely resembled actual patterns of deer abundance synchrony (Fig. \ref{FigS8_WMFAndPredictionsDistricts}E). Cross terms for this model were of small magnitude, $`r round(usda.abunmodelXterms,0)`\%$.

The climate indices explained similar amounts of 
deer abundance synchrony as for the county-level 
data (Table \ref{TabS4_SummaryDistrict}). Cross terms for snow depth and deer abundance over $3-4$-year timescales were too large at the county level to make a reliable statement of synchrony explained at that level, but cross terms were not too large for the district-level analysis, and snow depth explained $`r round(usda_abunsnwd_syncexp34,0)`\%$ of synchrony at $3-4$-year timescales. This makes sense in light of possible effects of dispersal at smaller spatial scales, as explained in the section "Wavelet Moran theorem..." above; effects of dispersal would have been reduced at district level because a smaller proportion of deer disperse between spatial units for larger spatial units.
The result that snow depth appeared to influence deer on $3-4$-year timescales, while $\text{MEI}_{\text{w}}$ and $\text{PDO}_{\text{w}}$ were significantly spatially coherent and explained synchrony at $4-7$-year timescales pertained to district-level data as it did for county-level data.

As in the county-level analyses, hunter abundance time series were not spatially coherent with deer abundance time series on $3-7$-year timescales (Table \ref{TabS4_SummaryDistrict}), so any synchrony there may have been in hunter abundances at those timescales could not have explained synchrony in deer. Again similar to the county-level analyses, hunter abundance time series were significantly coherent with deer abundance on $2-2.5$-year timescales (Table \ref{TabS4_SummaryDistrict}), but there was little deer abundance synchrony on those timescales to explain (Fig. \ref{FigS8_WMFAndPredictionsDistricts}A,C).

DVC data aggregated to USDA districts had a similar 
synchrony feature to deer abundance over $3-7$ year 
timescales (Fig. \ref{FigS8_WMFAndPredictionsDistricts}B,D). As 
at county level, deer abundance time series were significantly spatially coherent with DVC time series on $3-7$-year timescales (Table \ref{TabS4_SummaryDistrict}).
Whereas cross terms were high enough at county-level to render meaningless statements about fractions of DVC synchrony explained by deer synchrony, this was not the case at district level: cross terms were low (Table \ref{TabS4_SummaryDistrict}), and fractions of DVC synchrony explained by deer synchrony were $`r round(usda_dvcabunSyncExp,0)`\%$ for raw DVC data and $`r round(usda_adjdvcabunSyncExp,0)`\%$ for traffic-adjusted DVCs. The difference in cross terms between county- and district-level analyses again makes sense in light of dispersal, as explained above. Large cross terms may reflect the 
effects on the statistics of dispersal of 
deer between counties or movements of cars between 
counties, but such effects would be
reduced at the larger district level because reduced fractions of deer and cars disperse from one spatial unit to another for these larger spatial units. 
Patterns of synchrony in DVCs predicted by synchrony in deer looked similar to actual patterns of synchrony in DVCs (Fig. \ref{FigS8_WMFAndPredictionsDistricts}F). 

\textbf{Statewide results.} In general, results of statewide analyses 
mostly agreed with the smaller-spatial-unit 
analyses, when they could be compared. Results on synchrony were not available at state level because at that level each variable is only represented by a single time series, but we compared wavelet coherence results between variables at the statewide spatial scale to spatial wavelet coherence results between variables using smaller spatial units. Statewide deer abundance and DVC time series were marginally 
significantly coherent over $3-7$-year timescales 
($P = `r round(ann.dvc.abun_pval,4)`$), with the strongest relationship occurring over 
$3-5$-year timescales ($P = `r round(ann.dvc.abun_pval35,4)`$). 
$\text{MEI}_{\text{w}}$ and $\text{PDO}_{\text{w}}$ were significantly 
coherent with deer abundance over the $3-7$-year 
timescale band ($\text{MEI}_{\text{w}}$, $P = `r round(ann.abun.wmei_pval,4)`$; $\text{MEI}_{\text{s}}$, 
$P = `r round(ann.abun.smei_pval,4)`$; $\text{PDO}_{\text{w}}$, 
$P = `r round(ann.abun.wpdo_pval,4)`$). Snow depth was not significant over $3-7$-year timescales ($P = `r round(ann.abun.snow_pval37,4)`$), but was significant at $3-4$-year timescales ($P = `r round(ann.abun.snow_pval34,4)`$), consistent with the results at other spatial resolutions. 
Hunter abundance and deer 
abundance were not significantly coherent at the 
state level on $3-7$-year timescales ($P = `r round(ann.abun.hunter_pval37,4)`$) or $2-2.5$-year timescales ($P = `r round(ann.abun.hunter_pval2_2.5,4)`$).

\textbf{Notes on details of the cycling mechanism.} There are two alternative elaborations of the mechanisms presented in the main text by which
synchronous effects of environmental drivers produce state-wide population cycles in deer.
Synchronous fluctuations in environmental drivers associated with winter climate may have produced
small oscillations on 3-7-year timescales in county-level deer population time series, and 
also brought these oscillations into spatial synchrony, thereby causing them to sum, across
counties, to the major phenomenon described in the main text (variation A). Alternatively, the small
county-level oscillations on 3-7-year timescales may have been due partly to the intrinsic 
dynamics of deer, resulting from density-dependent effects, maternal effects, or 
other mechanisms of nonlinear populations dynamics; and synchronous environmental drivers 
then brought the intrinsically oscillating local dynamics into synchrony (variation B). The
difference between these alternatives is whether small county-level population
oscillations were produced and synchronized, or merely synchronized but 
not produced, by synchronous environmental drivers. These alternatives would be difficult to 
distinguish. However, under either alternative, a Moran effect caused the observed strong, 
state-wide oscillations in the sense that it synchronized weak local oscillations, 
causing them to sum to a major phenomenon; and eliminating synchrony via randomizations also
eliminated the state-wide oscillations (Fig. \ref{MT-Fig4_StateWideFluctuations}), even though the
randomizations preserved the structure of the local fluctuations. Variation A
may be more likely given previous work documenting the influence of snow depth and large-scale
climatic oscillations on deer and other ungulates [@Mysterud2008_deerclimate; @Hegel2012_caribou; @Post2004_greenland; @Grotan2005_roedeer]. 

\newpage

# Supplementary figures

\begin{figure}[h!]
\includegraphics[width=\textwidth]{Results/FigS1.png}
\caption{Raw time series of (A) deer abundance, (B) deer-vehicle collisions, 
(C) average winter ($\text{Dec}_{t-1}$ to $\text{Mar}_t$) snow depth, and 
(D) winter climate indices (Multivariate El Ni$\~{n}$o Southern Oscillation Index, 
MEI; Pacific Decadal Oscillation, PDO), and hunter abundances (E). 
Each line in A-C, E represents a county. Other variables were 
used in analyses (see text) but are not shown here due to lack of significant 
assocations with the deer and DVC variables that were the focus of the 
study.\label{FigS1_Timeseries}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[height=0.8\textheight]{Results/FigS2.png}
\caption{Map of Wisconsin, USA. Black lines and yellow dots delineate county boundaries and centroids. Color shading and black dots delineate USDA district boundaries and centroids.\label{FigS2_map}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/PedagogFig_WMF.png}
\caption[Demonstration of the wavelet mean field]{Detecting time- and timescale-specific
synchrony with the wavelet mean field. This figure was taken without change from
[6], where additional details are also available. Panels a-d show the principle of how synchrony
can differ for different timescales of dynamics. Time series y1 and y2 (a)
are exactly anti-correlated (out of phase), as are y3 and y4 (b). Combining
y1 with y3 and y1 with y4
gives two time series (c) which are synchronized on long timescales, but anti-synchronized
on short timescales. The reverse is also possible (d). This timescale-specific
structure of synchrony cannot be detected with correlation coefficients, which are
0 for both c and d, because contributions from different timescales cancel.
In practice, real population and environmental signals are broadband, and exact cancellation
is unlikely, but asynchrony at some frequencies can strongly conceal important
synchrony at other frequencies. Panels e-k demonstrate this concealment, using artificial data,
and also show how the wavelet mean field detects time- and timescale-specific synchrony.
Each of 11 artificial time series were constructed as the sum of: 1) a single common
signal of amplitude 1 that changes its oscillatory period at $t=50$ from 10 years
to 5 years (e); 2) oscillations
of amplitude 3 that have the same oscillatory period
(3 years), but random and independent phases in
each of the 11 constructed
time series (f); and 3) white noise of standard deviation 1.5, again independently
generated for each of the 11 time series (g). Synchrony in the resulting time series cannot
be visually detected (i), nor is it readily apparent by examining the
55 pairwise correlation coefficients between time series (j), which spanned a
wide range of values including 0. But the wavelet mean field magnitude (k)
showed clear color bands at 10-year period for $t<50$ and 5-year period for
$t>50$. The wavelet mean field magnitude displays strength of
synchrony as a function of timescale
of dynamics and time, here with red indicating synchrony and blue asynchrony.
Wavelet phasor mean fields provide plots similar to (k) but with values
between 0 and 1 that indicate the strength of phase synchrony and that can be
straightforwardly significance tested as described in [9]. \label{PedagogFigWMF}}
\end{figure}
<!---***TOM: Citations in caption above are not dynamic links, need to change manualy--->

\newpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/PedagogFig_SpatCoh.png}
\caption[Demonstration of spatial wavelet coherence]{Measuring relationships between variables using spatial wavelet coherence.
This figure was adapted with only minor changes
from supplementary figure 5 of [6].
The time series of panel e were used as drivers in producing the time series of
panel f and the figure shows
how this relationship can be detected with the spatial wavelet coherence technique.
The time series of panel e
were constructed as the sum of: 1) a single common signal of amplitude $1$ and
period $12$ years (a); 2) a
single common signal of amplitude $5$ and period $2$ years (b); and 3)
normally distributed white noise of standard deviation $1.5$,
independently generated for each of the $10$ time series (c). The time series
of panel f were produced via the
relationship $y_n(t) = (x_n(t)+x_n(t-1))/2 + \epsilon_n (t)$ where
the $\epsilon_n (t)$ were independent normal random numbers
of mean $0$ and standard deviation $3$. This transmits the period-$12$
component of the $x$ signals to the $y$ but
not the period-$2$ component because averaging covers a whole
period for that component. Correlations (f,
green numbers) between $x_n(t)$ and $y_n(t)$ did not indicate
any particular relationship. Correlations cannot
detect the relationship between the $x$ and $y$ because the correlation technique confounds
phenomena occurring on different
timescales. Spatial wavelet coherence revealed a highly significant relationship
at periods around $12$ years (g) and on
average over long timescales (left $P$-value on panel g, long timescales
defined as $>4$ years) but no relationship
(right $P$-value) for short timescales ($<4$ years). The red line on g is the
spatial wavelet coherence and black lines are
$50$th, $95$th, and $99$th percentiles of spatial wavelet coherences
of synchrony-preserving surrogate (randomized) data sets [6]
appropriately representing the
null hypothesis of no relationship between the $x$ and $y$.
Also see [6] for a description of how the aggregate long- and short-timescale $P$-values were computed. \label{PedagogFigSpatCoh}}
\end{figure}
<!---***TOM: Citations in caption above are not dynamic links, need to change manualy--->
\newpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/FigS4.png}
\caption{Phase differences between variables as a function of timescale for the main significant relationships of 
Table \ref{TabS1_CountyCoherenceSummary}, county-level data: A) winter MEI ($\text{MEI}_{\text{w}}$) 
and deer abundance, B) summer MEI and 
deer abundance, C) winter PDO ($\text{PDO}_{\text{w}}$) and deer abundance, 
D) snow depth and deer abundance, E) deer abundance and 
deer-vehicle collisions, F) deer abundance and deer-vehicle collisions adjusted for traffic volume, and 
G) deer abundance and hunter abundance. $\bar{\theta}$ indicates the mean phase (in units of $\pi$
radians) for the shaded timescale bands. Horizontal axes differ in extent among panels due to different
time ranges of available data for different variables. \label{FigS4_PhaseDiffs}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[width=\textwidth]{Results/FigS6.png}
\caption{Rank, by timescale, of spatial wavelet coherence values in surrogate spatial wavelet coherence distributions (\emph{Methods}) for the main significant relationships of Table \ref{TabS1_CountyCoherenceSummary}, using county-level data. The red horizontal dashed line corresponds to a nominal confidence level of $95\%$. In A), results are comparisons of the listed variables with deer abundance. In B), `Abun-DVCs' is a comparison of deer abundance and DVCs, `Abun-Adj. DVCs' is a comparison of deer abundance and DVCs adjusted for traffic volume, and `Hunters-Abun' is a comparison of hunter numbers and deer abundance. The red horizontal line would be analogous to a $P$-value of $0.05$ for an individual timescale (\emph{Methods}).\label{FigS6_RanksInSurrogs}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[width=.4\textwidth]{Results/FigS7.png}
\caption{Wavelet mean field (A) and wavelet phasor mean field (B) magnitudes of county-level hunter abundance 
time series, and predicted synchrony of deer abundance based on a wavelet model with sole predictor hunter 
abundance (C). Higher values in A, B indicate greater synchrony (A) or phase synchrony (B) of hunter abundance 
time series at the indicated times and timescales. Contours on (B) indicate statistical significance of phase 
synchrony at $P = 0.001$. Colors in (C) show predicted synchrony in deer abundance, while contours show the 
actual wavelet mean field magnitude of deer abundance, similar to the contours shown in Fig. \ref{MT-Fig2_DeerSync}C. Slight differences exist here vs Fig. \ref{MT-Fig2_DeerSync}C because of different spatiotemporal extents of the data used in hunter analyses. Agreement is poor between colors and contours 
on panel C, giving a 
visual indication of the statistical result that hunter abundance does not explain deer abundance or synchrony 
well on $3-7$-year timescales.\label{FigS7_WMFHunter}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[height=.8\textheight]{Results/FigS8.png}
\caption{Wavelet mean field (A, B) and phasor mean field (C, D) magnitudes, and predicted synchrony (E, F) for deer abundance (A, C, E) and DVCs (B, D, F) using USDA-district data. Higher values in A-D indicate greater synchrony (A, B) or phase synchrony (C, D) at the indicated times and timescales. Contours on (C, D) indicate statistical significance of phase synchrony at $P = 0.001$. Colors in (E) show synchrony in deer abundance predicted from a wavelet model using snow depth, $\text{MEI}_{\text{w}}$, and $\text{PDO}_{\text{w}}$ as predictors, while contours show the actual wavelet mean field magnitude of deer abundance from (A), for comparison. Agreement is good, giving a visual indication of the statistical result that climatic Moran effects explain deer synchrony. Colors in (F) show synchrony in DVCs predicted by a wavelet model with sole predictor deer abundance, while contours are from (B) and again show good agreement. Vertical axes differ between left and right panels because time series were shorter for DVCs. \label{FigS8_WMFAndPredictionsDistricts}}
\end{figure}

\newpage

\begin{figure}[!h]
\includegraphics[height=.9\textheight]{Results/FigS9.png}
\caption{Wavelet mean fields (left column) and wavelet phasor mean fields (right column) of winter Tmin (A, B), Tmax (C, D), snow depth (E, F) and precipitation (G, H) using county-level data. Colors and contours as in Fig \ref{MT-Fig2_DeerSync}A,B. \label{FigS9_WMFsAndWPMFsAncillary}}
\end{figure}

\newpage
\clearpage

# Supplementary tables

```{r TableS1,echo=F,results='markup'}
options(knitr.kable.NA = '') #makes it put blanks instead of "NA" for NAs
rownames(TableS1)<-NULL
knitr::kable(TableS1,
             format='pandoc',
             digits=4,
             col.names=c("Predictor","Response","Timescale", "P-value","Mean phase ($\\bar{\\theta}$)","Synchrony explained","Average cross terms"),
             caption = "Summary of spatial wavelet coherence tests and related results using county-level data. $P$-values and mean phases are from tests of spatial wavelet coherence (*Methods*) of the variables in columns 1 and 2 over the indicated timescale band. Mean phases over the timescale band (units of $\\pi$ radians) are provided only when meaningful, i.e., when spatial wavelet coherence was significant, $P < 0.05$, or marginally significant. A positive mean phase indicates the variable in the column *Response* is leading, and a negative mean phase indicates the variable in the column *Predictor* is leading. The *Synchrony explained* and *Average cross terms*  columns, which give percentages, are based on wavelet linear regressions (*Methods*) of the *Response* transforms against the *Predictor* transforms. When cross terms are low, synchrony explained is interpretable as the approximate percentage of synchrony in the response explainable as due to the synchrony in the predictor. Cross terms were low enough except for tests involving DVCs, for which USDA district-level results were more reliable (main text and Table \\ref{TabS4_SummaryDistrict}). Cross-terms are zero for test involving climate indices because for those tests the same values were used for all locations (*Methods*). All values were rounded to display four digits. \\label{TabS1_CountyCoherenceSummary}",
             booktabs=T)
```

\newpage

```{r TableS2,echo=F,results='markup'}
rownames(TableS2)<-NULL
knitr::kable(TableS2,
             col.names=c("Predictor","Response","Timecale","P-value","Mean phase ($\\bar{\\theta}$)"),
             format='pandoc',
             digits=4,
             caption = "$P$-values of wavelet coherence tests, and associated mean phase differences for significant and marginally significant tests, between climate indices. Values are over $3-7$ year timescales. All values were rounded to display four digits. \\label{TabS2_PairwiseClimVarSpatCoh}",
             booktabs=T)
```

\newpage

```{r TableS4,echo=F,results='markup'}
rownames(TableS4)<-NULL
knitr::kable(TableS4,
             format='pandoc',
             digits=4,
             col.names=c("Predictor","Response","Timescale", "P-value","Mean phase ($\\bar{\\theta}$)","Synchrony explained","Average cross terms"),
             caption = "Summary of spatial wavelet coherence tests and related results using USDA district-level data (*Methods*). $P$-values and mean phases are from tests of spatial wavelet coherence (*Methods*) of the variables in columns 1 and 2 over the indicated timescale band. Mean phases over the timescale band (units of $\\pi$ radians) are provided only when meaningful, i.e., when spatial wavelet coherence was significant, $P < 0.05$, or marginally significant. A positive mean phase indicates the variable in the column *Response* is leading, and a negative mean phase indicates the variable in the column *Predictor* is leading. The *Synchrony explained* and *Average cross terms*  columns (which give percentages) are based on wavelet linear regressions (*Methods*) of the *Response* transforms against the *Predictor* transforms. When cross terms are low, synchrony explained is interpretable as the approximate percentage of synchrony in the response explainable as due to the synchrony in the predictor. They were low enough for all results in this table. Cross-terms are zero for test involving climate indices because for those tests the same values were used for all locations (*Methods*). All values were rounded to display four digits. \\label{TabS4_SummaryDistrict}",
             booktabs=T)
```

\newpage

# References {-}

<div id="refs"></div>

